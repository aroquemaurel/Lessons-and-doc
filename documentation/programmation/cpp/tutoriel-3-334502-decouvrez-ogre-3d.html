<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xml:lang="fr" xmlns="http://www.w3.org/1999/xhtml"><head><link media="all" href="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/widget57.css" type="text/css" rel="stylesheet">







    

        


        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta name="keywords" content="tutoriels, concernant, les, moteurs">
        <meta name="description" content="Tutoriels concernant les moteurs 3D">
        <meta name="robots" content="index,follow">
        <meta name="verify-v1" content="UL/4+QUCNTv1xBkNcC4sv4EjPUAoVj1yE+fMZClqLsc=">

        <title>
            Découvrez Ogre 3D
        </title>

        <link rel="shortcut icon" type="image/x-icon" href="http://www.siteduzero.com/Templates/images/designs/2/favicon.ico">
        <link rel="alternate" type="application/rss+xml" title="News du Site du Zéro" href="http://www.siteduzero.com/Templates/xml/news_fr.xml">
        
        <link rel="alternate" type="application/rss+xml" title="Derniers tutoriels du Site du Zéro" href="http://www.siteduzero.com/Templates/xml/tutoriels_fr.xml">
        

        <link rel="index" href="http://www.siteduzero.com/plan.html">
        <link rel="start" title="Accueil" href="http://www.siteduzero.com/">
        <link rel="search" type="application/opensearchdescription+xml" title="Site Du Zero" href="http://www.siteduzero.com/Templates/xml/xpi/fr/siteduzero.xpi">
        <link rel="search" href="http://www.siteduzero.com/recherche.html" title="Rechercher">
        <link rel="help" title="Accessibilité" href="http://www.siteduzero.com/accessibilite.html">
        <link rel="accesskeys" title="Raccourcis et Accesskeys" href="http://www.siteduzero.com/accessibilite.html">


        <link href="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/design.css" rel="stylesheet" type="text/css" media="screen, handheld, tv, projection">
        <link href="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/zcode.css" rel="stylesheet" type="text/css" media="screen, handheld, tv, projection">
        <link href="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/impression.css" rel="stylesheet" type="text/css" media="print">


        

        

        <!--[if lt IE 8]>
            <link href="/css/ie_old.min.css?1302100238" rel="stylesheet" type="text/css" media="screen" />
        <![endif]-->

        
            <script src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/ga.js" async="" type="text/javascript"></script><script type="text/javascript">
                document.write('<style type="text/css">');
                document.write('.spoiler3{visibility: hidden;}');           // cache le contenu
                document.write('.spoiler3_hidden{display: none;}');         // ferme le cadre "secret"

                document.write('.spoiler_hidden a{visibility: visible;}');  // montre le lien pour afficher le contenu
                document.write('.spoiler a{visibility: visible;');          // montre le lien pour afficher le contenu
                document.write('</style>');
            </script><style type="text/css">.spoiler3{visibility: hidden;}.spoiler3_hidden{display: none;}.spoiler_hidden a{visibility: visible;}.spoiler a{visibility: visible;</style>
        
        <!--
        
            <style type="text/css">
                .spoiler3
                {
                        visibility: hidden;
                }
                .spoiler3_hidden
                {
                        display: none;
                }
            </style>
        
        -->
        
        <script type="text/javascript" src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/jquery.js"></script>
        <script type="text/javascript" src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/jqueryui.js"></script>
    </head><body><div id="_atssh" style="visibility: hidden; height: 1px; width: 1px; position: absolute; z-index: 100000;"><iframe src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/sh38.html" style="height: 1px; width: 1px; position: absolute; z-index: 100000; border: 0pt none; left: 0pt; top: 0pt;" title="AddThis utility frame" id="_atssh482"></iframe></div>
		
            <div id="acces_rapide">
                <a href="#menu">Aller au menu</a> - <a href="#corps">Aller au contenu</a>
            </div>

            <div id="top">
                <ul class="intersites">
                    
                    <li class="selected"><a href="http://www.siteduzero.com/">Informatique</a></li>
                    <li><a href="#" id="bientot_lien">Bientôt...</a></li>
                </ul>

		<ul class="stats_sites">
                    
                    <li class="last_items"><a href="http://www.siteduzero.com/connectes.html">688 Zéros connectés</a> - </li>
                    <li class="last_items"><a href="http://www.siteduzero.com/membres-292.html">236 149 Membres inscrits</a></li>
		</ul>
            </div>

            <div id="header">
                <div class="header_gauche">
                    <a href="http://www.siteduzero.com/"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/logo_sdz_fr.png" alt=""></a>
                </div>

                <div class="header_droit">
                    <div class="fr">
                        <div id="logbox">
                            
                                <div class="bloc_inscription">
                                    <a href="http://www.siteduzero.com/membres-315.html">
                                        <strong class="liens_invites">Inscription</strong><br>
                                        Inscription rapide en 2 minutes
                                    </a>
                                </div>
                                <div class="bloc_connexion">
                                    <a href="http://www.siteduzero.com/connexion.html">
                                        <strong class="liens_invites">Connexion</strong><br>
                                        Utilisez votre compte
                                    </a>
                                    <a class="rpxDialog" href="http://www.siteduzero.com/compte/rpx/remplacer"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/rpx_icons.png" alt="connexion_rpx"></a>
                                </div>
                            
                        </div>

                        
                    </div>

                    <div id="publicite_header">
                        <div id="publicite_banniere" class="publicite">
                            <script type="text/javascript" src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/smartAdServer.js"></script>
                            
                                
    <script type="text/javascript">
    sas_pageid= '24617/166249';              // Page
    sas_formatid=10601;                          // Format
    sas_target='';                                        // Targeting
    SmartAdServer(sas_pageid,sas_formatid,sas_target);
</script><script src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/a.js"></script>
<noscript>
    <a href="http://www4.smartadserver.com/call/pubjumpi/24617/166249/10601/M/1125160568/?">
    <img src="http://www4.smartadserver.com/call/pubi/24617/166249/10601/M/1125160568/?" border="0" alt="" /></a>
</noscript>



                            
                        </div>

                    </div>
                    </div>
                </div>

                    <div id="speedbarre">
                            <ul class="smenu">
                                <li id="speed_accueil" class="home">
                                    <a class="" href="http://www.siteduzero.com/" accesskey="1">
                                        <span title="Accueil">Accueil</span>
                                    </a>
                                </li>
                                
                                <li class="" id="speed_cours">
                                    <a class="" href="http://www.siteduzero.com/tutoriel.html">
                                        <span>Cours</span>
                                    </a>
                                    <span class="speedbarre_arrow"></span>
                                </li>
                                <li class="" id="speed_forum">
                                    <a class="" href="http://www.siteduzero.com/forum.html">
                                        <span>Forums</span>
                                    </a>
                                    <span class="speedbarre_arrow"></span>
                                </li>
                                
                                    <li class="" id="speed_concours">
                                        <a class="" href="http://www.siteduzero.com/participez.html">
                                            <span>Participez</span>
                                        </a>
                                        <span class="speedbarre_arrow"></span>
                                    </li>
                                    <li class="" id="speed_etudes">
                                        <a href="http://www.siteduzero.com/etudes.html" class="last_item">
                                            <span>Études</span>
                                        </a>
                                        <span class="speedbarre_arrow"></span>
                                    </li>
                                    <li class="" id="speed_job">
                                        <a href="http://www.siteduzero.com/emploi.html" class="last_item">
                                            <span>Emploi</span>
                                        </a>
                                        <span class="speedbarre_arrow"></span>
                                    </li>

                                    <li class="" id="speed_boutique">
                                    <a href="http://www.siteduzero.com/boutique.html" class="last_item">
                                            <span>Boutique</span>
                                        </a>
                                        <span class="speedbarre_arrow"></span>
                                    </li>
                                
                            </ul>

                            <div id="speedbar_expand" class="menuh" style="display: none;">
                                <div class="menuh_content">
                                    <div id="menuh_tutorials" style="display: none;">
                                        

                                        <div id="menu_tutorials">
                                            <div class="menu_prim">
                                                <h5>Les cours phares</h5>
                                                <div class="menuh_list_category">
                                                    <div class="ico"><a href="http://www.siteduzero.com/tutoriel-1-67-site-web.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/67.png" alt=""></a></div>
                                                    <h6><a href="http://www.siteduzero.com/tutoriel-1-67-site-web.html"><strong>Site Web</strong></a></h6>
                                                    <ul>
                                                        <li><a href="http://www.siteduzero.com/tutoriel-3-13666-apprenez-a-creer-votre-site-web.html"><span style="display: block;">XHTML / CSS</span></a></li>
                                                        <li><a href="http://www.siteduzero.com/tutoriel-3-309961-dynamisez-vos-sites-web-avec-javascript.html">Javascript</a></li>
                                                        <li><a href="http://www.siteduzero.com/tutoriel-3-14668-concevez-votre-site-web-avec-php-et-mysql.html">PHP / MySQL</a>
                                                            <a href="http://www4.smartadserver.com/call/cliccommand/4083181/92456312?">
                                                                <span class="in_book"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/ico_livre.png" alt=""></span>
                                                                <span style="display: none;">Ce cours existe en livre :<br>Concevez votre site web avec PHP et MySQL</span>
                                                            </a>
                                                        </li>
                                                        <li><a href="http://www.siteduzero.com/tutoriel-3-112219-apprenez-a-creer-des-applications-web-dynamiques-avec-jee.html">Java EE (J2EE)</a></li>
                                                    </ul>
                                                </div>

                                                <div class="menuh_list_category">
                                                    <div class="ico"><a href="http://www.siteduzero.com/tutoriel-1-57-programmation.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/57.png" alt=""></a></div>
                                                    <h6><a href="http://www.siteduzero.com/tutoriel-1-57-programmation.html"><strong>Programmation</strong></a></h6>
                                                    <ul>
                                                        <li><a href="http://www.siteduzero.com/tutoriel-3-14189-apprenez-a-programmer-en-c.html">Langage C</a>
                                                            <a href="http://www4.smartadserver.com/call/cliccommand/4083178/92456312?">
                                                                <span class="in_book"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/ico_livre.png" alt=""></span>
                                                                <span style="display: none;">Ce cours existe en livre :<br>Apprenez à programmer en C</span>
                                                            </a>
                                                        </li>
                                                        <li><a href="http://www.siteduzero.com/tutoriel-3-11406-apprenez-a-programmer-en-c.html">Langage C++</a></li>
                                                        <li>
                                                            <a href="http://www.siteduzero.com/tutoriel-3-10601-programmation-en-java.html">
                                                                Java
                                                            </a>
                                                            <a href="http://www4.smartadserver.com/call/cliccommand/4083192/92456312?">
                                                                <span class="in_book"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/ico_livre.png" alt=""></span>
                                                                <span style="display: none;">Ce cours existe en livre :<br>Apprenez à programmer en Java</span>
                                                            </a>
                                                        </li>
                                                        <li><a href="http://www.siteduzero.com/tutoriel-3-119239-programmation-en-java-api.html">Java (API)</a></li>
                                                        <li><a href="http://www.siteduzero.com/tutoriel-3-223267-apprendre-python.html">Python</a></li>
                                                        <li><a href="http://www.siteduzero.com/tutoriel-3-134798-visual_basic_net.html">VB .NET </a></li>
                                                    </ul>
                                                </div>


                                                <div class="menuh_list_category">
                                                    <div class="ico"><a href="http://www.siteduzero.com/tutoriel-1-60-systemes-d-exploitation.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/60.png" alt=""></a></div>
                                                    <h6><a href="http://www.siteduzero.com/tutoriel-1-60-systemes-d-exploitation.html"><strong>Systèmes d'exploitation</strong></a></h6>
                                                    <ul>
                                                        <li><a href="http://www.siteduzero.com/tutoriel-3-12827-reprenez-le-controle-a-l-aide-de-linux.html">Linux</a>
                                                            <a href="http://www4.smartadserver.com/call/cliccommand/4083194/92456312?">
                                                                <span class="in_book"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/ico_livre.png" alt=""></span>
                                                                <span style="display: none;">Ce cours existe en livre :<br>Reprenez le contrôle a l'aide de Linux</span>
                                                            </a>
                                                        </li>                                                    
                                                        <li><a href="http://www.siteduzero.com/tutoriel-3-273305-freebsd-et-l-envers-du-decor.html">FreeBSD</a></li>
                                                    </ul>
                                                </div>

                                                <div class="menuh_list_category">
                                                <div class="ico"><a href="http://www.siteduzero.com/tutoriel-1-56-graphisme.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/56.png" alt=""></a></div>
                                                    <h6><a href="http://www.siteduzero.com/tutoriel-1-56-graphisme.html"><strong>Graphisme</strong></a></h6>
                                                    <ul>
                                                        <li><a href="http://www.siteduzero.com/tutoriel-3-351765-debuter-sur-adobe-photoshop.html">Photoshop</a></li>
                                                    </ul>
                                                </div>

                                                <div class="menuh_list_category">
                                                    <div class="ico"><a href="http://www.siteduzero.com/tutoriel-1-58-infographie-3d.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/58.png" alt=""></a></div>
                                                    <h6><a href="http://www.siteduzero.com/tutoriel-1-58-infographie-3d.html"><strong>Infographie 3D</strong></a></h6>
                                                    <ul>
                                                        <li><a href="http://www.siteduzero.com/tutoriel-3-11714-debutez-dans-la-3d-avec-blender.html">Blender</a></li>
                                                        <li><a href="http://www.siteduzero.com/tutoriel-3-228998-apprenez-a-modeliser-en-3d-avec-autodesk-maya.html">Maya </a></li>
                                                    </ul>
                                                </div>

                                                <div class="menuh_list_category">
                                                    <div class="ico"><a href="http://www.siteduzero.com/tutoriel-1-55-bureautique.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/55.png" alt=""></a></div>
                                                    <h6><a href="http://www.siteduzero.com/tutoriel-1-55-bureautique.html"><strong>Bureautique</strong></a></h6>
                                                    <ul>
                                                        <li><a href="http://www.siteduzero.com/tutoriel-3-258577-redigez-des-documents-de-qualite-professionnelle-avec-latex.html">LaTeX</a>
                                                            <a href="http://www4.smartadserver.com/call/cliccommand/4083197/92456312?">
                                                                <span class="in_book"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/ico_livre.png" alt=""></span>
                                                                <span style="display: none;">Ce cours existe en livre :<br>Rédigez des documents de qualité avec LaTeX</span>
                                                            </a>
                                                        </li>
                                                        <li><a href="http://www.siteduzero.com/tutoriel-3-417000-redigez-facilement-des-documents-avec-word.html">Word<img style="margin-left: 10px;" alt="" src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/iconouveau.png"></a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                            
                                            <div class="menu_princi menuhcattuto ">
                                                <h5>Tous les cours par catégories</h5>
                                                <div class="menuh_princi_col">
                                                    
                                                            <div class="menuh_list_category">
                                                                <div class="ico"><a href="http://www.siteduzero.com/tutoriel-1-67-site-web.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/67.png" alt=""></a></div>
                                                                <h6><a href="http://www.siteduzero.com/tutoriel-1-67-site-web.html">Site Web <span style="font-weight: normal;">(206 Cours)</span></a></h6>
                                                                <ul>
                                                                    <li>
                                                                        
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-69-xhtml-css.html">XHTML / CSS</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-1-210-php.html">PHP</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-71-divers.html">Divers</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-73-forums.html">Forums</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-77-hebergement.html">Hébergement</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-70-javascript.html">Javascript</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-74-serveur.html">Serveur</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-309-ide.html">IDE</a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        
                                                            <div class="menuh_list_category">
                                                                <div class="ico"><a href="http://www.siteduzero.com/tutoriel-1-60-systemes-d-exploitation.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/60.png" alt=""></a></div>
                                                                <h6><a href="http://www.siteduzero.com/tutoriel-1-60-systemes-d-exploitation.html">Systèmes d'exploitation <span style="font-weight: normal;">(88 Cours)</span></a></h6>
                                                                <ul>
                                                                    <li>
                                                                        
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-96-linux.html">Linux</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-147-mac-os.html">Mac OS</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-1-97-windows.html">Windows</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-408-bsd.html">BSD</a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        
                                                            <div class="menuh_list_category">
                                                                <div class="ico"><a href="http://www.siteduzero.com/tutoriel-1-54-mapping.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/54.png" alt=""></a></div>
                                                                <h6><a href="http://www.siteduzero.com/tutoriel-1-54-mapping.html">Mapping <span style="font-weight: normal;">(31 Cours)</span></a></h6>
                                                                <ul>
                                                                    <li>
                                                                        
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-63-half-life.html">Half-Life</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-66-half-life.html">Half-Life²</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-173-warcraft.html">Warcraft</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-188-autres.html">Autres</a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        
                                                            <div class="menuh_list_category">
                                                                <div class="ico"><a href="http://www.siteduzero.com/tutoriel-1-55-bureautique.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/55.png" alt=""></a></div>
                                                                <h6><a href="http://www.siteduzero.com/tutoriel-1-55-bureautique.html">Bureautique <span style="font-weight: normal;">(29 Cours)</span></a></h6>
                                                                <ul>
                                                                    <li>
                                                                        
                                                                            <a href="http://www.siteduzero.com/tutoriel-1-290-microsoft-office.html">Microsoft Office</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-1-291-openoffice-org.html">OpenOffice.org</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-192-divers.html">Divers</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-451-latex.html">LaTeX</a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        
                                                            <div class="menuh_list_category">
                                                                <div class="ico"><a href="http://www.siteduzero.com/tutoriel-1-59-jeux-video.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/59.png" alt=""></a></div>
                                                                <h6><a href="http://www.siteduzero.com/tutoriel-1-59-jeux-video.html">Jeux Vidéo <span style="font-weight: normal;">(22 Cours)</span></a></h6>
                                                                <ul>
                                                                    <li>
                                                                        
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-102-hl-ses-mods.html">HL &amp; ses mods</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-185-autres-jeux.html">Autres jeux</a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        
                                                            <div class="menuh_list_category">
                                                                <div class="ico"><a href="http://www.siteduzero.com/tutoriel-1-61-materiel.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/61.png" alt=""></a></div>
                                                                <h6><a href="http://www.siteduzero.com/tutoriel-1-61-materiel.html">Matériel <span style="font-weight: normal;">(11 Cours)</span></a></h6>
                                                                <ul>
                                                                    <li>
                                                                        
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-101-general.html">Général</a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        

                                                    <div class="menuh_list_category">
                                                        <div class="ico"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/tuto_cat_thb.png" alt=""></div>
                                                        <h6>Autres</h6>
                                                        <ul>
                                                            
                                                                <li>
                                                                    <a style="display: block;" href="http://www.siteduzero.com/tutoriel-2-404-bases-de-donnees.html">Bases de données</a>
                                                                </li>
                                                            
                                                                <li>
                                                                    <a style="display: block;" href="http://www.siteduzero.com/tutoriel-2-403-mobiles.html">Mobiles</a>
                                                                </li>
                                                            
                                                                <li>
                                                                    <a style="display: block;" href="http://www.siteduzero.com/tutoriel-2-141-site-du-zero.html">Site du Zéro</a>
                                                                </li>
                                                            
                                                        </ul>
                                                    </div>
                                                </div>

                                                <div class="menuh_princi_col">
                                                    
                                                            <div class="menuh_list_category">
                                                                <div class="ico"><a href="http://www.siteduzero.com/tutoriel-1-57-programmation.html">
                                                                    <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/57.png" alt=""></a>
                                                                </div>
                                                                <h6><a href="http://www.siteduzero.com/tutoriel-1-57-programmation.html">Programmation</a> <span style="font-weight: normal;">(249 Cours)</span></h6>
                                                                <ul>
                                                                    <li>
                                                                        
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-91-as-flash-flex.html">AS / Flash / Flex</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-217-algorithmique.html">Algorithmique</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-254-basic-et-derives.html">Basic et dérivés</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-1-344-bibliotheques.html">Bibliothèques</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-262-c.html">C</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-261-c.html">C++</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-201-c-net.html">C# / .NET</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-1-258-calculatrices.html">Calculatrices</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-242-ide.html">IDE</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-336-erlang.html">Erlang</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-227-general.html">Général</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-178-java.html">Java</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-93-mirc.html">mIRC</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-196-python.html">Python</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-355-caml-ocaml.html">Caml / OCaml</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-386-cocoa-objective-c.html">Cocoa / Objective-C</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-253-autres-langages.html">Autres langages</a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        
                                                            <div class="menuh_list_category">
                                                                <div class="ico"><a href="http://www.siteduzero.com/tutoriel-1-56-graphisme.html">
                                                                    <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/56.png" alt=""></a>
                                                                </div>
                                                                <h6><a href="http://www.siteduzero.com/tutoriel-1-56-graphisme.html">Graphisme</a> <span style="font-weight: normal;">(30 Cours)</span></h6>
                                                                <ul>
                                                                    <li>
                                                                        
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-176-dessin.html">Dessin</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-177-divers.html">Divers</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-79-flash.html">Flash</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-157-gimp.html">Gimp</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-153-dessin-vectoriel.html">Dessin vectoriel</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-190-photofiltre.html">PhotoFiltre</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-78-photoshop.html">Photoshop</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-197-pov-ray.html">POV-Ray</a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        
                                                            <div class="menuh_list_category">
                                                                <div class="ico"><a href="http://www.siteduzero.com/tutoriel-1-58-infographie-3d.html">
                                                                    <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/58.png" alt=""></a>
                                                                </div>
                                                                <h6><a href="http://www.siteduzero.com/tutoriel-1-58-infographie-3d.html">Infographie 3D</a> <span style="font-weight: normal;">(24 Cours)</span></h6>
                                                                <ul>
                                                                    <li>
                                                                        
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-95-3d-studio-max.html">3D Studio Max</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-152-blender.html">Blender</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-296-maya.html">Maya</a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        
                                                            <div class="menuh_list_category">
                                                                <div class="ico"><a href="http://www.siteduzero.com/tutoriel-1-62-multimedia.html">
                                                                    <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/62.png" alt=""></a>
                                                                </div>
                                                                <h6><a href="http://www.siteduzero.com/tutoriel-1-62-multimedia.html">Multimédia</a> <span style="font-weight: normal;">(25 Cours)</span></h6>
                                                                <ul>
                                                                    <li>
                                                                        
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-99-audio.html">Audio</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-100-video.html">Vidéo</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-382-after-effects.html">After Effects</a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        
                                                            <div class="menuh_list_category">
                                                                <div class="ico"><a href="http://www.siteduzero.com/tutoriel-1-182-reseaux.html">
                                                                    <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/182.png" alt=""></a>
                                                                </div>
                                                                <h6><a href="http://www.siteduzero.com/tutoriel-1-182-reseaux.html">Réseaux</a> <span style="font-weight: normal;">(17 Cours)</span></h6>
                                                                <ul>
                                                                    <li>
                                                                        
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-183-general.html">Général</a>,
                                                                            <a href="http://www.siteduzero.com/tutoriel-2-189-securite.html">Sécurité</a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        

                                                    <div class="menuh_list_category">
                                                        <div id="create_tutorials_button">
                                                            
                                                                <div><a href="http://www.siteduzero.com/connexion.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/redigercours.png" alt=""></a></div>
                                                            
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="clear"></div>
                                            </div>
                                            <div class="clear"></div>
                                        </div>
                                    </div>
                                    
                                    <div id="menuh_forum" style="display: none;">
                                        <div class="menu_princi">
                                            <a class="button_all_forums" href="http://www.siteduzero.com/forum.html">Accueil des forums</a>
                                            <div class="menuh_princi_col">
                                                
                                                        <div class="menuh_list_category">
                                                            <div class="ico"><a href="http://www.siteduzero.com/forum-89-121-site-web.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/121.png" alt=""></a></div>
                                                            <h6><a href="http://www.siteduzero.com/forum-89-121-site-web.html">Site Web</a></h6>
                                                            <ul>
                                                                <li>
                                                                    
                                                                            <a href="http://www.siteduzero.com/forum-81-122-xhtml-css.html">XHTML / CSS</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-338-javascript.html">Javascript</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-123-php.html">PHP</a>
                                                                        
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    
                                                        <div class="menuh_list_category">
                                                            <div class="ico"><a href="http://www.siteduzero.com/forum-89-128-mapping.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/128.png" alt=""></a></div>
                                                            <h6><a href="http://www.siteduzero.com/forum-89-128-mapping.html">Mapping</a></h6>
                                                            <ul>
                                                                <li>
                                                                    
                                                                            <a href="http://www.siteduzero.com/forum-81-129-goldsource-hl1.html">GoldSource (HL1)</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-130-source-hl2.html">Source (HL2)</a>
                                                                        
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    
                                                        <div class="menuh_list_category">
                                                            <div class="ico"><a href="http://www.siteduzero.com/forum-89-24-communaute-des-zeros.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/24.png" alt=""></a></div>
                                                            <h6><a href="http://www.siteduzero.com/forum-89-24-communaute-des-zeros.html">Communauté des zéros</a></h6>
                                                            <ul>
                                                                <li>
                                                                    
                                                                            <a href="http://www.siteduzero.com/forum-81-28-discussions-generales.html">Discussions générales</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-278-vos-etudes.html">Vos études</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-239-presentation-de-vos-projets.html">Présentation de vos projets</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-200-recrutements-pour-vos-projets.html">Recrutements pour vos projets</a>
                                                                        
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    
                                                        <div class="menuh_list_category">
                                                            <div class="ico"><a href="http://www.siteduzero.com/forum-89-440-sciences.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/440.png" alt=""></a></div>
                                                            <h6><a href="http://www.siteduzero.com/forum-89-440-sciences.html">Sciences</a></h6>
                                                            <ul>
                                                                <li>
                                                                    
                                                                            <a href="http://www.siteduzero.com/forum-81-441-mathematiques.html">Mathématiques</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-442-physique-chimie.html">Physique - Chimie</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-443-biologie-et-geologie.html">Biologie et Géologie</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-444-autres-sciences.html">Autres sciences</a>
                                                                        
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    
                                            </div>

                                            <div class="menuh_princi_col">
                                                
                                                        <div class="menuh_list_category">
                                                            <div class="ico"><a href="http://www.siteduzero.com/forum-89-125-programmation.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/125.png" alt=""></a></div>
                                                            <h6><a href="http://www.siteduzero.com/forum-89-125-programmation.html">Programmation</a></h6>
                                                            <ul>
                                                                <li>
                                                                    
                                                                            <a href="http://www.siteduzero.com/forum-81-126-langage-c.html">Langage C</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-237-langage-c.html">Langage C++</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-450-c-net-vb-net.html">C# .NET &amp; VB .NET</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-305-langage-java.html">Langage Java</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-407-langage-python.html">Langage Python</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-406-bases-de-donnees.html">Bases de données</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-127-autres-langages-outils-et-approches.html">Autres langages, outils et approches</a>
                                                                        
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    
                                                        <div class="menuh_list_category">
                                                            <div class="ico"><a href="http://www.siteduzero.com/forum-89-219-materiel-et-logiciels.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/219.png" alt=""></a></div>
                                                            <h6><a href="http://www.siteduzero.com/forum-89-219-materiel-et-logiciels.html">Matériel et logiciels</a></h6>
                                                            <ul>
                                                                <li>
                                                                    
                                                                            <a href="http://www.siteduzero.com/forum-81-339-discussions-informatiques.html">Discussions informatiques</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-220-linux-mac-et-bsd.html">Linux, Mac et *BSD</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-221-windows.html">Windows</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-116-jeux-video.html">Jeux vidéo</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-117-graphisme.html">Graphisme</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-223-materiel.html">Matériel</a>
                                                                        
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    
                                                        <div class="menuh_list_category">
                                                            <div class="ico"><a href="http://www.siteduzero.com/forum-89-310-concours.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/310.png" alt=""></a></div>
                                                            <h6><a href="http://www.siteduzero.com/forum-89-310-concours.html">Concours</a></h6>
                                                            <ul>
                                                                <li>
                                                                    
                                                                            <a href="http://www.siteduzero.com/forum-81-435-innov-game-2011-a-la-gloire-de.html">Innov'Game 2011 : A la gloire de</a>
                                                                        
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    
                                                        <div class="menuh_list_category">
                                                            <div class="ico"><a href="http://www.siteduzero.com/forum-89-143-le-site-du-zero.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/143.png" alt=""></a></div>
                                                            <h6><a href="http://www.siteduzero.com/forum-89-143-le-site-du-zero.html">Le Site du Zéro</a></h6>
                                                            <ul>
                                                                <li>
                                                                    
                                                                            <a href="http://www.siteduzero.com/forum-81-144-suggestions-et-rapports-de-bugs.html">Suggestions et rapports de bugs</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-452-vos-commentaires.html">Vos commentaires</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-145-designs-du-site-du-zero.html">Designs du Site du Zéro</a>
                                                                        
                                                                            <a href="http://www.siteduzero.com/forum-81-429-tutoriels-du-site-du-zero.html">Tutoriels du Site du Zéro</a>
                                                                        
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    
                                            </div>
                                        </div>

                                        
                                    <div class="clear"></div>
                                    </div>
                                    <div id="menuh_collaborate" style="display: none;">
                                        <div class="menuh_list_category">
                                            
                                                <div class="ico"><a href="http://www.siteduzero.com/membres-315.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/tuto_cat_thb.png" alt=""></a></div>
                                                <h6><a href="http://www.siteduzero.com/membres-315.html">Cours</a></h6>
                                                <ul>
                                                    <li style="font-style: italic;">Pour rédiger et participer à la rédaction d'un tutoriel, <a style="display: inline; font-style: normal;" href="http://www.siteduzero.com/membres-315.html">rejoignez-nous !</a></li>
                                                </ul>
                                            
                                        </div>

                                        <div class="menuh_list_category">
                                            
                                                <div class="ico"><a href="http://www.siteduzero.com/membres-315.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/defaut_thb.png" alt=""></a></div>
                                                <h6><a href="http://www.siteduzero.com/membres-315.html">News</a></h6>
                                                <ul>
                                                    <li style="font-style: italic;">Pour partager ou participer à la rédaction d'une news, <a style="display: inline; font-style: normal;" href="http://www.siteduzero.com/membres-315.html"> rejoignez-nous !</a></li>
                                                </ul>
                                            
                                        </div>

                                        <div class="menuh_list_category">
                                            <div class="ico"><a href="http://www.siteduzero.com/concours.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/cup_thb.png" alt=""></a></div>
                                            <h6><a href="http://www.siteduzero.com/concours.html">Concours</a></h6>
                                            <ul>
                                                
                                                        <li><a href="http://www.siteduzero.com/concours-654-122-innov-game-2011-a-la-gloire-de.html">Innov'Game 2011 : A la gloire de</a></li>
                                                    
                                            </ul>
                                        </div>
                                        <div class="clear"></div>
                                    </div>


                                    <div id="menuh_job" style="display: none;">
                                        <div class="menu_princi">
                                            <div class="menuh_princi_col">
                                                <div class="menuh_list_category">
                                                    <h6>Dernières annonces</h6>
                                                    <div class="menuh_list_category_job">
                                                        
                                                            <a title="Consulter le poste : Ingénieur d’études Java …" href="http://www.siteduzero.com/emploi/105/ingenieur-d-etudes-java-ee" class="corpsmenu">
                                                                <span class="last_jobs">
                                                                    <span title="CDI" class="job_type jobtypes1">CDI</span>
                                                                </span>
                                                                <span>
                                                                    <span class="job_title">Ingénieur d’études Java …</span>
                                                                    <span style="color: rgb(0, 0, 0);">Orange Business Services</span>
                                                                </span>
                                                            </a>
                                                        
                                                            <a title="Consulter le poste : Stagiaire Développeur PHP (…" href="http://www.siteduzero.com/emploi/28/stagiaire-developpeur-php" class="corpsmenu">
                                                                <span class="last_jobs">
                                                                    <span title="App." class="job_type jobtypes4">App.</span> <span title="Stage" class="job_type jobtypes3">Stage</span>
                                                                </span>
                                                                <span>
                                                                    <span class="job_title">Stagiaire Développeur PHP (…</span>
                                                                    <span style="color: rgb(0, 0, 0);">Ideys</span>
                                                                </span>
                                                            </a>
                                                        
                                                            <a title="Consulter le poste : Développeur Php / Mysql (H/…" href="http://www.siteduzero.com/emploi/104/developpeur-php-mysql" class="corpsmenu">
                                                                <span class="last_jobs">
                                                                    <span title="CDI" class="job_type jobtypes1">CDI</span>
                                                                </span>
                                                                <span>
                                                                    <span class="job_title">Développeur Php / Mysql (H/…</span>
                                                                    <span style="color: rgb(0, 0, 0);">10 MEDIAS</span>
                                                                </span>
                                                            </a>
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                                
                                                <div class="menuh_princi_col">
                                                    
                                                        <div class="menuh_list_category">
                                                            <h6>Annonces à la une</h6>
                                                            <div class="menuh_list_category_job">
                                                                
                                                                    <a title="Consulter le poste : Développeur Web (H/F)" href="http://www.siteduzero.com/emploi/96/developpeur-web" class="corpsmenu">

                                                                        <span class="last_jobs">
                                                                            <span title="CDI" class="job_type jobtypes1">CDI</span>
                                                                        </span>
                                                                        <span>
                                                                            <span class="job_title">Développeur Web (H/F)</span>
                                                                            <span style="color: rgb(0, 0, 0);">Gibert Joseph</span>
                                                                        </span>
                                                                    </a>
                                                                
                                                                    <a title="Consulter le poste : Ingénieur logiciel (H/F)" href="http://www.siteduzero.com/emploi/36/ingenieur-logiciel" class="corpsmenu">

                                                                        <span class="last_jobs">
                                                                            <span title="App." class="job_type jobtypes4">App.</span>
                                                                        </span>
                                                                        <span>
                                                                            <span class="job_title">Ingénieur logiciel (H/F)</span>
                                                                            <span style="color: rgb(0, 0, 0);">AFTI</span>
                                                                        </span>
                                                                    </a>
                                                                
                                                            </div>
                                                        </div>
                                                      
                                                    <div class="menuh_list_category">
                                                        <div>
                                                            <div><a href="http://www.siteduzero.com/emploi.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/speed_barre_btn_recherche_emploi.png" alt=""></a></div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="menuh_more2">
                                                        <a href="http://www.siteduzero.com/emploi/liste.html">Toutes les annonces<img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/fleche_droite.png" alt="►"></a>
                                                </div>
                                            </div>
                                        <div class="clear"></div>
                                    </div>

                                    <div id="menuh_study" style="display: none; padding-left: 15px;">
                                        <div class="menu_princi">
                                            <div class="ico_study"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/ico_etude.png" alt="icon etude" width="50"></div>
                                            <div class="menuh_princi_col">
                                                <div class="menuh_list_category">
                                                    <h6>Recrutement à Bac / Bac +1</h6>
                                                    <ul>
                                                        <li><a href="http://www.siteduzero.com/etudes-550-280-bts.html">BTS</a></li>
                                                        <li><a href="http://www.siteduzero.com/etudes-550-269-ecoles-d-ing%C3%A9nieurs-en-informatique.html">Ecoles d'ingénieurs en informatique</a></li>
                                                        <li><a href="http://www.siteduzero.com/etudes-550-274-ecoles-d-ing%C3%A9nieurs-generalistes.html">Ecoles d'ingénieurs généralistes</a></li>
                                                        <li><a href="http://www.siteduzero.com/etudes-550-283-iut.html">IUT</a></li>
                                                        <li><a href="http://www.siteduzero.com/etudes-550-300-universites.html">Universités</a></li>
                                                        <li><a href="http://www.siteduzero.com/etudes-550-287-autre-formation-diplomantes.html">Autres formations diplômantes</a></li>
                                                        <li><a href="http://www.siteduzero.com/etudes-550-448-cpge.html">CPGE</a></li>
                                                    </ul>
                                                </div>

                                                <div class="menuh_list_category">
                                                    <h6>Recrutement à Bac +2</h6>
                                                    <ul>
                                                       <li><a href="http://www.siteduzero.com/etudes-550-270-ecoles-d-ing%C3%A9nieurs-en-informatique.html">Ecoles d'ingénieurs en informatique</a></li>
                                                       <li><a href="http://www.siteduzero.com/etudes-550-273-ecoles-d-ing%C3%A9nieurs-generalistes.html">Ecoles d'ingénieurs généralistes</a></li>
                                                       <li><a href="http://www.siteduzero.com/etudes-550-289-autre-formation-diplomantes.html">Autres formations diplômantes</a></li>
                                                    </ul>
                                                </div>
                                            </div>

                                            <div class="menuh_princi_col">
                                                <div class="menuh_list_category">
                                                    <h6>Recrutement à Bac +3 / Bac +4</h6>
                                                    <ul>
                                                        <li><a href="http://www.siteduzero.com/etudes-550-388-ecoles-d-ing%C3%A9nieurs-en-informatique.html">Ecoles d'ingénieurs en informatique</a></li>
                                                        <li><a href="http://www.siteduzero.com/etudes-550-389-ecoles-d-ing%C3%A9nieurs-generalistes.html">Ecoles d'ingénieurs généralistes</a></li>
                                                        <li><a href="http://www.siteduzero.com/etudes-550-390-autre-formation-diplomantes.html">Autres formations diplômantes</a></li>
                                                    </ul>
                                                </div>

                                                <div class="menuh_list_category">
                                                    <h6>Recrutement à Bac +5</h6>
                                                    <ul>
                                                       <li><a href="http://www.siteduzero.com/etudes-550-299-doctorats.html">Doctorats</a></li>
                                                       <li><a href="http://www.siteduzero.com/etudes-550-391-autre-formation-diplomantes.html">Autres formations diplômantes</a></li>
                                                    </ul>
                                                    <div class="menuh_list_category">
                                                        <div id="find_training">
                                                            <div><a href="http://www.siteduzero.com/etudes.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/ico_recherche_cours.png" alt=""><strong>Trouvez une formation</strong></a></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="clear"></div>
                                    </div>

                                    <div id="menuh_shop" style="display: none;">
                                        <div class="flagship_products bandeaunouveau">
                                            <a style="display: block; height: 144px;" href="http://www.siteduzero.com/boutique-614-430-apprenez-a-programmer-en-java.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/livre_cours_java_2d.png" alt="Apprenez à programmer en Java"></a>
                                            <h5>Apprenez à programmer en Java</h5>
                                            <div class="price" style="margin-top: 30px;">
                                                32 €
                                            </div>
                                            <span><a class="bouton_action fl" href="http://www.siteduzero.com/boutique-614-430-apprenez-a-programmer-en-java.html">Acheter</a></span>
                                        </div>
                                        
                                        <div class="flagship_products">
                                            <a href="http://www.siteduzero.com/boutique-614-188-cle-usb-du-site-du-zero-8-go.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/image_usb_speedbarre.jpg" alt="cle usb"></a>
                                            <h5>Clé USB du site du Zéro</h5>
                                            <a href="http://www.siteduzero.com/boutique-614-184-cle-usb-du-site-du-zero-4-go.html">4 Go</a>
                                            - <a href="http://www.siteduzero.com/boutique-614-188-cle-usb-du-site-du-zero-8-go.html">8 Go</a>
                                            - <a href="http://www.siteduzero.com/boutique-614-191-cle-usb-du-site-du-zero-16-go.html">16 Go</a><br>
                                            <div class="price">
                                                <span class="min_price">À partir de</span><br>
                                                15,20 €
                                            </div>
                                            <span><a class="bouton_action fl" href="http://www.siteduzero.com/boutique-614-188-cle-usb-du-site-du-zero-8-go.html">Acheter</a></span>
                                        </div>

                                    <div class="other_products">
                                        <span>Concevez votre site web avec PHP et MySQL<br>
                                        <a href="http://www.siteduzero.com/boutique-614-107-concevez-votre-site-web-avec-php-et-mysql.html">En savoir plus ►</a></span>
                                        <a href="http://www.siteduzero.com/boutique-614-107-concevez-votre-site-web-avec-php-et-mysql.html">
                                        <img style="margin: 13px 0pt 0pt 22px;" alt="Concevez votre site web avec php et mysql" src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/livre_cours_php_2d.png"></a>
                                    </div>

                                    <div class="other_products">
                                        <span>Apprenez à programmer en C <br>
                                        <a href="http://www.siteduzero.com/boutique-614-65-apprenez-a-programmer-en-c.html">En savoir plus ►</a></span>
                                        <a href="http://www.siteduzero.com/boutique-614-65-apprenez-a-programmer-en-c.html">
                                        <img style="margin: 13px 0pt 0pt 22px;" alt="Apprenez à programmer en C" src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/livre_cours_c_2d.png"></a>
                                    </div>
                                    <div class="other_products">
                                        <span>Reprenez le contrôle à l'aide de Linux <br>
                                        <a href="http://www.siteduzero.com/boutique-614-171-reprenez-le-controle-a-l-aide-de-linux.html">En savoir plus ►</a></span>
                                        <a href="http://www.siteduzero.com/boutique-614-171-reprenez-le-controle-a-l-aide-de-linux.html">
                                        <img style="margin: 13px 0pt 0pt 22px;" alt="Reprenez le contrôle à l'aide de Linux" src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/livre_cours_linux_2d.png"></a>
                                    </div>

                                    <div class="other_products">
                                        <span>Rédigez des documents de qualité avec LaTeX<br>
                                        <a href="http://www.siteduzero.com/boutique-614-207-redigez-des-documents-de-qualite-avec-latex.html">En savoir plus ►</a></span>
                                        <a href="http://www.siteduzero.com/boutique-614-207-redigez-des-documents-de-qualite-avec-latex.html">
                                        <img style="margin: 13px 0pt 0pt 22px;" alt="Rédigez des documents de qualité avec LaTeX" src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/livre_cours_latex_2d.png"></a>
                                    </div>
                                      
                                    <div class="menuh_more">
                                        <a href="http://www.siteduzero.com/boutique.html">Tous les produits <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/fleche_droite_002.png" alt="►"></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="search_bar">
                        <div class="ard"></div>
                        <form method="get" action="recherche.html" id="recherche">
                            <p>
                                <input name="src" id="champ_recherche" accesskey="4" value="Rechercher" type="text">
                                <select name="c" id="section_recherche">
                                    <option value="3" selected="selected">Cours</option>
                                    <option value="6">Forums</option>
                                    <option value="4">News</option>
                                    <option value="mbr">Membres</option>
                                    <option value="formation">Études</option>
                                    <option value="codeweb">Code web</option>
                                    <option value="mp">MP</option>
                                </select>
                                <input class="button_go_search" value="Go" type="submit">
                                <a class="button_more_search" href="http://www.siteduzero.com/recherche.html">+</a>
                            </p>
                        </form>
                        </div>

                    </div>

<script type="text/javascript">

    
        //On Hover

    var keyCodeEscape = 27;
    $(document).keyup(function(f) {
        if (f.keyCode == keyCodeEscape)
        {
            hideBlocMenu();
        }
    });


    /* Var for speedbar*/
    showDelay = 300;
    hiddenDelay = 367;
    fadeInDelay = 100
    fadeOutDelay = 100
    timer = null;
    hideTimeOut = null
    // speedbar function
    function speedShowDelay(){
        if($('.menuh_content > div').is(':visible'))
        {
            showDelay = null;
        }
        else
        {
            showDelay = 300;
        }
    }
    
    $("body").mouseleave(function(){
        $('.menuh_content > div').hide();
        $('#speedbarre .smenu>li a').removeClass("smenu_hover");
    });
    
    function showMenu(id, id2){

        $(id2).click(function(){
            clearInterval(timer);
            hideBlocMenu();
            return;
        });

        speedShowDelay();

        $("body").unbind('click');

        clearInterval(timer);
        if(!$(id).is(':visible'))
        {
            $('.menuh_content > div').hide();

            $('#speedbarre .smenu>li a').removeClass("smenu_hover");
            $('#speedbarre .smenu > li > .speedbarre_arrow').hide();

            timer=setInterval(function(){
                $(id+' ,#speedbar_expand').fadeIn(fadeInDelay);
                $(id2+' a').addClass('smenu_hover')
                clearInterval(timer);

                },showDelay);
        }
    }

    function hideMenu(id, id2){

        clearInterval(timer);
        clearTimeout(hideTimeOut);

        $("body").bind('click',function(){
            hideBlocMenu();
        });

        timer=setInterval(function(){
            $(id).fadeOut(fadeOutDelay,function(){
                $('#speedbar_expand').hide();
                $('#speedbarre .smenu>li a').removeClass("smenu_hover");
            });
            clearInterval(timer);
        },hiddenDelay)
    }

    function hideBlocMenu(){
        $('.menuh_content > div').fadeOut(fadeOutDelay, function(){
            $('#speedbar_expand').hide();
            $('#speedbarre .smenu>li a').removeClass("smenu_hover");})
    }

        /* speedbar */


    $("#speed_cours").addClass('hideOnLoad');
    $("#speed_forum").addClass('hideOnLoad');
    $("#speed_concours").addClass('hideOnLoad');
    $("#speed_job").addClass('hideOnLoad');
    $("#speed_etudes").addClass('hideOnLoad');
    $("#speed_boutique").addClass('hideOnLoad');



    $(document).mousemove(function(){
        $("#speed_cours").removeClass('hideOnLoad');
        $("#speed_forum").removeClass('hideOnLoad');
        $("#speed_concours").removeClass('hideOnLoad');
        $("#speed_job").removeClass('hideOnLoad');
        $("#speed_etudes").removeClass('hideOnLoad');
        $("#speed_boutique").removeClass('hideOnLoad');
    })


    //TUTORIALS
    $("#speed_cours, #menuh_tutorials").hover(function(){
        clearTimeout(hideTimeOut);
        id = '#menuh_tutorials';
        id2 = '#speed_cours';
        if(!$(id2).hasClass('hideOnLoad'))
        {
            hideTimeOut = setTimeout(function(){
                showMenu(id, id2);
            },100);
        }

    ;},function(){

        id = '#menuh_tutorials';
        id2 = '#speed_cours';
        hideMenu(id, id2);
    });
    //FORUMS
    $("#speed_forum, #menuh_forum").hover(function(){
        clearTimeout(hideTimeOut);
        id = '#menuh_forum';
        id2 = '#speed_forum';

        if(!$(id2).hasClass('hideOnLoad'))
        {
            hideTimeOut = setTimeout(function(){
                showMenu(id, id2);
            },100);
        }

    ;},function(){

        id = '#menuh_forum';
        id2 = '#speed_forum';
        hideMenu(id, id2);
    });

    //COLLABORATE
    $("#speed_concours, #menuh_collaborate").hover(function(){
        clearTimeout(hideTimeOut);
        id = '#menuh_collaborate';
        id2 = '#speed_concours';
        if(!$(id2).hasClass('hideOnLoad'))
        {
            hideTimeOut = setTimeout(function(){
                showMenu(id, id2);
            },100);
        }

    ;},function(){

        id = '#menuh_collaborate';
        id2 = '#speed_concours';
        hideMenu(id, id2);
    });

    //JOB
    $("#speed_job, #menuh_job").hover(function(){
        clearTimeout(hideTimeOut);
        id = '#menuh_job';
        id2 = '#speed_job';
        if(!$(id2).hasClass('hideOnLoad'))
        {
            hideTimeOut = setTimeout(function(){
                showMenu(id, id2);
            },100);
        }

    ;},function(){

        id = '#menuh_job';
        id2 = '#speed_job';
        hideMenu(id, id2);
    });

    //STUDY
    $("#speed_etudes, #menuh_study").hover(function(){
        clearTimeout(hideTimeOut);
        id = '#menuh_study';
        id2 = '#speed_etudes';
        if(!$(id2).hasClass('hideOnLoad'))
        {
            hideTimeOut = setTimeout(function(){
                showMenu(id, id2);
            },100);
        }

    ;},function(){

        id = '#menuh_study';
        id2 = '#speed_etudes';
        hideMenu(id, id2);
    });

    //SHOP
    $("#speed_boutique, #menuh_shop").hover(function(){
        clearTimeout(hideTimeOut);
        id = '#menuh_shop';
        id2 = '#speed_boutique';
        if(!$(id2).hasClass('hideOnLoad'))
        {
            hideTimeOut = setTimeout(function(){
                showMenu(id, id2);
            },100);
        }

    ;},function(){

        id = '#menuh_shop';
        id2 = '#speed_boutique';
        hideMenu(id, id2);
    });

    

</script>
            
            <div class="contenu">
                <div id="menu">
                    

                    <div class="box_menu">
                        <h5>Cours</h5>

                        <div class="corpsmenu">
                            <ul>
                                
                                    <li style="border-bottom: 0pt none; padding: 0pt 0pt 2px; background-color: rgb(226, 240, 255);">
                                        <a href="http://www.siteduzero.com/tutoriel-3-361996-par-ou-commencer.html"><img style="padding-left: 5px;" src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/compass.png" class="fl" alt=""></a>
                                        <div class="liste_cours_menu" style="margin-left: 43px;">
                                            <a href="http://www.siteduzero.com/tutoriel-3-361996-par-ou-commencer.html"><strong class="menu_cours_section">Nouveau ?</strong></a>
                                            <ul>
                                                <li><a href="http://www.siteduzero.com/tutoriel-3-361996-par-ou-commencer.html">Suivez le guide !</a></li>
                                            </ul>
                                        </div>
                                    </li>
                                    <li>
                                        <a href="http://www.siteduzero.com/tutoriel-1-67-site-web.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/67.png" class="fl" alt=""></a>
                                        <div class="liste_cours_menu">
                                            <a href="http://www.siteduzero.com/tutoriel-1-67-site-web.html"><strong class="menu_cours_section">Site Web</strong></a>
                                            <ul>
                                                <li><a href="http://www.siteduzero.com/tutoriel-3-13666-apprenez-a-creer-votre-site-web.html">XHTML / CSS</a></li>
                                                <li><a href="http://www.siteduzero.com/tutoriel-3-309961-dynamisez-vos-sites-web-avec-javascript.html">Javascript</a></li>
                                                <li>
                                                    <a href="http://www.siteduzero.com/tutoriel-3-14668-concevez-votre-site-web-avec-php-et-mysql.html">
                                                        PHP / MySQL
                                                    </a>
<!--                                                    <a href="boutique-614-107-concevez-votre-site-web-avec-php-et-mysql.html">-->
                                                    <a href="http://www4.smartadserver.com/call/cliccommand/4083179/92456312?">
                                                        <span class="in_book"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/ico_livre.png" alt=""></span>
                                                        <span style="display: none;">Ce cours existe en livre :<br>Concevez votre site web avec PHP et MySQL</span>
                                                    </a>
                                                </li>
                                                <li><a href="http://www.siteduzero.com/tutoriel-3-112219-apprenez-a-creer-des-applications-web-dynamiques-avec-jee.html">Java EE (J2EE)</a></li>
                                            </ul>
                                        </div>
                                    </li>
                                    <li>
                                        <a href="http://www.siteduzero.com/tutoriel-1-57-programmation.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/57.png" class="fl" alt=""></a>
                                        <div class="liste_cours_menu">
                                            <a href="http://www.siteduzero.com/tutoriel-1-57-programmation.html"><strong class="menu_cours_section">Programmation</strong></a>
                                            <ul>
                                                <li>
                                                    <a href="http://www.siteduzero.com/tutoriel-3-14189-apprenez-a-programmer-en-c.html">
                                                        Langage C
                                                    </a>
<!--                                                    <a href="boutique-614-65-apprenez-a-programmer-en-c.html">-->
                                                    <a href="http://www4.smartadserver.com/call/cliccommand/4083176/92456312?">
                                                        <span class="in_book"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/ico_livre.png" alt=""></span>
                                                        <span style="display: none;">Ce cours existe en livre :<br>Apprenez à programmer en C</span>
                                                    </a>
                                                </li>
                                                <li><a href="http://www.siteduzero.com/tutoriel-3-11406-apprenez-a-programmer-en-c.html">Langage C++</a></li>
                                                <li>
                                                    <a href="http://www.siteduzero.com/tutoriel-3-10601-programmation-en-Java.html">
                                                        Java
                                                    </a>
                                                    <a href="http://www4.smartadserver.com/call/cliccommand/4083191/92456312?">
<!--                                                    <a href="boutique-614-430-apprenez-a-programmer-en-java.html">-->
                                                        <span class="in_book"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/ico_livre.png" alt=""></span>
                                                        <span style="display: none;">Ce cours existe en livre :<br>Apprenez à programmer en Java</span>
                                                    </a>
                                                </li>
                                                <li><a href="http://www.siteduzero.com/tutoriel-3-119239-programmation-en-java-api.html">Java (API)</a></li>
                                                <li><a href="http://www.siteduzero.com/tutoriel-3-223267-apprendre-python.html">Python </a></li>
                                                <li><a href="http://www.siteduzero.com/tutoriel-3-134798-visual_basic_net.html">VB .NET</a></li>
                                            </ul>
                                        </div>
                                    </li>
                                    <li>                                        
                                        <a href="http://www.siteduzero.com/tutoriel-1-60-systemes-d-exploitation.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/60.png" class="fl" alt=""></a>
                                        <div class="liste_cours_menu">
                                            <a href="http://www.siteduzero.com/tutoriel-1-60-systemes-d-exploitation.html"><strong class="menu_cours_section">Systèmes d'exploitation</strong></a>
                                            <ul>
                                                <li>
                                                    <a href="http://www.siteduzero.com/tutoriel-3-12827-reprenez-le-controle-a-l-aide-de-linux.html">
                                                        Linux
                                                    </a>
                                                    <a href="http://www4.smartadserver.com/call/cliccommand/4083193/92456312?">
<!--                                                    <a href="boutique-614-171-reprenez-le-controle-a-l-aide-de-linux.html">-->
                                                        <span class="in_book"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/ico_livre.png" alt=""></span>
                                                        <span style="display: none;">Ce cours existe en livre :<br>Reprenez le contrôle a l'aide de Linux</span>
                                                    </a>
                                                </li>
                                                <li><a href="http://www.siteduzero.com/tutoriel-3-273305-freebsd-et-l-envers-du-decor.html">FreeBSD</a></li>
                                            </ul>
                                        </div>
                                    </li>
                                    <li>
                                        <a href="http://www.siteduzero.com/tutoriel-1-56-graphisme.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/56.png" class="fl" alt=""></a>
                                        <div class="liste_cours_menu">
                                            <a href="http://www.siteduzero.com/tutoriel-1-56-graphisme.html"><strong class="menu_cours_section">Graphisme</strong></a>
                                            <ul>
                                                <li><a href="http://www.siteduzero.com/tutoriel-3-351765-debuter-sur-adobe-photoshop.html">Photoshop</a></li>
                                            </ul>
                                        </div>
                                    </li>
                                    <li>
                                        <a href="http://www.siteduzero.com/tutoriel-1-58-infographie-3d.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/58.png" class="fl" alt=""></a>
                                        <div class="liste_cours_menu">
                                            <a href="http://www.siteduzero.com/tutoriel-1-58-infographie-3d.html"><strong class="menu_cours_section">Infographie 3D</strong></a>
                                            <ul>
                                                <li><a href="http://www.siteduzero.com/tutoriel-3-11714-debutez-dans-la-3d-avec-blender.html">Blender</a></li>
                                                <li><a href="http://www.siteduzero.com/tutoriel-3-228998-apprenez-a-modeliser-en-3d-avec-autodesk-maya.html">Maya</a></li>
                                            </ul>
                                        </div>
                                    </li>

                                    <li>
                                        <a href="http://www.siteduzero.com/tutoriel-1-55-bureautique.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/55.png" class="fl" alt=""></a>
                                        <div class="liste_cours_menu">
                                            <a href="http://www.siteduzero.com/tutoriel-1-55-bureautique.html"><strong class="menu_cours_section">Bureautique</strong></a>
                                            <ul>
                                                <li>
                                                    <a href="http://www.siteduzero.com/tutoriel-3-258577-redigez-des-documents-de-qualite-professionnelle-avec-latex.html">
                                                        LaTeX
                                                    </a>
                                                    <a href="http://www4.smartadserver.com/call/cliccommand/4083195/92456312?">
<!--                                                    <a href="boutique-614-207-redigez-des-documents-de-qualite-professionnelle-avec-latex.html">-->
                                                        <span class="in_book"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/ico_livre.png" alt=""></span>
                                                        <span style="display: none;">Ce cours existe en livre :<br>Rédigez des documents de qualité avec LaTeX</span>
                                                    </a>
                                                </li>
                                                <li><a href="http://www.siteduzero.com/tutoriel-3-417000-redigez-facilement-des-documents-avec-word.html">Word<img style="margin-left: 10px;" alt="" src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/iconouveau.png"></a></li>
                                            </ul>
                                        </div>
                                    </li>
                                    
                                    
                                    <li>
                                        <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/die.png" class="fl" alt="">
                                        <div class="liste_cours_menu">
                                            <strong class="menu_cours_section">Tutoriel du jour</strong><br>
                                            <ul>
                                                <li>
                                                    <a href="http://www.siteduzero.com/tutoriel-3-10118-comment-utiliser-les-sockets-avec-php-comment-creer-un-chat-avec-les-sockets.html">Comment utiliser les sockets avec PHP ? Comment créer un chat avec les sockets ?</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </li>
                                
                                <li class="last_idem_liste">
                                    <div id="menu_ajout_cours">
                                        <ul>
                                            <li>
                                                
                                                    <a href="http://www.siteduzero.com/tutoriel-3-256867-devenez-auteur-de-cours-sur-le-site-du-zero-et-le-livre-du-zero.html">
                                                
                                                Rédigez un cours <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/add.png" alt="">&nbsp;</a>
                                             </li>
                                             <li>
                                                 <a href="http://www.siteduzero.com/tutoriel.html" title="Tous les cours">Tous les cours  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/fleche_droite.png" alt="">&nbsp;</a>
                                             </li>
                                         </ul>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="corps">
                    <div id="zozor_position">
                        <div id="zozor">
                            <div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/zozor6.png" alt=" Zozor" title=" Zozor"></div>
                       </div>
                    </div>

                    <div id="container_bulle_zozor">
                        
                    </div>

                    <div id="arbre">
                        
			&gt;  <a href="http://www.siteduzero.com/">Le Site du Zéro</a>
		
			&gt;  <a href="http://www.siteduzero.com/tutoriel.html">Cours</a>
			 &gt;  <a href="http://www.siteduzero.com/tutoriel-1-352-tutoriels.html">Tutoriels</a>
		 &gt;  <a href="http://www.siteduzero.com/tutoriel-1-57-programmation.html">Programmation</a>
		 &gt;  <a href="http://www.siteduzero.com/tutoriel-1-344-bibliotheques.html">Bibliothèques</a>
		 &gt;  <a href="http://www.siteduzero.com/tutoriel-2-379-moteurs-3d.html">Moteurs 3D</a>
		&gt;  <a href="http://www.siteduzero.com/tutoriel-3-334502-decouvrez-ogre-3d.html">Découvrez Ogre 3D</a> 

&gt; Lecture du tutoriel

                    </div>

                    


<h1>Découvrez Ogre 3D</h1>


<div id="onglets_tutos" class="onglets_tutos">
  <ul>
    
      <li class="selected">
      <a href="http://www.siteduzero.com/tutoriel-3-334502-decouvrez-ogre-3d.html">Tutoriel</a></li>
    
      <li>
      <a href="http://www.siteduzero.com/tutoriel-50-334502-p2-decouvrez-ogre-3d.html#r72657">59 commentaires</a></li>
    
      <li>
      <a href="http://www.siteduzero.com/tutoriel-21-334502-decouvrez-ogre-3d.html">Historique</a></li>
    
  </ul>
</div>
<hr class="bas_onglets">





<div class="cadre_auteur_date">
  <form action="tutoriel-54-334502.html" method="post">
    <div class="dnone"><input value="c8eb538544019f565b13390776780274d59736e9" name="challenge" type="hidden"></div>

    <div class="infobox">
<h3 class="special">Informations sur le tutoriel</h3>
<div class="conteneur_infobox">
<table>
  <tbody><tr>
    <td>
    <div class="boite_avatar_100px">
      <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/logoFirefox100x100.png" style="width: 100px; height: 100px; display: block;" alt="Avatar" class="avatar" id="avatar123922">  
     </div>
    </td>
    <td>
     
      <strong>Auteur</strong> :
      
    
	    <a class="auteur_tut" href="http://www.siteduzero.com/membres-294-123922.html">Midnight Falcon</a>
    
      <br>
    
      
		  <strong>Difficulté</strong> :
		  
			<img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/niveau_2.png" alt="Intermédiaire">
		  
		  <br>
	  
		<strong>Temps d'étude estimé</strong> : 
		
			4 
			jours
		<br>
	<strong>Licence</strong> : <a href="http://creativecommons.org/licenses/by-nc-sa/2.0/fr/"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/6.png" alt="Creative Commons BY-NC-SA" title="Creative Commons BY-NC-SA"></a><br><br>
      <br>
      <a href="#tuto_details" onclick="return false;" id="tuto_details_plus">Plus d'informations <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/fleche_bas.png" alt="Plus d'informations" title="Plus d'informations" id="image_detail"></a>
      <a href="#onglets_tutos" onclick="return false;" id="tuto_details_moins" style="display: none;">Moins d'informations <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/fleche_haut.png" alt="Plus d'informations" title="Plus d'informations" id="image_detail_moins"></a>
      <script type="text/javascript">
          var lien_plus = document.getElementById('tuto_details_plus');
          var lien_moins = document.getElementById('tuto_details_moins');

          var toggleDetails = function()
          {
              toggle('infos_detaillees');
              toggle('tuto_details_plus');
              toggle('tuto_details_moins');
              return false;
          };

          if(lien_plus.addEventListener)
          {
              lien_plus.addEventListener('click', toggleDetails , false);
          } else
          {
              lien_plus.attachEvent('onclick', toggleDetails);
          }

          if(lien_moins.addEventListener)
          {
              lien_moins.addEventListener('click', toggleDetails , false);
          } else
          {
              lien_moins.attachEvent('onclick', toggleDetails);
          }
          
      </script>

      <div style="display: none;" id="infos_detaillees">
	<br>			
<strong>Créé</strong> : Le 16/06/2010 à 09:09:36<br>
<strong>Modifié</strong> : Le 07/03/2011 à 14:20:08<br>

<strong>Avancement</strong> : 30%<br>

<br>


  <a href="http://www.zcorrecteurs.fr/"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/zcorrige.png" alt="L'orthographe, la grammaire et la présentation de ce tutoriel ont été vérifiées par les zCorrecteurs." title="L'orthographe, la grammaire et la présentation de ce tutoriel ont été vérifiées par les zCorrecteurs."></a><br>

<a href="http://www.siteduzero.com/tutoriel-50-334502-72657-decouvrez-ogre-3d.html#r72657">59 commentaires</a><br>

  <a href="http://www.siteduzero.com/tutoriel-3-334502-decouvrez-ogre-3d.html">Revenir au sommaire du tutoriel</a><br>


      </div>

    </td>
  </tr>
</tbody></table>
</div>
</div>


    <div class="infobox">
        <h3 class="special">Popularité</h3>
        <div class="conteneur_infobox">
            <strong>Visualisations</strong> : 34&nbsp;358<br><br>
            <div style="padding-top: 1px; float: left;"><strong>Appréciation<br>des lecteurs</strong> : </div>
            <div class="tut_appreciation">
                <div class="tut_appreciation_smiley" id="smiley-1-14338--36918" style="background-position: -19px 50%;"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/empty.gif" alt=""></div>
                <span id="eval_nb-1">2</span>
            </div>
            <div class="tut_appreciation">
                <div class="tut_appreciation_smiley" id="smiley-2-14338--36918" style="background-position: -57px 50%;"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/empty.gif" alt=""></div>
                <span id="eval_nb-2">4</span>
            </div>
            <div class="tut_appreciation">
                <div class="tut_appreciation_smiley" id="smiley-3-14338--36918" style="background-position: -95px 50%;"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/empty.gif" alt=""></div>
                <span id="eval_nb-3">8</span>
            </div>
            <div class="tut_appreciation">
                <div class="tut_appreciation_smiley eval_always_color" id="smiley-4-14338--36918" style="background-position: -114px 50%;"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/empty.gif" alt=""></div>
                <span id="eval_nb-4">70</span>
            </div>
            
            <div style="clear: both;"></div>
            
                <p id="tut_vot_ldz" style="text-align: center;">
                    <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/thb_livre_cours_c.png" id="tut_vot_ldz_img" alt="">
                    
                                <b>218 personnes</b> souhaitent voir ce tutoriel publié en livre ! <br> <a href="http://www.siteduzero.com/vote/ldz/14338.html" id="tut_vot_ldz_link">Vous aussi ?</a>
                            
                </p>
            
        </div>
    </div>


<div class="infobox" id="pave_pub_tuto" style="display: block;">
<h3 class="special">Publicité</h3>
<div class="conteneur_infobox">
<table style="width: 100%;">
  <tbody><tr>
    <td colspan="2" id="menu_pub_tuto">
        
            
    <script type="text/javascript">
    sas_pageid= '24617/166249';              // Page
    sas_formatid=10602;                          // Format
    sas_target='';                                        // Targeting
    SmartAdServer(sas_pageid,sas_formatid,sas_target);
</script><script src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/a_002.js"></script>
<noscript>
    <a href="http://www4.smartadserver.com/call/pubjumpi/24617/166249/10602/S/1125160568/?">
    <img src="http://www4.smartadserver.com/call/pubi/24617/166249/10602/S/1125160568/?" border="0" alt="" /></a>
</noscript>



        
    </td>
  </tr>
</tbody></table>
</div>
</div>

    
	<div class="infobox">
		<h3 class="special">Historique des mises à jour</h3>
		<div class="conteneur_infobox">
			<ul>
				
					<li>
						<em>Le 08/03/2011 à 03:03:11</em><br>
						Correction orthographique suite au ticket #4064
					</li>
			  
					<li>
						<em>Le 07/03/2011 à 14:20:10</em><br>
						Ajout du premier chapitre de la partie 2 : "Une application à partir de zéro"
					</li>
			  
					<li>
						<em>Le 07/03/2011 à 02:59:56</em><br>
						Ajout du premier chapitre de la partie 2 : "Une application à partir de zéro".
					</li>
			  
			</ul>
		</div>
	</div>


        
            <div class="infobox expandable">
                <h3 class="special">Partager</h3>
                <div class="conteneur_infobox addthis_toolbox" style="text-decoration: none;" addthis:url="http://www.siteduzero.com/tutoriel-3-334502-decouvrez-ogre-3d.html?all=1" addthis:title="Découvrez Ogre 3D">
                    <div class="vertical">
                        <a class="addthis_button_print at300b" title="Imprimer"><span class="at300bs at15nc at15t_print"></span>Imprimer</a>
                        <a class="addthis_button_email at300b" title="Partager via Email"><span class="at300bs at15nc at15t_email"></span>Email</a>
                        <a target="_blank" href="http://www.addthis.com/bookmark.php?v=250&amp;winname=addthis&amp;pub=simpleit&amp;source=tbx-250&amp;lng=fr&amp;s=twitter&amp;u508=1&amp;url=http%3A%2F%2Fwww.siteduzero.com%2Ftutoriel-3-334502-decouvrez-ogre-3d.html%3Fall%3D1&amp;title=D%C3%A9couvrez%20Ogre%203D&amp;ate=AT-simpleit/-/-/4da293a3c2121ea5/1&amp;uid=4da293a33d969925&amp;sms_ss=1&amp;at_xt=1&amp;template=%7B%7Btitle%7D%7D%20%7B%7Burl%7D%7D%20%23SdZ&amp;ui_cobrand=Site%20du%20Z%C3%A9ro&amp;ui_header_color=%23ffffff&amp;ui_header_background=%237AB7FC&amp;CXNID=2000001.5215456080540439074NXC&amp;pre=http%3A%2F%2Fwww.siteduzero.com%2Ftutoriel-3-334502-decouvrez-ogre-3d.html&amp;tt=0" class="addthis_button_twitter at300b" title="Partager via Twitter"><span class="at300bs at15nc at15t_twitter"></span>Twitter</a>
                        <a target="_blank" href="http://www.addthis.com/bookmark.php?v=250&amp;winname=addthis&amp;pub=simpleit&amp;source=tbx-250&amp;lng=fr&amp;s=facebook&amp;u508=1&amp;url=http%3A%2F%2Fwww.siteduzero.com%2Ftutoriel-3-334502-decouvrez-ogre-3d.html%3Fall%3D1&amp;title=D%C3%A9couvrez%20Ogre%203D&amp;ate=AT-simpleit/-/-/4da293a3c2121ea5/2&amp;uid=4da293a3c4e41ac9&amp;sms_ss=1&amp;at_xt=1&amp;ui_cobrand=Site%20du%20Z%C3%A9ro&amp;ui_header_color=%23ffffff&amp;ui_header_background=%237AB7FC&amp;CXNID=2000001.5215456080540439074NXC&amp;pre=http%3A%2F%2Fwww.siteduzero.com%2Ftutoriel-3-334502-decouvrez-ogre-3d.html&amp;tt=0" class="addthis_button_facebook at300b" title="Partager via Facebook"><span class="at300bs at15nc at15t_facebook"></span>Facebook</a>
                        <a class="expend" href="#plus"><span class="more">&nbsp;</span>Plus de services</a>
                        <div style="display: none;" class="slidable">
                            <a target="_blank" href="http://www.addthis.com/bookmark.php?v=250&amp;winname=addthis&amp;pub=simpleit&amp;source=tbx-250&amp;lng=fr&amp;s=myspace&amp;u508=1&amp;url=http%3A%2F%2Fwww.siteduzero.com%2Ftutoriel-3-334502-decouvrez-ogre-3d.html%3Fall%3D1&amp;title=D%C3%A9couvrez%20Ogre%203D&amp;ate=AT-simpleit/-/-/4da293a3c2121ea5/3&amp;uid=4da293a34182401b&amp;sms_ss=1&amp;at_xt=1&amp;ui_cobrand=Site%20du%20Z%C3%A9ro&amp;ui_header_color=%23ffffff&amp;ui_header_background=%237AB7FC&amp;CXNID=2000001.5215456080540439074NXC&amp;pre=http%3A%2F%2Fwww.siteduzero.com%2Ftutoriel-3-334502-decouvrez-ogre-3d.html&amp;tt=0" class="addthis_button_myspace at300b" title="Partager via MySpace"><span class="at300bs at15nc at15t_myspace"></span>MySpace</a>
                            <a target="_blank" href="http://www.addthis.com/bookmark.php?v=250&amp;winname=addthis&amp;pub=simpleit&amp;source=tbx-250&amp;lng=fr&amp;s=googlebuzz&amp;u508=1&amp;url=http%3A%2F%2Fwww.siteduzero.com%2Ftutoriel-3-334502-decouvrez-ogre-3d.html%3Fall%3D1&amp;title=D%C3%A9couvrez%20Ogre%203D&amp;ate=AT-simpleit/-/-/4da293a3c2121ea5/4&amp;uid=4da293a3404f6868&amp;sms_ss=1&amp;at_xt=1&amp;ui_cobrand=Site%20du%20Z%C3%A9ro&amp;ui_header_color=%23ffffff&amp;ui_header_background=%237AB7FC&amp;CXNID=2000001.5215456080540439074NXC&amp;pre=http%3A%2F%2Fwww.siteduzero.com%2Ftutoriel-3-334502-decouvrez-ogre-3d.html&amp;tt=0" class="addthis_button_googlebuzz at300b" title="Partager via Google Buzz"><span class="at300bs at15nc at15t_googlebuzz"></span>Google Buzz</a>
                            <a target="_blank" href="http://www.addthis.com/bookmark.php?v=250&amp;winname=addthis&amp;pub=simpleit&amp;source=tbx-250&amp;lng=fr&amp;s=blogger&amp;u508=1&amp;url=http%3A%2F%2Fwww.siteduzero.com%2Ftutoriel-3-334502-decouvrez-ogre-3d.html%3Fall%3D1&amp;title=D%C3%A9couvrez%20Ogre%203D&amp;ate=AT-simpleit/-/-/4da293a3c2121ea5/5&amp;uid=4da293a3d68f6d5b&amp;sms_ss=1&amp;at_xt=1&amp;ui_cobrand=Site%20du%20Z%C3%A9ro&amp;ui_header_color=%23ffffff&amp;ui_header_background=%237AB7FC&amp;CXNID=2000001.5215456080540439074NXC&amp;pre=http%3A%2F%2Fwww.siteduzero.com%2Ftutoriel-3-334502-decouvrez-ogre-3d.html&amp;tt=0" class="addthis_button_blogger at300b" title="Partager via Blogger"><span class="at300bs at15nc at15t_blogger"></span>Blogger</a>
                            <a target="_blank" href="http://www.addthis.com/bookmark.php?v=250&amp;winname=addthis&amp;pub=simpleit&amp;source=tbx-250&amp;lng=fr&amp;s=buzz&amp;u508=1&amp;url=http%3A%2F%2Fwww.siteduzero.com%2Ftutoriel-3-334502-decouvrez-ogre-3d.html%3Fall%3D1&amp;title=D%C3%A9couvrez%20Ogre%203D&amp;ate=AT-simpleit/-/-/4da293a3c2121ea5/6&amp;uid=4da293a36c88e04a&amp;sms_ss=1&amp;at_xt=1&amp;ui_cobrand=Site%20du%20Z%C3%A9ro&amp;ui_header_color=%23ffffff&amp;ui_header_background=%237AB7FC&amp;CXNID=2000001.5215456080540439074NXC&amp;pre=http%3A%2F%2Fwww.siteduzero.com%2Ftutoriel-3-334502-decouvrez-ogre-3d.html&amp;tt=0" class="addthis_button_buzz at300b" title="Partager via Yahoo! Buzz"><span class="at300bs at15nc at15t_buzz"></span>Y! Buzz</a>
                            <a target="_blank" href="http://www.addthis.com/bookmark.php?v=250&amp;winname=addthis&amp;pub=simpleit&amp;source=tbx-250&amp;lng=fr&amp;s=live&amp;u508=1&amp;url=http%3A%2F%2Fwww.siteduzero.com%2Ftutoriel-3-334502-decouvrez-ogre-3d.html%3Fall%3D1&amp;title=D%C3%A9couvrez%20Ogre%203D&amp;ate=AT-simpleit/-/-/4da293a3c2121ea5/7&amp;uid=4da293a3c6b3787e&amp;sms_ss=1&amp;at_xt=1&amp;ui_cobrand=Site%20du%20Z%C3%A9ro&amp;ui_header_color=%23ffffff&amp;ui_header_background=%237AB7FC&amp;CXNID=2000001.5215456080540439074NXC&amp;pre=http%3A%2F%2Fwww.siteduzero.com%2Ftutoriel-3-334502-decouvrez-ogre-3d.html&amp;tt=0" class="addthis_button_live at300b" title="Partager via MSN Live"><span class="at300bs at15nc at15t_live"></span>MSN Live</a>
                            <a class="addthis_button_expanded at300m" title="Partager via un autre service"><span class="at300bs at15nc at15t_expanded"></span>Encore plus de services</a>
                        </div>
                    </div>
                <div class="atclear"></div></div>
            </div>
        
  </form>
</div>

<div id="btuto_intro">
	<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/239808.gif" alt="Image utilisateur"></div><br>
<br>
Ah, les jeux vidéo... Si vous êtes là, j'imagine que vous avez sûrement à
 un moment ou un autre voulu vous essayer à en programmer un, ne 
serait-ce que pour savoir <span class="italique">comment</span> on fait.
 Quels outils utilisent les professionnels ? Par où commencer et avec 
quels logiciels ? J'ai souvent vu ces questions sur le web, et je me les
 suis moi-même posées.<br>
<br>
Ce tutoriel a pour objectif de vous apporter un élément de réponse en 
vous initiant au moteur 3D Ogre, outil libre et gratuit très utilisé par
 les développeurs en herbe désireux de s'essayer à la 3D interactive, 
mais aussi par des équipes talentueuses voulant finaliser leur projet 
avec une solution puissante et gratuite. <br>
<br>
Plusieurs projets commerciaux basés sur Ogre ont en effet déjà vu le 
jour, certains sont très réussis ! On peut citer par exemple <span class="italique">Pacific Storm</span>, <span class="italique">Ankh : Une aventure égyptienne</span>, <span class="italique">The Blob</span>...<br>
<br>
<br>
Au programme, je vous propose une présentation des notions de base dans 
Ogre puis de son fonctionnement interne. À partir de ces connaissances, 
nous pourrons nous plonger dans des techniques avancées de rendu ainsi 
que dans quelques bibliothèques externes se couplant très bien avec 
Ogre.<br>
<br>
<br>
<br>
<div class="centre"><a href="http://uploads.siteduzero.com/files/239001_240000/239814.jpg"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/239814.jpg" alt="Image utilisateur"></a> <a href="http://uploads.siteduzero.com/files/239001_240000/239815.jpg"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/239815.jpg" alt="Image utilisateur"></a> <a href="http://uploads.siteduzero.com/files/239001_240000/239816.jpg"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/239816.jpg" alt="Image utilisateur"></a> <a href="http://uploads.siteduzero.com/files/241001_242000/241428.jpg"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/241428.jpg" alt="Image utilisateur"></a> <a href="http://uploads.siteduzero.com/files/241001_242000/241429.png"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/241429.png" alt="Image utilisateur"></a> <a href="http://uploads.siteduzero.com/files/241001_242000/241761.jpg"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/241761.jpg" alt="Image utilisateur"></a> <a href="http://uploads.siteduzero.com/files/241001_242000/241762.jpg"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/241762.jpg" alt="Image utilisateur"></a> <a href="http://uploads.siteduzero.com/files/241001_242000/241763.jpg"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/241763.jpg" alt="Image utilisateur"></a><br>
<span class="italique">Quelques images de jeux créés avec Ogre.</span></div><br>
<br>
Vous en voulez plus ? Allez faire un tour dans la <a href="http://www.ogre3d.org/gallery/">galerie</a> !<br>
<br>
<div class="rmq attention">La connaissance du C++ est indispensable pour
 pouvoir s'essayer à Ogre. Si vous ne connaissez pas ce langage, je vous
 invite à allez voir le <a href="http://www.siteduzero.com/tutoriel-3-11406-apprenez-a-programmer-en-c.html">tutoriel</a> disponible sur ce site et à lire au moins la première partie.</div>
</div>

<hr>



<div id="pre_liste_parties">
	Ce cours est composé des parties suivantes :
</div>

<ul id="liste_parties">
	
		<li><a href="#part_334497">Les bases</a></li>
	
		<li><a href="#part_439109">Au cœur de la bête</a></li>
	
</ul>
		<ul class="liste_parties_btut">
		
		<li>
		<hr class="separateur_parties">
		<h2 id="part_334497">Partie 1 : Les bases</h2>
		<div>
			On commence en douceur avec une première partie ayant pour but de 
découvrir les manipulations basiques d'Ogre et les objets récurrents du 
moteur. Ne vous méprenez pas : ce n'est pas parce que les manipulations 
sont simples qu'elles ne sont pas puissantes ! Vous serez rapidement en 
mesure de créer une petite scène avec ce que vous apprendrez ici : 
alors, qu'attendez-vous ?
		</div>
			
				<ul class="liste_chapitres_btut">
				
					<li>
						<br><br><a href="#chap_334489">1) Introduction à Ogre 3D</a>
						<div class="icone_chap">
							
								<img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/258794.png" alt="Icône du chapitre" class="icone_chapitre">
							
						</div>
						<div class="droite_chapitre">
						<ul class="liste_btuto_chap">
							
									<li><a href="#ss_part_334490">Un moteur 3D ?</a></li>
								
									<li><a href="#ss_part_334501">Pourquoi Ogre et pas un autre ?</a></li>
								
									<li><a href="#ss_part_334487">Téléchargement et installation</a></li>
								
						</ul>
						</div>
					</li>
				
					<li>
						<br><br><a href="#chap_334488">2) Votre première application</a>
						<div class="icone_chap">
							
								<img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/258797.png" alt="Icône du chapitre" class="icone_chapitre">
							
						</div>
						<div class="droite_chapitre">
						<ul class="liste_btuto_chap">
							
									<li><a href="#ss_part_334485">Configuration d'un projet</a></li>
								
									<li><a href="#ss_part_334483">Le code de base</a></li>
								
						</ul>
						</div>
					</li>
				
					<li>
						<br><br><a href="#chap_334498">3) Insérer des objets dans la scène</a>
						<div class="icone_chap">
							
								<img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/258800.jpg" alt="Icône du chapitre" class="icone_chapitre">
							
						</div>
						<div class="droite_chapitre">
						<ul class="liste_btuto_chap">
							
									<li><a href="#ss_part_334499">Les entités</a></li>
								
									<li><a href="#ss_part_334482">Les nœuds de scène</a></li>
								
									<li><a href="#ss_part_334496">Créer un mesh</a></li>
								
						</ul>
						</div>
					</li>
				
					<li>
						<br><br><a href="#chap_334492">4) Se repérer dans l'espace</a>
						<div class="icone_chap">
							
								<img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/260468.jpg" alt="Icône du chapitre" class="icone_chapitre">
							
						</div>
						<div class="droite_chapitre">
						<ul class="liste_btuto_chap">
							
									<li><a href="#ss_part_334493">Le système de coordonnées</a></li>
								
									<li><a href="#ss_part_334484">Déplacer des objets</a></li>
								
									<li><a href="#ss_part_334491">La caméra</a></li>
								
									<li><a href="#ss_part_334500">Le Viewport</a></li>
								
						</ul>
						</div>
					</li>
				
					<li>
						<br><br><a href="#chap_334494">5) Allumez la lumière !</a>
						<div class="icone_chap">
							
								<img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/258802.png" alt="Icône du chapitre" class="icone_chapitre">
							
						</div>
						<div class="droite_chapitre">
						<ul class="liste_btuto_chap">
							
									<li><a href="#ss_part_334486">Les lumières</a></li>
								
									<li><a href="#ss_part_334495">Les ombres</a></li>
								
						</ul>
						</div>
					</li>
				
					<li>
						<br><br><a href="#chap_425391">6) La gestion des entrées</a>
						<div class="icone_chap">
							
								<img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/275825.png" alt="Icône du chapitre" class="icone_chapitre">
							
						</div>
						<div class="droite_chapitre">
						<ul class="liste_btuto_chap">
							
									<li><a href="#ss_part_425389">Les frame listeners</a></li>
								
									<li><a href="#ss_part_425388">OIS</a></li>
								
									<li><a href="#ss_part_425392">Allons-y sans buffer</a></li>
								
									<li><a href="#ss_part_425387">Avec buffer, c'est plus simple ?</a></li>
								
						</ul>
						</div>
					</li>
				
					<li>
						<br><br><a href="#chap_425394">7) Gardez les pieds sur terre !</a>
						<div class="icone_chap">
							
								<img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/287514.png" alt="Icône du chapitre" class="icone_chapitre">
							
						</div>
						<div class="droite_chapitre">
						<ul class="liste_btuto_chap">
							
									<li><a href="#ss_part_425396">Créer un terrain</a></li>
								
									<li><a href="#ss_part_425395">Le plaquage de texture</a></li>
								
									<li><a href="#ss_part_425393">Et si on en veut plus ?</a></li>
								
									<li><a href="#ss_part_425390">Un ciel au-dessus de nos têtes</a></li>
								
						</ul>
						</div>
					</li>
				
				</ul>
				<div>
					<br>
					
				</div>
			
		</li>
		
		<li>
		<hr class="separateur_parties">
		<h2 id="part_439109">Partie 2 : Au cœur de la bête</h2>
		<div>
			Dans la première partie, nous avons fait connaissance avec Ogre en 
douceur, en découvrant petit à petit comment peupler la scène avec des 
objets, des lumières et des ombres, comment gérer les entrées 
utilisateur... Cette deuxième partie se propose de mettre l'accent sur 
le fonctionnement interne d'Ogre, que j'ai volontairement occulté au 
début pour ne pas vous donner trop d'informations d'un coup.<br>
<br>
Vous êtes maintenant des utilisateurs avertis, je vous propose donc d'ouvrir le capot et de creuser un peu la mécanique d'Ogre !
		</div>
			
				<ul class="liste_chapitres_btut">
				
					<li>
						<br><br><a href="#chap_439108">1) Une application à partir de zéro</a>
						<div class="icone_chap">
							
								<img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/361958.png" alt="Icône du chapitre" class="icone_chapitre">
							
						</div>
						<div class="droite_chapitre">
						<ul class="liste_btuto_chap">
							
									<li><a href="#ss_part_439112">Préparation</a></li>
								
									<li><a href="#ss_part_439110">Au début, une fenêtre</a></li>
								
									<li><a href="#ss_part_439113">Ajout du Frame Listener</a></li>
								
									<li><a href="#ss_part_439111">Implémenter OIS</a></li>
								
						</ul>
						</div>
					</li>
				
				</ul>
				<div>
					<br>
					
				</div>
			
		</li>
		
		</ul>

<hr>
<h2>Partie 1 : Les bases</h2>
<div>
On commence en douceur avec une première partie ayant pour but de 
découvrir les manipulations basiques d'Ogre et les objets récurrents du 
moteur. Ne vous méprenez pas : ce n'est pas parce que les manipulations 
sont simples qu'elles ne sont pas puissantes ! Vous serez rapidement en 
mesure de créer une petite scène avec ce que vous apprendrez ici : 
alors, qu'attendez-vous ?
</div>
	
	<hr>
	<h1 id="chap_334489">Introduction à Ogre 3D</h1>
	<div id="chap_intro">
	Avant de commencer à plonger nos mains dans le code, je vous propose 
une petite introduction à Ogre, pour que vous fassiez un peu plus 
connaissance. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/heureux.png" alt=":D" class="smilies">
	</div>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_334490">Un moteur 3D ?</h2>
		<div class="ss_part_texte">
		<h3>Qu'est-ce qu'un moteur 3D ?</h3><br>
<br>
<h4>Utilisation</h4><br>
<br>
Tout d'abord, il est important de cadrer précisément ce cours par 
rapport au sujet qu'il aborde. En effet, Ogre est un moteur 3D, je pense
 que vous l'avez compris. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/heureux.png" alt=":D" class="smilies"> Mais qu'est-ce qu'un moteur 3D ? À quoi ça sert ?<br>
<br>
Un moteur 3D est une <acronym title="Application Programming Interface">API</acronym>
 (i.e. il fournit un ensemble de fonctions) qui permet à son 
utilisateur, en l'occurrence vous, de représenter des objets dans un 
monde en trois dimensions. (On s'en serait douté en même temps. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/hihi.png" alt="^^" class="smilies">
 ) Le moteur 3D est un intermédiaire entre vous et les librairies 
graphiques de plus bas niveau comme DirectX ou OpenGL, qui permet donc 
de se passer des aspects les plus complexes de la gestion d'objets 3D. 
Le moteur gère lui-même les objets dans la scène et vous donne accès à 
des fonctions pour les manipuler et les afficher de façon optimale.<br>
<br>
Généralement, un moteur 3D coûte très cher à développer, c'est pourquoi 
on ne crée pas un moteur 3D pour chaque jeu ! Le renouvellement d'un 
moteur sert généralement à prendre en compte de nouvelles 
fonctionnalités des librairies graphiques pour offrir plus de 
possibilités aux développeurs.<br>
<br>
Cependant, il ne faut pas confondre moteur 3D (ou moteur graphique) et 
moteur de jeu, voire moteur physique par exemple. En effet, un moteur 3D
 ne contient pas de fonctions pour gérer les collisions entre les objets
 ni pour les entrées utilisateurs. Ceci sera fait à l'aide de 
bibliothèques différentes à intégrer au programme, mais ce n'est en 
aucun cas Ogre qui gérera ça.<br>
<br>
Pour résumer, voici par exemple ce qu'Ogre nous permettra de faire :<br>
<br>
<ul>
<li>afficher des personnages, bâtiments, paysages en 3D ;</li>
<li>gérer les lumières et les ombres ;</li>
<li>utiliser une ou plusieurs caméras ;</li>
<li>créer des effets de brouillards, flammes, fumées...</li>
</ul><br>
<br>
En gros, cela concerne tout ce que l'on voit à l'écran, tout ce qui est en rapport avec le <span class="italique">rendu</span>.<br>
<br>
Au-delà de ça, Ogre s'occupe aussi de gérer la fenêtre de l'application 
en elle-même, c'est-à-dire le cadre avec les boutons pour agrandir ou 
fermer la fenêtre, en haut à droite. Sachez que même si vous affichez 
votre application en plein écran, il faut s'occuper de cet aspect avec 
le système d'exploitation, et Ogre permet de gérer cela.<br>
<br>
<h4>Les connaissances requises</h4><br>
<br>
Un moteur 3D, comme tout programme, peut être codé dans de nombreux 
langages différents. Les plus populaires sont cependant le C, le C++ et 
plus récemment le C#, le langage utilisé par le framework XNA de 
Microsoft. Ogre est programmé en C++, il est donc indispensable d'avoir 
de bonnes bases dans ce domaine avant de s'attaquer à ce moteur. Vous 
aurez en effet suffisamment à faire pour apprendre le fonctionnement 
d'Ogre sans avoir besoin de vous embarrasser d'apprendre le C++ en 
parallèle.<br>
<br>
De plus, comme un moteur 3D, c'est beaucoup de géométrie dans l'espace, 
il est quasiment indispensable d'avoir des connaissances mathématiques 
d'un niveau de première / terminale scientifique pour assimiler plus 
rapidement les notions. Les mathématiques supérieures constituent un 
avantage indéniable, même s'il est possible d'assimiler les principes 
avec un peu de persévérance.<br>
<br>
Ce tutoriel conserve bien sûr l'objectif de partir du plus faible niveau possible (après tout, on est des Zéros dans l'âme <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/rire.gif" alt=":lol:" class="smilies"> ) mais ces bases vous éviteront de tourner et retourner certains points dans tous les sens. Vous voilà prévenus !<br>
<br>
<h3>Un peu d'histoire</h3><br>
<br>
Le projet Ogre est né en 1999 de l'esprit d'un certain Steve Streeting, programmeur de talent connu  sous le pseudonyme de <span class="italique">sinbad</span>
 et qui a eu l'idée de construire un moteur 3D indépendant de la 
plate-forme et de l'API utilisées (Direct3D ou OpenGL). Le projet est 
rapidement créé sur SourceForge au début de l'année 2000 et grossira 
progressivement sous la supervision de sinbad. Celui-ci se retire en 
avril 2010 pour des raisons de santé mais reste un contributeur actif.<br>
<br>
La version 1.0.0 du moteur sort en février 2005 sous le nom de code 
AzaThot. Les versions 1.x se succèdent au fil des ans et de façon 
régulière, toujours avec un nom de code désignant une créature mystique.
 <br>
En avril 2010 est sortie la version 1.7.1, dénommée Cthugha, qui en 
profite pour changer de licence et passer en MIT en lieu et place de la 
LGPL utilisée jusqu'alors. Depuis novembre 2010, la révision 1.7.2 est 
disponible et c'est donc celle que nous utiliserons ici.<br>
<br>
La communauté anglophone autour d'Ogre est plutôt active et le site 
officiel regorge de contributions diverses, tandis que la communauté 
francophone est plus restreinte.
		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_334501">Pourquoi Ogre et pas un autre ?</h2>
		<div class="ss_part_texte">
		Ah, difficile question que celle-ci !  Je vais essayer d'y répondre de la façon la plus complète possible. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/heureux.png" alt=":D" class="smilies"> <br>
<br>
Tout d'abord, Ogre est un projet open source, ce qui signifie que vous 
pouvez avoir accès aux sources du moteur et regarder comment il a été 
codé (bon, je vous préviens, ce n'est pas évident  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/langue.png" alt=":p" class="smilies"> ), mais aussi que vous pouvez vous le procurer gratuitement, ce qui est déjà une condition <span class="italique">sine qua non</span> lorsque l'on part de zéro.<br>
<br>
Ensuite, il y a encore beaucoup de moteurs gratuits. Je ne peux pas 
vraiment parler en détails de ceux-ci, sachant que je n'ai testé 
qu'Ogre. Cependant je me suis beaucoup documenté afin de faire le 
meilleur choix possible, ce qui a fait ressortir deux moteurs principaux
 : Irrlicht et Ogre.<br>
<br>
<br>
Voici ce qui ressort le plus souvent des communautés.<br>
<br>
Irrlicht est plus rapide à prendre en main qu'Ogre, notamment au niveau 
de l'installation, pas forcément bien documentée pour ce dernier en plus
 d'être souvent tortueuse, mais aussi de l'utilisation, plus simple. En 
revanche, Ogre est beaucoup plus complet, sachant qu'il y a beaucoup 
plus de classes disponibles (je ne les ai pas comptées, mais il y en a 
environ trois fois plus).<br>
<br>
Les deux moteurs ont chacun leur public, dépendant des goûts. En ce qui 
me concerne, j'ai vu beaucoup plus de projets commerciaux basés sur Ogre
 que sur Irrlicht.<br>
Ce qui est certain, c'est qu'Ogre n'est pas évident à apprendre, mais il
 est très bien documenté, et sa communauté est, comme je l'ai dit plus 
haut, très active. Sa panoplie de logiciels annexes est assez 
conséquente, on retrouve notamment des extensions pour l'export de 
fichier à partir de logiciels de modélisation ou bien un logiciel de 
création de scène plutôt bien fait par exemple, qui fera l'objet d'un 
chapitre de ce cours.<br>
<br>
<br>
Voilà : je pense que si vous êtes motivés, Ogre est largement à votre 
portée. Le fonctionnement de base du moteur n'est pas si compliqué une 
fois qu'on l'on se penche vraiment dessus, et il est surtout très 
puissant. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/hihi.png" alt="^^" class="smilies">
		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_334487">Téléchargement et installation</h2>
		<div class="ss_part_texte">
		<h3>Téléchargement</h3><br>
<br>
Comme Ogre est un projet open source, il est disponible directement sur 
le site de SourceForge. Néanmoins, vous pouvez y accéder en passant par 
le <a href="http://www.ogre3d.org/download/sdk">site officiel</a>, sur lequel vous trouverez notamment la <a href="http://www.ogre3d.org/docs/api/html/">documentation</a> complète de cette (très) vaste bibliothèque.<br>
<div class="flot_droite"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/239817.gif" alt="Image utilisateur"></div><br>
<br>
À l'heure où j'écris ces lignes, la dernière version stable est la 
1.7.2, que vous pouvez télécharger en cliquant sur le lien correspondant
 à votre plate-forme : Visual Studio si vous êtes sous l'IDE de 
Microsoft, sinon vous trouverez les versions Mac OS X pour les 
possesseurs de machine Apple et MinGW si vous utilisez Code::Blocks par 
exemple.<br>
<br>
<div class="rmq attention">Si vous utilisez Code::Blocks, il vous faudra
 mettre votre compilateur MinGW à jour avec la version 4.5 (non fournie 
avec C::B 10.05). Vous pouvez le télécharger sur <a href="http://sourceforge.net/projects/mingw/files/Automated%20MinGW%20Installer/mingw-get-inst/">SourceForge</a> par exemple. La configuration de Code::Blocks pour votre nouveau compilateur se fait dans le prochain chapitre.</div><br>
<br>
Concernant Linux, la démarche d'installation au chapitre suivant inclut 
le téléchargement des paquets nécessaires, vous pouvez donc y passer 
directement.<br>
<br>
Enfin, pour chaque plate-forme, si vous êtes des habitués de la méthode,
 il est possible de compiler vous-mêmes les sources après les avoir 
téléchargées <a href="http://www.ogre3d.org/download/source">ici</a>.<br>
<br>
<h3>Installation</h3><br>
<br>
<h4>Windows</h4><br>
<br>
Une fois que vous avez téléchargé le fichier exécutable, exécutez-le et 
choisissez un répertoire d'extraction. En ce qui me concerne je le place
 généralement dans C:/OgreSDK, mais vous êtes libres de choisir un autre
 répertoire. Notez bien le chemin que vous aurez choisi puisque nous en 
aurons besoin pour configurer nos projets et copier les bibliothèques 
nécessaires.<br>
<br>
Il est à noter que contrairement aux précédentes versions, la 1.7.2 n'a 
pas d'installation à proprement parler, elle ne fait que décompresser le
 dossier contenant les fichiers nécessaires au fonctionnement d'Ogre. Ne
 soyez donc pas surpris si la méthode est un peu inhabituelle.<br>
<br>
<h4>Mac OS X</h4><br>
<br>
Double-cliquez sur le fichier .dmg téléchargé, ce qui doit ouvrir une 
fenêtre avec un dossier OgreSDK. Il vous suffit de le placer à l'endroit
 où vous voulez installer Ogre.
		</div>
		<hr>
		
	<div id="chap_conclusion">
	Vous avez finalement bel et bien décidé de vous attaquer à Ogre ? Téléchargé et décompressé vos fichiers ?<br>
<br>
Parfait ! Passons tout de suite à la configuration de notre premier projet !
	</div>
	
	<hr>
	<h1 id="chap_334488">Votre première application</h1>
	<div id="chap_intro">
	Vous y voilà. Vous avez téléchargé et installé Ogre, lancé votre IDE 
favori, vous êtes prêts à afficher votre premier million de polygones. 
Bon, pas trop vite tout de même. Il va d'abord falloir configurer votre 
IDE pour qu'il trouve les librairies d'Ogre et vous permette de compiler
 tranquillement.<br>
<br>
Si vous avez déjà essayer d'utiliser Ogre, vous avez probablement eu des
 problèmes pour lancer une application sans avoir des myriades 
d'erreurs. La configuration manque en effet de documentation, c'est pour
 ça que je vais vous guider pas à pas.<br>
<br>
<div class="rmq attention">J'utilise ici la version 1.7.2, qui diffère 
en plusieurs points des précédentes, notamment car certains nouveaux 
fichiers sont à inclure. La démarche fonctionne sous Windows pour les 
IDE évoqués, ainsi que sous Linux. Je n'ai en revanche pas eu l'occasion
 d'installer Ogre sur un Mac. Si vous rencontrez des problèmes, je 
tenterai de compléter au plus vite ce chapitre.</div><br>
<br>
À l'abordage ! <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/pirate.png" alt=":pirate:" class="smilies">
	</div>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_334485">Configuration d'un projet</h2>
		<div class="ss_part_texte">
		<h3>Configuration de l'IDE</h3><br>
<br>
<h4>Visual Studio 2010</h4><br>
<br>
Ouvrez Visual Studio et allez dans Fichier → Nouveau → Projet... et choisissez un projet vide auquel vous donnez un nom.<br>
<br>
Une fois ce projet créé, faites un clic droit sur le nom du projet puis choisissez les propriétés.<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/295559.jpg" alt="Image utilisateur"></div><br>
<br>
Dans la fenêtre qui s'ouvre, commencez par modifier la configuration en 
haut à gauche et choisissez "Toutes les configurations". Allez ensuite 
dans Propriétés de configuration → Répertoires de VC++. Dans la fenêtre 
de droite, cliquez sur la liste correspondant aux fichiers <span class="italique">include</span>, choisissez <span class="italique">Modifier</span>, puis ajoutez ces trois chemins en cliquant sur l'icône de création.<br>
<br>
<ul>
<li>[Chemin vers Ogre]\boost_1_42</li>
<li>[Chemin vers Ogre]\include</li>
<li>[Chemin vers Ogre]\include\OGRE</li>
</ul><br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/295558.jpg" alt="Image utilisateur"></div><br>
Faîtes de même pour les répertoires de bibliothèques bibliothèques, et ajoutez ces deux chemins :<br>
<br>
<ul>
<li>[Chemin vers Ogre]\boost_1_42\lib</li>
<li>[Chemin vers Ogre]\lib\$(Configuration)</li>
</ul><br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/295566.jpg" alt="Image utilisateur"></div><br>
<br>
Sélectionnez maintenant "Débogage" et complétez le répertoire de travail : $(SolutionDir)$(Configuration).<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/295564.jpg" alt="Image utilisateur"></div><br>
<br>
Enfin passez maintenant à la configuration "Release", allez dans Éditeur
 de liens → Entrée et ajoutez deux dépendances supplémentaires : 
OgreMain.lib et OIS.lib. Faîtes de même pour la configuration Debug avec
 les dépendances  OgreMain_d.lib et OIS_d.lib.<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/295567.jpg" alt="Image utilisateur"></div><br>
<br>
Voilà, votre projet est prêt à être compilé !<br>
<br>
<h4>Code::Blocks</h4><br>
<br>
Ouvrez Code::Blocks et créez un nouveau projet vide, choisissez GNU GCC 
en tant que compilateur. Faites un clic droit sur le projet nouvellement
 créé, et allez dans "Build Options...".<br>
<br>
À gauche, ne choisissez ni "Debug" ni "Release", mais le nom de votre 
projet pour modifier les deux configurations en même temps.<br>
<br>
Allez dans "Search directories" et dans l'onglet "Compiler" ajoutez les chemins suivants :<br>
<br>
<ul>
<li>[Chemin vers Ogre]\boost_1_44</li>
<li>[Chemin vers Ogre]\include</li>
<li>[Chemin vers Ogre]\include\OGRE</li>
</ul><br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/239858.jpg" alt="Image utilisateur"></div><br>
<br>
Puis dans "Linker", ajoutez ceux-ci :<br>
<br>
<ul>
<li>[Chemin vers Ogre]\boost_1_44\lib</li>
<li>[Chemin vers Ogre]\lib\$(TARGET_NAME)</li>
</ul><br>
<br>
Ensuite, allez dans "Linker Settings", et dans  la case "Other Linker Options", écrivez : -Wl,--enable-auto-import .<br>
<br>
Toujours dans "Linker Settings", choisissez cette fois la configuration 
debug et dans "Link Libraries" ajoutez les deux fichiers :<br>
<ul>
<li>OgreMain_d</li>
<li>OIS_d</li>
</ul><br>
<br>
Et pour le release :<br>
<ul>
<li>OgreMain</li>
<li>OIS</li>
</ul><br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/239859.jpg" alt="Image utilisateur"></div><br>
<br>
Fermez la fenêtre puis ouvrez les propriétés du projet (clic droit, 
Properties...), ouvrez l'onglet "Build Targets" et dans le champ 
"Execution working dir" entrez "bin\Debug" pour la configuration Debug 
(à choisir dans le menu de gauche) et "bin\Release" pour la 
configuration Release.<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/250334.jpg" alt="Image utilisateur"></div><br>
<br>
Pour terminer, aller dans Settings → Compiler and Debugger... puis dans 
les paramètres de GNU choisissez le répertoire où vous avez installé 
MinGW 4.5.<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/295572.jpg" alt="Image utilisateur"></div><br>
<br>
<h4>Sous Linux</h4><br>
<br>
Beaucoup d'utilisateurs sous Linux préfèrent compiler les codes sources à
 la main, mais ce n'est pas le cas de tout le monde. Voici donc une 
méthode pour installer directement Ogre et compiler vos projets avec 
cmake.<br>
<br>
Cette méthode est en grande partie inspirée de <a href="http://geenux.wordpress.com/tag/c/">cette page</a>, avec quelques ajouts.<br>
<br>
Ajoutez au fichier /etc/apt/sources.list les lignes :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">deb</span> <span class="nl">http:</span><span class="c1">//ppa.launchpad.net/ogre-team/ogre/ubuntu karmic main</span>
<span class="n">deb</span><span class="o">-</span><span class="n">src</span> <span class="nl">http:</span><span class="c1">//ppa.launchpad.net/ogre-team/ogre/ubuntu karmic main</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Une fois que c'est fait, mettez votre liste de paquets à jour et installez les paquets suivants :<br>
<br>
<span class="code">Code : Console - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 console"><table class="syntaxtable"><tbody><tr><td class="linenos"><pre></pre></td><td class="code"><div class="syntax"><pre>sudo&nbsp;aptitude&nbsp;update
sudo&nbsp;aptitude&nbsp;install&nbsp;libogre-dev&nbsp;ogre-samples-bin&nbsp;libois-dev&nbsp;cmake</pre></div></td></tr></tbody></table></div><br>
<br>
Maintenant, créez un répertoire pour votre projet. Ajoutez-y un fichier CMakeLists.txt avec pour contenu :<br>
<br>
<span class="spoiler_hidden">Secret <a href="#" onclick="switch_spoiler_hidden(this); return false;">(cliquez pour afficher)</a></span><div class="spoiler2_hidden"><div class="spoiler3_hidden"><span class="code">Code : Console - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 console"><table class="syntaxtable"><tbody><tr><td class="linenos"><pre></pre></td><td class="code"><div class="syntax"><pre>project(VotreProjet)
cmake_minimum_required(VERSION&nbsp;2.6)
set(CMAKE_MODULE_PATH&nbsp;"/usr/lib/OGRE/cmake/")
#set(CMAKE_CXX_FLAGS&nbsp;"-Wall&nbsp;-W&nbsp;-Werror&nbsp;-ansi&nbsp;-pedantic&nbsp;-g")

#&nbsp;Il&nbsp;s'agit&nbsp;du&nbsp;tutoriel&nbsp;d'exemple,&nbsp;qui&nbsp;utilise&nbsp;quelques&nbsp;fichiers&nbsp;prédéfinis&nbsp;de&nbsp;Ogre.&nbsp;Il&nbsp;faut&nbsp;indiquer&nbsp;à&nbsp;cmake&nbsp;où&nbsp;se&nbsp;trouvent&nbsp;les&nbsp;includes&nbsp;en&nbsp;question
include_directories&nbsp;("/usr/share/OGRE/Samples/Common/include/")

#&nbsp;Bien&nbsp;sûr,&nbsp;pour&nbsp;compiler&nbsp;Ogre,&nbsp;il&nbsp;faut&nbsp;le&nbsp;chercher,&nbsp;et&nbsp;définir&nbsp;le&nbsp;répertoire&nbsp;contenant&nbsp;les&nbsp;includes.
find_package(OGRE&nbsp;REQUIRED)
include_directories&nbsp;(${OGRE_INCLUDE_DIRS})

#&nbsp;L'exemple&nbsp;dépend&nbsp;aussi&nbsp;de&nbsp;OIS,&nbsp;une&nbsp;lib&nbsp;pour&nbsp;gérer&nbsp;la&nbsp;souris,&nbsp;clavier,&nbsp;joystick...
find_package(OIS&nbsp;REQUIRED)

#&nbsp;On&nbsp;définit&nbsp;les&nbsp;sources&nbsp;qu'on&nbsp;veut&nbsp;compiler
SET(SOURCES
main.cpp)

#&nbsp;On&nbsp;les&nbsp;compile
add_executable&nbsp;(
&nbsp;&nbsp;&nbsp;VotreProjet&nbsp;${SOURCES}
)

target_link_libraries(VotreProjet&nbsp;${OGRE_LIBRARY}&nbsp;${OIS_LIBRARY})</pre></div></td></tr></tbody></table></div></div></div><br>
<br>
Remplacer "VotreProjet" par le nom à donner à votre projet. Vous aurez 
de plus à modifier la liste des sources lorsque vous ajouterez des 
fichiers.<br>
<br>
Ensuite (une fois que vous aurez votre code), vous pourrez lancer les commandes suivantes depuis le répertoire du projet :<br>
<br>
<span class="code">Code : Console - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 console"><table class="syntaxtable"><tbody><tr><td class="linenos"><pre></pre></td><td class="code"><div class="syntax"><pre>cmake&nbsp;.
make
./VotreProjet</pre></div></td></tr></tbody></table></div><br>
<br>
Enfin, vous aurez besoin de ces deux fichiers dans le répertoire de votre projet :<br>
<br>
<span class="code">Code : Console - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 console"><table class="syntaxtable"><tbody><tr><td class="linenos"><pre></pre></td><td class="code"><div class="syntax"><pre>cp&nbsp;/usr/share/OGRE/resources.cfg&nbsp;.
cp&nbsp;/usr/share/OGRE/plugins.cfg&nbsp;.</pre></div></td></tr></tbody></table></div><br>
<br>
Pour terminer, je vous conseille de mettre vos drivers graphiques à jour
 si ce n'est pas fait, c'est une source d'erreur à l'exécution.<br>
<br>
<h4>Sous Mac OSX</h4><br>
<br>
Comme je le disais en introduction, je n'ai pas pu mettre la main sur un
 Mac pour tester l'installation. Cependant, je suppose que le dossier 
OgreSDK contient les librairies et includes nécessaires et que la 
configuration de l'IDE ressemble à celle de Windows. Il est à noter que 
Xcode est l'IDE qui revient le plus souvent pour utiliser Ogre ; un 
projet (au chemin OgreSDK/Samples/Samples.xcodeproj) étant normalement 
présent dans l'installation, il peut vous aider à configurer votre IDE.<br>
<br>
N'hésitez pas à m'envoyer un MP si vous avez des précisions. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/smile.png" alt=":)" class="smilies"><br>
<br>
<br>
<div class="rmq information">La partie suivante concerne uniquement les utilisateurs de Windows.</div><br>
<br>
<h3>Les fichiers à récupérer</h3><br>
<br>
Une fois que votre projet sera compilé, il aura aussi besoin d'avoir des
 bibliothèques indispensables à son fonctionnement dans le dossier de 
compilation et des fichiers de configuration adaptés à votre 
installation.<br>
<br>
Allez donc dans le dossier d'installation d'Ogre, puis dans bin, puis 
release (ou debug si vous voulez compiler en Debug). Ici, copiez tous 
les fichiers dans le répertoire de l'exécutable de votre programme (avec
 Visual Studio : [Nom Du Projet]/release/ , avec Code::Blocks : [Nom Du 
Projet]/bin/release/).<br>
<br>
Notez que tous ne sont pas obligatoires (pas au début du moins) et que vous pouvez vous contenter de ceux-ci :<br>
<br>
<ul>
<li>plugins.cfg ;</li>
<li>resources.cfg ;</li>
<li>OgreMain.dll ;</li>
<li>cg.dll ;</li>
<li>OIS.dll ;</li>
<li>Les fichiers Plugins_***.dll ;</li>
<li>RenderSystem_Direct3D9.dll ;</li>
<li>RenderSystem_GL.dll.</li>
</ul><br>
<br>
Je vous conseille néanmoins de tout copier, ce sera fait. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/hihi.png" alt="^^" class="smilies"><br>
<br>
<div class="rmq information">Les fichiers pour la configuration Debug sont identiques mais possèdent le suffixe <span class="italique">_d</span> dans leur nom.</div><br>
<br>
Il faut maintenant éditer les deux fichiers de configuration 
"plugins.cfg" et "resources.cfg" fraîchement copiés. En les ouvrant vous
 constatez qu'ils contiennent des chemins relatifs vers des 
sous-dossiers du dossier "media", situé dans le répertoire d'Ogre. Il va
 donc falloir adapter les chemins indiqués pour qu'ils pointent sur le 
dossier où vous avez choisi d'extraire Ogre (les chemins absolus sont 
possibles).
		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_334483">Le code de base</h2>
		<div class="ss_part_texte">
		Bon, notre IDE est configuré, les fichiers nécessaires ont été copiés 
dans les bons répertoires, il est temps de tester notre premier code !<br>
<br>
<h3>La fonction main</h3><br>
<br>
Nous allons commencer par regarder la fonction main de base, qui permettra par la suite de lancer notre application.<br>
<br>
Voici le code de cette fonction.<br>
<br>
<span class="code">Code : C++ - main.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="syntax"><pre><span class="cp">#include &lt;Ogre.h&gt;</span>

<span class="cp">#if OGRE_PLATFORM == PLATFORM_WIN32 || OGRE_PLATFORM == OGRE_PLATFORM_WIN32</span>
<span class="cp">#define WIN32_LEAN_AND_MEAN</span>
<span class="cp">#include "windows.h"</span>

<span class="n">INT</span> <span class="n">WINAPI</span> <span class="n">WinMain</span><span class="p">(</span><span class="n">HINSTANCE</span> <span class="n">hInst</span><span class="p">,</span> <span class="n">HINSTANCE</span><span class="p">,</span> <span class="n">LPSTR</span> <span class="n">strCmdLine</span><span class="p">,</span> <span class="n">INT</span><span class="p">)</span>
<span class="cp">#else</span>
<span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="cp">#endif</span>
<span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
	<span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Exception</span><span class="o">&amp;</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
<span class="cp">#if OGRE_PLATFORM == OGRE_PLATFORM_WIN32</span>
        <span class="n">MessageBoxA</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">getFullDescription</span><span class="p">().</span><span class="n">c_str</span><span class="p">(),</span> <span class="s">"An exception has occurred!"</span><span class="p">,</span> <span class="n">MB_OK</span> <span class="o">|</span> <span class="n">MB_ICONERROR</span> <span class="o">|</span> <span class="n">MB_TASKMODAL</span><span class="p">);</span>
<span class="cp">#else</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">"An exception has occurred: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span>
            <span class="n">e</span><span class="p">.</span><span class="n">getFullDescription</span><span class="p">().</span><span class="n">c_str</span><span class="p">());</span>
<span class="cp">#endif</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Comme vous pouvez le voir, il y a pas mal de lignes pour pas grand-chose
 au final. En effet, si vous exécutez cela, il ne se passe rien, ce qui 
est normal si vous avez jeté un œil au code : je n'ai rien mis dans mon 
bloc try{} ! C'est simplement le code minimal à avoir pour compiler.<br>
Vous voyez plusieurs instructions au préprocesseur qui ont pour but de 
permettre une plus grande compatibilité en fonction de la plate-forme 
sur laquelle vous vous trouvez.<br>
<br>
Le bloc try{}catch{} nous permettra d'avoir des informations sur les 
exceptions levées par Ogre lors de l'exécution ; par exemple si un 
fichier demandé lors du fonctionnement n'est pas trouvé, vous aurez une 
boîte de dialogue vous indiquant la nature de l'erreur.<br>
<br>
J'ai aussi inclus le fichier Ogre.h afin de pouvoir compiler, la classe Exception étant une classe d'Ogre.<br>
<br>
J'en profite pour signaler que l'ensemble des classes et des types de données définis par Ogre se situe dans le <span class="italique">namespace</span> Ogre. Personnellement, j'utilise la ligne <span class="code2 cpp"><span class="k">using</span> <span class="k">namespace</span> <span class="n">Ogre</span><span class="p">;</span></span> dans mes projets si je n'ai pas de risque de conflits avec une autre librairie.<br>
<br>
On va tout de suite créer notre première classe pour pouvoir ouvrir une fenêtre à l'écran.<br>
<br>
<h3>Notre première classe</h3><br>
<br>
<h4>La classe ExampleApplication</h4><br>
<br>
Il faut savoir que j'ai beaucoup hésité en préparant ce début de cours, 
quant à la présentation que j'allais faire d'Ogre au début et des 
premiers codes que j'allais vous montrer.<br>
<br>
Ogre nous fournit dans ses <span class="italique">include</span> une 
classe fort pratique pour les débutants qui veulent s'essayer à Ogre, et
 qui n'ont pas forcément la motivation de s'attarder sur les aspects 
techniques, notamment le démarrage du moteur, lorsqu'ils découvrent 
Ogre. Cette classe s'appelle ExampleApplication.h et contient un code de
 base pour lancer votre application dans de bonnes conditions.<br>
<br>
Attention, cependant : cette classe peut être à utiliser au début pour 
découvrir rapidement les fonctionnalités d'Ogre, mais elle devra 
rapidement être oubliée au profit d'une architecture « maison » où vous 
créerez uniquement ce dont vous avez besoin. En effet, la classe 
ExampleApplication n'est pas optimisée pour la performance ni pour 
l'évolutivité ; c'est un exemple, comme son nom l'indique si bien. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/rire.gif" alt=":lol:" class="smilies"> <br>
<br>
Toujours est-il qu'après réflexion, j'ai décidé d'utiliser cette classe 
dans la première partie pour que vous puissiez manipuler rapidement vos 
premières scènes. Dès la seconde partie, je vous montrerai comment nous 
en affranchir en créant notre propre classe pour lancer Ogre.<br>
<br>
<h4>Implémentation</h4><br>
<br>
Il est très simple de lancer un programme en utilisant la classe 
d'exemple. Celle-ci contient en effet de quoi créer les objets 
indispensables à Ogre, elle prévoit une gestion basique de la souris 
pour la caméra et vous propose même une fenêtre de démarrage pour 
choisir les paramètres de votre application, comme la taille de la 
fenêtre ou l'API de rendu.<br>
<br>
Cependant, c'est une classe abstraite ; par conséquent, pour l'utiliser,
 il va falloir réimplémenter la méthode createScene() dans notre code, 
qui est la seule méthode virtuelle pure de la classe.<br>
<br>
<div class="rmq information">La classe ExampleApplication utilise la 
directive using namespace, vous n'êtes donc pas forcés de la réécrire 
dans votre nouvelle classe.</div><br>
<br>
Créez donc un fichier PremiereApplication.h avec le code suivant :<br>
<br>
<span class="code">Code : C++ - PremiereApplication.h - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="syntax"><pre><span class="cp">#include "ExampleApplication.h"</span>

<span class="k">class</span> <span class="nc">PremiereApplication</span> <span class="o">:</span> <span class="k">public</span> <span class="n">ExampleApplication</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="kt">void</span> <span class="n">createScene</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Faites un <span class="italique">include</span> de ce fichier dans 
main.cpp, et instanciez votre classe dans la fonction main, juste avant 
le bloc try{}catch{}. Enfin dans le bloc try, il suffit de lancer 
l'application avec la méthode go() définie dans la classe 
ExampleApplication.<br>
<br>
<span class="code">Code : C++ - main.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="syntax"><pre><span class="c1">//...</span>
<span class="n">PremiereApplication</span> <span class="n">app</span><span class="p">;</span>

<span class="k">try</span> <span class="p">{</span>
    <span class="n">app</span><span class="p">.</span><span class="n">go</span><span class="p">();</span>
<span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Exception</span><span class="o">&amp;</span> <span class="n">e</span><span class="p">)</span>
<span class="c1">//...</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<h3>Exécution !</h3><br>
<br>
Vous pouvez maintenant compiler votre code et l'exécuter.<br>
<br>
Si tout se passe bien, une première fenêtre de configuration doit 
apparaitre à l'écran. Si la zone d'édition est vide, déroulez le menu et
 choisissez Direct3D ou OpenGL. <br>
Vous pouvez alors modifier entre autres la résolution, le mode plein 
écran ou la synchronisation verticale dans les options en dessous. 
Vérifiez que la carte graphique sélectionnée ("Rendering Device") 
correspond bien à celle que vous avez, puis validez votre fenêtre.<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/239036.jpg" alt="Image utilisateur"></div><br>
<br>
Une nouvelle fenêtre noire s'affiche alors, que vous pouvez quitter en appuyant sur Echap.<br>
<br>
<br>
Notez qu'un fichier ogre.cfg a été créé dans le dossier de l'exécutable.
 Il contient les informations entrées dans la fenêtre de configuration, 
vous n'aurez donc a priori pas à renseigner à nouveau ces valeurs lors 
d'une future exécution du projet.
		</div>
		<hr>
		
	<div id="chap_conclusion">
	Et voilà ! L'étape qui rebute le plus souvent les novices d'Ogre 
n'était finalement pas si difficile que ça, si on sait où aller. Vous 
pouvez maintenant passer à la suite sereinement pour afficher un modèle 
dans la scène.
	</div>
	
	<hr>
	<h1 id="chap_334498">Insérer des objets dans la scène</h1>
	<div id="chap_intro">
	Vous avez donc devant vous votre première fenêtre. Noire.<br>
<br>
En fait elle n'est pas noire, c'est simplement que votre scène est complètement vide !<br>
<br>
<div class="rmq question">Où elle est la scène ? Je vois pas de rideau ni de planches, moi...  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/unsure.gif" alt=":euh:" class="smilies"> </div><br>
<br>
 <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/rire.gif" alt=":lol:" class="smilies">
 C'est normal : la scène, c'est la désignation de l'espace que vous 
visualisez dans votre fenêtre, c'est ce qui contient tout les objets que
 vous allez utiliser. La scène, c'est le monde que vous créez.<br>
<br>
Donc, c'est bien gentil, mais vous la trouvez un peu terne, notre scène ?
 Qu'à cela ne tienne, nous allons égayer un peu tout ça !
	</div>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_334499">Les entités</h2>
		<div class="ss_part_texte">
		<h3>Une entité, c'est quoi ?</h3><br>
<br>
Une entité, c'est la représentation dans la scène d'un modèle 3D, aussi appelé mesh (<span class="italique">mesh</span> signifie maillage en anglais).<br>
<br>
Le mesh est l'ensemble des polygones élémentaires (des quadrilatères et 
des triangles, le plus souvent) que l'on crée dans un logiciel de 
modélisation, comme Blender ou Maya, et qui constituent votre modèle 3D 
complet. Tout ces polygones sont reliés entre eux par leurs sommets, 
aussi appelés <span class="souligne"><strong>vertices</strong></span> en
 anglais (un vertex, des vertices). Plus il y a de vertices, et donc de 
polygones, plus le mesh est précis. Généralement, le mesh possède aussi 
une ou plusieurs textures (une image plaquée sur les polygones) qui lui 
donnent un aspect plus réaliste qu'une couleur unie lors du rendu. 
Enfin, pour certains modèles comme les personnages, le mesh possède un 
squelette qui permet de créer des animations pour son mouvement.<br>
<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/241564.png" alt="Image utilisateur"><br>
Un mesh représentant une sphère. Les vertices sont les points bleus.</div><br>
<br>
<br>
Afin de gérer ces différentes caractéristiques des modèles, Ogre 
enregistre toutes ces informations dans une entité. Tous les objets 
solides qui apparaissent à l'écran sont donc des entités et sont 
représentés par une seule et même classe dans Ogre : la classe Entity. 
Avant de nous pencher dessus, nous allons ouvrir une petite parenthèse 
pour me permettre d'introduire une classe centrale dans la gestion de la
 scène, le SceneManager.<br>
<br>
<h3>Le SceneManager en deux mots</h3><br>
<br>
Afin de pouvoir gérer l'ensemble des objets de notre scène tout au long 
du déroulement du programme, Ogre introduit la classe SceneManager.<br>
<br>
Concrètement, le SceneManager s'occupe de garder une trace de tous les 
modèles, lumières, caméra et autres objets que peut contenir la scène. 
C'est à lui que revient la tâche de créer tous ces objets et de nous 
permettre ensuite d'y accéder. Par conséquent, l'insertion d'objets dans
 la scène passe toujours par lui (ou par l'un des éléments déjà insérés)
 et par les méthodes qu'il propose pour cela.<br>
Il en existe diverses variantes en fonction de la scène que l'on veut 
réaliser ; selon que celle-ci sera en intérieur ou en extérieur, par 
exemple, on pourra utiliser un SceneManager différent.<br>
<br>
Toutes les applications Ogre doivent donc avoir un SceneManager pour 
pouvoir fonctionner, puisque c'est lui qui s'occupe de tout ! La classe 
ExampleApplication ne fait pas exception et possède donc un attribut 
mSceneMgr, qui est un pointeur sur le SceneManager de l'application et 
qui nous permettra dans les parties suivantes d'agrémenter notre scène 
avec des objets.<br>
<br>
Nous ne nous préoccuperons pas pour l'instant de sa création, nous 
verrons cela en ouvrant la boîte noire du démarrage de la machine Ogre, 
mais il est important de le connaître pour comprendre comment seront 
créés nos objets.<br>
<br>
<h3>Créer une entité</h3><br>
<br>
L'entité, comme je l'ai dit, doit être créée par le SceneManager pour 
pouvoir être ajoutée à la scène. La méthode createEntity() permet 
justement de faire tout cela.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Entity</span> <span class="o">*</span><span class="n">head</span><span class="o">=</span> <span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">createEntity</span><span class="p">(</span><span class="s">"Tete"</span><span class="p">,</span> <span class="s">"ogrehead.mesh"</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Le premier paramètre est le nom que vous souhaitez donner au mesh, et 
qui permettra éventuellement par la suite de récupérer un pointeur sur 
votre entité si vous connaissez son nom. Pour cela on utilisera donc... 
Le SceneManager, oui !<br>
<br>
<div class="rmq attention">Le nom que vous donnez à votre entité doit être unique !</div><br>
<br>
Le second paramètre est le nom du fichier que vous voulez charger. Notez
 l'extension .mesh, qui est le format de fichiers pour les modèles 
reconnu par Ogre. Le fichier que j'ai choisi se trouve, accompagné 
d'autres modèles d'exemples, dans le dossier OgreSDK/media/models, qui 
doit être correctement renseigné dans le fichier resources.cfg pour 
qu'Ogre puisse le trouver lors de l'exécution. Dans le cas contraire, 
une exception sera levée au démarrage, d'où un plantage si elle n'est 
pas traitée.<br>
<br>
Voilà tout ce qu'il fallait faire pour ajouter un mesh dans la scène ! 
Attention cependant, il nous manque encore une chose avant de pouvoir 
l'afficher à l'écran...
		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_334482">Les nœuds de scène</h2>
		<div class="ss_part_texte">
		<h3>L'utilité des nœuds</h3><br>
<br>
Dans Ogre, lorsque l'on souhaite manipuler une entité (un personnage, 
une lumière, une caméra...), on n'agit en fait jamais directement sur 
celle-ci. Tous les déplacements que l'on veut effectuer se font par 
l'intermédiaire d'un nœud de scène, ou SceneNode.<br>
<br>
Un SceneNode est un objet invisible auquel on va pouvoir attacher un 
nombre indéfini d'entités, lesquelles deviennent solidaires de ce nœud 
et subissent donc les même transformations que lui. C'est donc une sorte
 de conteneur qui contient les informations de positionnement de chacune
 des entités de la scène qui lui sont rattachées.<br>
<br>
<div class="rmq question">Mais pourquoi on s'embête à créer un nœud 
alors qu'on pourrait déplacer nos entités directement ? Ogre doit bien 
savoir faire ça, quand même !</div><br>
<br>
Si le système permettait de procéder de cette façon, en déplaçant nos 
entités une par une, on en arriverait vite à faire plusieurs fois les 
mêmes déplacements lors de la mise à jour de notre scène.<br>
<br>
En effet, lorsque vous voyez un objet 3D à l'écran, celui-ci peut être 
constitué de plusieurs entités. Un personnage pourra par exemple avoir 
un corps (on l'espère pour lui <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/rire.gif" alt=":lol:" class="smilies">
 ) mais aussi une arme, un chapeau, et puis il pourrait monter sur une 
moto aussi ! Tous ces objets seront probablement enregistrés dans des 
fichiers distincts par le graphiste 3D, pour être le plus souple 
possible.<br>
<br>
Ainsi, lorsque l'on veut déplacer notre personnage vers l'avant, sans 
les nœuds il faudrait déplacer chaque petit élément un par un, ce qui 
deviendrait vite infernal. <br>
<br>
Avec les nœuds, il me suffira d'enregistrer une fois chaque entité que 
je veux attacher à mon nœud, qui s'occupera de faire les déplacements 
nécessaires pour chaque entité lorsque j'aurai des transformations à 
effectuer.<br>
<br>
<div class="rmq information">Quoi qu'il en soit, attacher chaque entité à un nœud est primordial, sans quoi elle ne s'affichera pas dans votre scène !</div><br>
<br>
<h3>Créer un nœud</h3><br>
<br>
Comme pour les entités, on ne créera pas de nœud de scène en utilisant 
le constructeur de la classe. On devra passer par un nœud déjà existant,
 ce qui va nous permettre d'avoir des relations d'héritage entre nos 
nœuds. De la même manière que l'on va attacher les entités à nos nœuds, 
ceux-ci peuvent avoir un nœud parent, lui-même enfant d'un autre nœud, 
et ainsi de suite jusqu'au nœud appelé « racine » de la scène.<br>
<br>
Pour cela, les nœuds de scène ont une méthode dédiée :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">SceneNode</span> <span class="o">*</span><span class="n">noeudEnfant</span> <span class="o">=</span> <span class="n">noeudParent</span><span class="o">-&gt;</span><span class="n">createChildSceneNode</span><span class="p">(</span><span class="s">"enfant"</span><span class="p">,</span> <span class="n">Vector3</span><span class="o">::</span><span class="n">ZERO</span><span class="p">,</span> <span class="n">Quaternion</span><span class="o">::</span><span class="n">IDENTITY</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<div class="rmq question">Mais comment fait-on pour le premier nœud qu'on va créer ? Il ne peut pas avoir de père si c'est le premier ! <span class="barre">Je savais que j'aurais dû étudier le problème de l'œuf ou de la poule avant de venir...  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/triste.png" alt=":(" class="smilies">  </span></div><br>
<br>
Sachez que le nœud « racine » que j'ai cité tout à l'heure existe dès 
que le SceneManager est créé, et que c'est un nœud comme un autre, avec 
les même méthodes.<br>
<br>
Nous allons donc créer un nœud enfant du nœud racine de la scène que nous récupérons à l'aide du SceneManager :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">SceneNode</span> <span class="o">*</span><span class="n">node</span><span class="o">=</span> <span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">getRootSceneNode</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">createChildSceneNode</span><span class="p">(</span><span class="s">"nodeTete"</span><span class="p">,</span> <span class="n">Vector3</span><span class="o">::</span><span class="n">ZERO</span><span class="p">,</span> <span class="n">Quaternion</span><span class="o">::</span><span class="n">IDENTITY</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Ici la méthode getRootSceneNode() nous permet de récupérer un pointeur 
sur le nœud racine unique de la scène. On appelle ensuite sa méthode 
createChildSceneNode pour lui ajouter un nouveau nœud fils.<br>
<br>
Notez qu'aucun des paramètres de la méthode n'est obligatoire, mais que 
je les ai écrits pour information. Le premier argument est le nom que 
vous voulez donner à votre nœud et qui pourra être utilisé pour 
récupérer un pointeur vers celui-ci, sur le même principe que les 
entités. Les deuxième et troisième arguments sont respectivement la 
position et le quaternion avec lesquels vous voulez initialiser votre 
nœud.<br>
<br>
<div class="rmq question">Le quart d'oignon ? On fait de la cuisine, maintenant ?</div><br>
<br>
Oui, j'avoue que c'est un nom un peu barbare qui m'a aussi fait un peu 
peur au début. J'y reviendrai en détail ultérieurement pour vous 
expliquer de quoi il s'agit. Sachez pour le moment qu'un quaternion est 
un objet mathématique qui permet de faire faire aux objets des rotations
 dans l'espace, et que la valeur initiale que je lui ai donnée lui dit 
de ne pas faire de rotation, justement. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/hihi.png" alt="^^" class="smilies"> <br>
<br>
<br>
Avec ce code en main, vous pouvez simplement attacher l'entité précédemment créée au nœud avec la ligne suivante :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">node</span><span class="o">-&gt;</span><span class="n">attachObject</span><span class="p">(</span><span class="n">head</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<br>
En compilant, vous devriez voir la tête d'un ogre au milieu de l'écran.<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/239037.jpg" alt="Image utilisateur"></div><br>
<br>
Vous pouvez déplacer la caméra avec Z, S, Q, D et la souris pour voir ce que ça donne de plus près.
		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_334496">Créer un mesh</h2>
		<div class="ss_part_texte">
		Pour terminer, nous pouvons rajouter un sol à notre scène, pour éviter que notre tête d'Ogre se sente trop seule. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/unsure.gif" alt=":euh:" class="smilies"> <br>
<br>
Nous allons pour cela créer nous-mêmes notre propre mesh, étant donné 
que nous n'avons besoin que d'un plan pour le sol. C'est un mesh que 
l'on peut créer très simplement dans le code de notre application.<br>
<br>
<h3>Le mesh</h3><br>
<br>
Nous voulons un rectangle pour notre sol. Pour cela, nous pouvons 
utiliser la classe Plane, qui va nous permettre de générer... un plan ! 
Je vois que vous avez décidé de vous mettre à l'anglais. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/langue.png" alt=":p" class="smilies"> <br>
<br>
<div class="rmq information">En plus de la classe Plane, vous trouverez 
aussi des classes Box (pour les cubes) et Sphere qui fonctionnent sur le
 même principe.</div><br>
<br>
Nous allons donc créer un plan, pour lequel nous allons définir son 
vecteur normal, c'est-à-dire le vecteur perpendiculaire au plan : ici 
l'axe Y pour que notre plan soit horizontal. Le second paramètre est la 
distance à l'origine de la scène dans le sens du vecteur normal : ici, 
je mets 0 pour que mon mesh plan soit centré. En mettant une valeur 
positive par exemple, mon plan se retrouverait plus haut.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Plane</span> <span class="n">plan</span><span class="p">(</span><span class="n">Vector3</span><span class="o">::</span><span class="n">UNIT_Y</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Une fois le plan créé, il faut que l'on crée un mesh, c'est-à-dire 
l'objet 3D en lui-même, la représentation du plan qui sera visible dans 
la scène.<br>
<br>
Pour cela, on utilise le Mesh Manager, qui va s'occuper de créer les faces de notre mesh.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">MeshManager</span><span class="o">::</span><span class="n">getSingleton</span><span class="p">().</span><span class="n">createPlane</span><span class="p">(</span><span class="s">"sol"</span><span class="p">,</span> <span class="n">ResourceGroupManager</span><span class="o">::</span><span class="n">DEFAULT_RESOURCE_GROUP_NAME</span><span class="p">,</span> <span class="n">plan</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Vector3</span><span class="o">::</span><span class="n">UNIT_Z</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Quelques explications sur cette ligne s'imposent. Tout d'abord, la 
méthode statique getSingleton() est un peu particulière, j'y reviendrai 
lorsque l'on mettra un peu plus les mains dans le cambouis ; sachez pour
 l'instant qu'elle permet de récupérer un objet instancié de façon 
unique, donc ici notre MeshManager.<br>
<br>
Ensuite, les paramètres de la méthode createPlane sont assez simples. 
Les deux premiers correspondent respectivement au nom que l'on veut 
donner à notre mesh et au nom du groupe auquel on veut qu'il 
appartienne. Suivent ensuite le nom du plan à modéliser, puis la largeur
 et la hauteur qu'il doit avoir, puis le nombre de subdivisions du plan 
dans ces deux sens. Plus il y a de subdivisions, plus il y a de 
polygones dans notre mesh. Le booléen suivant indique que les normales 
sont perpendiculaires au plan.<br>
Les trois paramètres suivants sont le nombre de textures que l'on va 
pouvoir assigner au plan, puis le nombre de fois que la texture sera 
répétée dans les deux directions. Enfin, le dernier paramètre est le 
vecteur indiquant la direction du haut du mesh. Attention : il ne faut 
pas le confondre avec la normale du plan, qui est différente.<br>
Il reste encore des paramètres par défaut que je n'ai pas modifiés, ce n'est pas du niveau du chapitre.<br>
<br>
Enfin, nous allons revenir vers un code connu : nous allons créer 
l'entité qui représentera le plan. C'est le même principe que tout à 
l'heure : tout d'abord, on crée une entité à partir du Scene Manager en 
la nommant et en lui indiquant le mesh à utiliser. On crée ensuite un 
nouveau nœud à partir du nœud racine et on l'attache à notre entité.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Entity</span> <span class="o">*</span><span class="n">ent</span><span class="o">=</span> <span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">createEntity</span><span class="p">(</span><span class="s">"EntiteSol"</span><span class="p">,</span> <span class="s">"sol"</span><span class="p">);</span>
<span class="n">node</span> <span class="o">=</span> <span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">getRootSceneNode</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">createChildSceneNode</span><span class="p">();</span>
<span class="n">node</span><span class="o">-&gt;</span><span class="n">attachObject</span><span class="p">(</span><span class="n">ent</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<h3>Le matériau</h3><br>
<br>
Nous allons finir en ajoutant une texture au sol, sinon il risque de paraître un peu triste.  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/hihi.png" alt="^^" class="smilies"> <br>
<br>
Je vous propose de mettre de l'herbe par terre. Pour cela, il suffit de 
rajouter la ligne suivante après la création de l'entité :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">ent</span><span class="o">-&gt;</span><span class="n">setMaterialName</span><span class="p">(</span><span class="s">"Examples/GrassFloor"</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Si voulez connaître les matériaux fournis avec Ogre, il vous suffit 
d'aller dans le dossier media/materials/scripts. Ici, j'ai pris le 
matériau GrassFloor enregistré dans le fichier Examples.material. Les 
textures correspondantes se trouvent dans le dossier 
media/materials/textures, si vous voulez faire des essais. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/clin.png" alt=";)" class="smilies"> <br>
<br>
Je reviendrai plus tard en détail sur les matériaux, le sujet méritera que l'on s'y attarde. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/smile.png" alt=":)" class="smilies"><br>
<br>
Vous pouvez maintenant exécuter votre programme.<br>
<br>
<br>
Lancez l'application et remontez la caméra avec la souris et les touches
 de déplacement, vous devriez voir quelque chose ressemblant à la 
capture suivante.<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/239795.jpg" alt="Image utilisateur"></div><br>
<br>
<div class="rmq question">Euh... La tête d'Ogre est coupée par le sol en herbe...</div><br>
<br>
En effet, notre plan est centré sur l'origine de la scène, et l'on a 
aussi placé notre tête à l'origine. Mais quelle partie de la tête est à 
l'altitude 0 ?<br>
<br>
Ici, c'est donc un point au milieu de la tête, puisque le plan d'herbe passe par là.<br>
Cependant, ce point n'est pas nécessairement au milieu de l'objet que 
vous intégrez. Cela dépend de la personne qui a modélisé l'objet et qui a
 donc décidé par rapport à quel point on allait définir la position du 
mesh. Pour un personnage, on pourrait mettre ce point à ses pieds, pour 
que l'altitude 0 corresponde effectivement au moment où le personnage 
touche le sol avec ses pieds.<br>
<br>
Pour corriger cela, il va falloir remonter notre nœud lié à notre entité. C'est l'objet du prochain chapitre.
		</div>
		<hr>
		
	<div id="chap_conclusion">
	Voilà : cette fois, vous avez vraiment mis les pieds dans Ogre3D en 
insérant un modèle dans la scène. Dans le prochain chapitre, nous allons
 apprendre à déplacer des nœuds et à nous déplacer au sein de 
l'environnement 3D.
	</div>
	
	<hr>
	<h1 id="chap_334492">Se repérer dans l'espace</h1>
	<div id="chap_intro">
	Bon : nous avons réussi à afficher une tête d'Ogre et un plan d'herbe dans le chapitre précédent.<br>
<br>
Mais maintenant, il faudrait peut-être savoir comment on va bouger notre
 ogre, qu'il n'ait pas l'air d'avoir été enterré vivant... Enfin ça, ce 
sera après avoir jeté un œil au système de coordonnées de l'espace, un 
peu de théorie ne fait pas de mal. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/hihi.png" alt="^^" class="smilies">
	</div>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_334493">Le système de coordonnées</h2>
		<div class="ss_part_texte">
		<h3>Le repère « main droite »</h3><br>
<br>
Un repère est un ensemble de trois droites, appelées « axes », qui 
définissent la convention utilisée pour enregistrer l'état d'objets se 
trouvant dans l'espace. Afin de simplifier au maximum le repère, ces 
trois axes sont choisis pour que chacun soit orthogonal 
(perpendiculaire) aux deux autres : on l'appelle alors <span class="italique">repère orthogonal</span>.<br>
<br>
On y ajoute une contrainte supplémentaire, disant que les vecteurs directeurs de ces axes sont de longueur 1, ce qui donne un <span class="italique">repère orthonormé</span>.<br>
<br>
<h4>Pourquoi main droite ?</h4><br>
<br>
Nous avons vu que les trois axes du repère étaient orthogonaux, mais 
dans quel sens sont-ils orientés ? En effet, comme les axes sont des 
droites, comment savoir si l'on doit aller dans un sens ou dans l'autre 
si l'on veut se déplacer le long d'un axe ? Nous avons donc besoin d'un 
sens, défini par la règle de la main droite.<br>
<br>
<div class="rmq attention">Il est aussi possible d'utiliser la 
convention « main gauche » dans vos programmes ; cependant, notamment 
parce que les mathématiques sont impliquées dans tout ça, le repère main
 droite est le plus couramment utilisé, c'est le cas dans Ogre.</div><br>
<br>
Regardez votre main droite et placez-la comme sur l'image. Votre pouce 
représente l'axe X, votre index l'axe Y et votre majeur l'axe Z. La 
direction dans laquelle pointe chacun de vos doigts définit le sens de 
chaque axe.<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/239756.png" alt="Image utilisateur"></div><br>
<br>
<h4>Repère local, repère absolu</h4><br>
<br>
Pour l'instant, nous n'avons toujours pas défini comment le repère était
 placé dans la scène. En effet, quel axe pointe dans quelle direction ? 
Là encore, c'est une question de convention adoptée pour les 
applications 3D.<br>
<br>
On prendra donc, pour le repère de la scène, l'axe Y dirigé vers le haut et les axes X et Z dans un plan horizontal.<br>
<br>
Seulement, la scène n'est pas la seule à avoir son repère. En effet, chaque objet possède son propre repère appelé <span class="italique">repère local</span>.
 Lorsque l'objet se déplace ou tourne sur lui-même, le repère local fait
 de même. L'orientation du repère local est la suivante : l'axe Y est 
dirigé vers le haut de l'objet, pour la scène, tandis que l'axe X est 
dirigé vers sa droite et l'axe Z vers l'arrière de l'objet.<br>
<br>
Ci-dessous, j'ai représenté en noir le repère de la scène, et en bleu le
 repère local de la voiture, en respectant la convention que j'ai 
donnée.<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/239759.jpg" alt="Image utilisateur"></div><br>
<br>
Nous verrons à quoi servent ces différents repères lorsque l'on commencera à déplacer nos objets.<br>
<br>
<h4>Yaw, pitch, roll</h4><br>
Le yaw pitch roll, ce n'est pas un nouveau genre de musique, non. Ce 
sont les désignations anglaises pour les rotations autour des axes Y, X 
et Z respectivement.<br>
On peut traduire ces termes par lacet (<span class="italique">yaw</span>), tangage (<span class="italique">pitch</span>) et roulis (<span class="italique">roll</span>), qui sont utilisés par exemple en aéronautique ou en navigation, mais je préfère que vous les reteniez en anglais.<br>
<br>
<div class="rmq question">Pourquoi cela ? L'anglais ne m'aime pas ! Je n'y peux rien !  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/triste.png" alt=":(" class="smilies"> </div><br>
<br>
J'imagine qu'il y en a parmi vous qui sont anglophobes, mais comme on 
vous l'a sûrement déjà dit, pour programmer il est essentiel de 
connaître un minimum d'anglais. En l'occurrence, ces trois termes se 
retrouveront dans les noms qu'Ogre donne aux méthodes permettant 
d'effectuer des rotations. Autant donc vous familiariser tout de suite 
avec eux, vous serez plus à même de rechercher les méthodes qui vous 
intéresseront en temps voulu.<br>
<br>
Voici tout de suite un schéma illustrant les rotations qui s'appliquent à chaque axe :<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/239807.jpg" alt="Image utilisateur"></div><br>
<br>
Comme vous pouvez le constater, il y a un sens donné aux flèches sur ce 
dessin. C'est parce que tout comme l'orientation des axes de notre 
repère, il y a un sens direct et un sens indirect pour les rotations ! 
Ainsi, en imaginant que vous vous teniez le long d'un axe, avec vos 
pieds à l'origine et votre tête au bout de la flèche, vous tournerez 
dans le sens direct si vous vous tournez vers la gauche.<br>
<br>
Il est important de savoir si l'on doit ou non aller dans le sens direct
 pour une rotation, puisque c'est de cette manière que vous déterminerez
 si vous devez tourner d'un angle positif (sens direct) ou négatif (sens
 indirect).<br>
<br>
Pour effectuer une rotation, on appelle la méthode correspondante pour le nœud :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">node</span><span class="o">-&gt;</span><span class="n">yaw</span><span class="p">(</span><span class="n">Radian</span><span class="p">(</span><span class="n">Math</span><span class="o">::</span><span class="n">PI</span><span class="p">));</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Ceci fera faire un demi-tour au nœud par rapport à son axe vertical 
tandis que les méthodes pitch() et roll() s'utilisent de façon analogue 
pour les autres axes.<br>
La rotation se fait par défaut par rapport au repère local. Il faut 
renseigner le second paramètre si vous voulez qu'il en soit autrement 
(voir la section suivante).<br>
<br>
<div class="rmq attention">Les angles doivent être entrés en <a href="http://fr.wikipedia.org/wiki/Radian">radians</a>.</div><br>
<br>
Si vous ne connaissez pas les radians, sachez que c'est l'unité de 
mesure d'angles la plus commune en mathématiques. Dans cette unité, la 
valeur PI (<img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/mimetex.gif" alt="\pi">) est équivalente à 180°, soit un demi-tour.<br>
Pour utiliser tout de même des degrés dans Ogre, vous devrez utiliser la classe <span class="italique">Degree</span>. La ligne de code précédente est équivalente à ceci :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">node</span><span class="o">-&gt;</span><span class="n">yaw</span><span class="p">(</span><span class="n">Degree</span><span class="p">(</span><span class="mi">180</span><span class="p">));</span>
</pre></div>
</td></tr></tbody></table></div>
		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_334484">Déplacer des objets</h2>
		<div class="ss_part_texte">
		<h3>Bouger un nœud de scène</h3><br>
<br>
Nous allons maintenant déplacer notre tête d'ogre pour vérifier la théorie et enfin sortir notre tête de terre !<br>
<br>
Pour cela, nous allons donc - si vous avez bien suivi - passer par le 
nœud auquel est rattaché notre mesh. Celui-ci possède deux méthodes qui 
peuvent nous servir.<br>
<br>
<h4>setPosition()</h4><br>
<br>
La première est la méthode setPosition(), prenant en paramètre les trois
 coordonnées X, Y et Z du point auquel on désire placer le nœud. On peut
 aussi lui passer un Vector3, qui contiendra lui-même ces coordonnées.<br>
<br>
Les deux codes suivants sont donc équivalents.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Vector3</span> <span class="n">position</span> <span class="o">=</span> <span class="n">Vector3</span><span class="p">(</span><span class="mf">30.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
<span class="n">node</span><span class="o">-&gt;</span><span class="n">setPosition</span><span class="p">(</span><span class="n">position</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">node</span><span class="o">-&gt;</span><span class="n">setPosition</span><span class="p">(</span><span class="mf">30.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
La tête s'est maintenant déplacée vers la droite de 30 unités et de 50 unités vers le haut.<br>
<br>
<h4>translate()</h4><br>
<br>
La seconde méthode utilisable pour le déplacement est translate(), qui 
déplace le nœud par rapport à sa position actuelle plutôt que par 
rapport à l'origine de la scène.<br>
Elle prend les mêmes paramètres que la méthode setPosition(), mais avec 
un paramètre supplémentaire, défini par défaut, indiquant le nœud par 
rapport auquel on va se déplacer.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">node</span><span class="o">-&gt;</span><span class="n">translate</span><span class="p">(</span><span class="o">-</span><span class="mf">30.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
En ajoutant cette ligne après la précédente, notre objet se retrouve 
donc maintenant à la position (0, 100, 0) dans la scène, ce qui est 
suffisant pour qu'il surplombe son petit jardin. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/clin.png" alt=";)" class="smilies"><br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/241383.jpg" alt="Image utilisateur"></div><br>
<br>
<div class="rmq question">Tu as parlé d'un paramètre supplémentaire, qu'est-ce que c'est ?</div><br>
<br>
C'est un paramètre pouvant prendre trois valeurs différentes qui définit
 par rapport à quel repère on va se déplacer. Voici les trois valeur qui
 sont acceptées :<br>
<ul>
<li>Node::TS_LOCAL</li>
<li>Node::TS_PARENT</li>
<li>Node::TS_WORLD</li>
</ul><br>
<br>
La première va déplacer le nœud par rapport au repère local, la seconde 
par rapport au repère du nœud parent, et la troisième par rapport au 
repère de la scène, qui est le repère absolu.<br>
<br>
<div class="rmq question">Concrètement, ça veut dire quoi ?</div><br>
<br>
Tout à l'heure, lorsque l'on a effectué une translation, on l'a fait par
 défaut par rapport au repère TS::WORLD, c'est-à-dire avec les axes tels
 que je vous les ai présentés précédemment. Maintenant, nous pouvons 
déplacer notre nœud par rapport au repère local de son nœud père par 
exemple, ou bien même par rapport à son propre repère local.<br>
<br>
<div class="rmq question">Mais à quoi ça sert de s'embêter avec ces 
paramètres ? On risque de faire des erreurs si l'on se place par rapport
 à un repère différent de la scène !</div><br>
<br>
Prenons un exemple. Vous avez un vaisseau spatial qui peut se trouver 
dans n'importe quelles position et orientation de l'espace. Comment 
savoir facilement dans quelle direction je dois faire ma translation 
pour qu'on le voit aller en avant ?<br>
<br>
Réponse : je n'ai pas à m'en occuper ! En effet, l'axe qui va de l'avant
 vers l'arrière du vaisseau est l'axe Z, dans son repère local. Par 
conséquent, je n'ai qu'à dire à mon vaisseau d'avancer le long de l'axe Z
 (dans le sens négatif pour aller à l'avant) <strong>par rapport à son repère local</strong>. Et Ogre s'occupera gentiment de faire les calculs pour placer mon vaisseau correctement dans la scène.<br>
<br>
Allez, comme vous êtes sages, je vous mets <span class="barre">un bon point et une image</span> une petite illustration pour visualiser tout ça.<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/241380.jpg" alt="Image utilisateur"></div><br>
<br>
Si vous avez compris cela, le paramètre TS_PARENT devrait suivre tout seul. Reprenons notre engin spatial.<br>
Sur ce vaisseau, on trouve R2D2 en train de se déplacer vers la droite, 
correspondant donc à l'axe X local du nœud du vaisseau. Pour effectuer 
cette translation, je n'ai qu'à demander à Ogre de déplacer mon robot le
 long de l'axe des abscisses <strong>par rapport au nœud du vaisseau</strong> (qui serait logiquement le nœud parent). Et le tour est joué. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/hihi.png" alt="^^" class="smilies"><br>
<br>
Vous commencez à comprendre l'intérêt des relations de parenté entre les
 nœuds ? Ceux qui répondent non, j'en fais mon affaire !  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/pirate.png" alt=":pirate:" class="smilies">
		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_334491">La caméra</h2>
		<div class="ss_part_texte">
		Après cet exemple haut en couleur, revenons à quelque chose de plus humble pour notre niveau de Zéro. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/langue.png" alt=":p" class="smilies"> <br>
<br>
Maintenant que l'on a un peu déplacé notre tête d'Ogre, on va voir 
comment placer la caméra pour qu'elle la voie sous son meilleur jour dès
 que l'application démarre. La caméra, c'est l'élément qui définit la 
position de notre point de vue dans la scène, dans quelle direction on 
regarde, mais aussi jusqu'à quelle distance il est possible de voir 
s'afficher les objets éloignés.<br>
<br>
Comme tous les éléments de base, un attribut caméra est présent dans la 
classe ExampleApplication. Sans elle nous n'aurions pas encore pu voir 
notre scène, vu que nous n'avons rien fait pour la créer !<br>
<br>
<h4>Création</h4><br>
<br>
La caméra est créée dans une méthode appelée createCamera() de la classe
 ExampleApplication, que nous allons tout de suite redéfinir pour partir
 sur des bases connues. L'attribut correspondant à la caméra est appelé 
mCamera, nous pouvons donc l'utiliser pour créer notre caméra.<br>
<br>
Comme c'est un objet qui se trouve dans la scène, nous allons passer - 
je vous le donne en mille - par le SceneManager. Comme pour les nœuds ou
 les entités, vous pourrez donner un nom à votre caméra sous forme d'une
 chaîne de caractères.<br>
<br>
Ajoutez la méthode createCamera() à votre classe PremiereApplication et ajoutez-y la ligne suivante.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mCamera</span> <span class="o">=</span> <span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">createCamera</span><span class="p">(</span><span class="s">"Ma Camera"</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<h4>Placement</h4><br>
<br>
Maintenant, il va nous falloir placer la caméra et l'orienter. Le 
placement se fait avec la méthode setPosition(), prenant des paramètres 
identiques à ceux de la méthode utilisée pour les nœuds de scène. La 
seconde méthode utilisée s'appelle lookAt() et, comme son nom l'indique,
 elle permet de déterminer le point de la scène que regarde notre 
caméra. On lui fournit un Vector3 ou bien trois réels correspondant aux 
coordonnées désirées.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">setPosition</span><span class="p">(</span><span class="n">Vector3</span><span class="p">(</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">150.0</span><span class="p">,</span> <span class="mf">200.0</span><span class="p">));</span>
<span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">lookAt</span><span class="p">(</span><span class="n">Vector3</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">));</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
En relançant l'application, on se retrouve donc directement à côté de notre tête.<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/241381.jpg" alt="Image utilisateur"></div><br>
<br>
Enfin, on peut aussi indiquer les distances de near clip et de far clip,
 qui sont les distances minimale et maximale auxquelles doit se trouver 
un objet pour être affiché à l'écran. Cela permet, notamment lorsqu'il y
 a beaucoup d'objets dans la scène (en extérieur, par exemple), de ne 
pas ralentir l'exécution du programme en n'affichant pas les objets les 
plus éloignés.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">setNearClipDistance</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">setFarClipDistance</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Si vous recule suffisammentz la caméra, vous verrez que la tête 
disparaît sous vos yeux : elle est trop loin de la caméra pour être 
affichée avec les paramètres que j'ai choisis. <br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/241385.jpg" alt="Image utilisateur"></div><br>
<br>
Le même phénomène se produira si vous vous approchez suffisamment de la 
tête (une plus grosse distance de near clip permettra de mieux le voir).
		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_334500">Le Viewport</h2>
		<div class="ss_part_texte">
		La façon dont la caméra rend à l'écran ce qu'elle voit ne dépend pas 
que d'elle. En effet, la taille de votre zone de rendu et son format 
seront répercutés sur la portion de scène qu'il vous sera donné de voir.
 Si l'on ne tenait pas compte de ces paramètres, on pourrait obtenir une
 image aplatie si l'on élargit la zone de rendu, ou bien au contraire 
compressée si l'on diminue la largeur en laissant la hauteur constante.<br>
<br>
La fenêtre de votre application est un objet distinct de la zone de 
rendu. En effet, dans une même fenêtre, vous pouvez afficher le rendu de
 plusieurs caméra dans la scène, voire des caméras de différents 
SceneManager. Lorsque vous jouez à un jeu multijoueur, c'est ce qui est 
réalisé : vous avez une seule fenêtre pour votre application, mais vous 
voyez plusieurs lieux de la scène, en fonction du placement des joueurs.<br>
<br>
La gestion de l'affichage dans une zone de rendu est laissée à la classe
 Viewport, qui est simplement la partie de votre fenêtre où s'affiche ce
 que voit votre caméra. De ces deux liens découle la création du 
Viewport, appelée par la fenêtre et prenant en paramètre la caméra 
concernée.<br>
<br>
Pour cela, nous allons redéfinir la classe createViewports() qui 
s'occupait jusqu'alors de ce travail pour nous, et copier la ligne 
suivante.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Viewport</span> <span class="o">*</span><span class="n">vue</span> <span class="o">=</span> <span class="n">mWindow</span><span class="o">-&gt;</span><span class="n">addViewport</span><span class="p">(</span><span class="n">mCamera</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Ici, mWindow est la fenêtre de notre application Ogre, c'est une 
instance de la classe RenderWindow dont nous verrons les détails dans un
 prochain chapitre.<br>
<br>
Grâce à ce Viewport nouvellement créé, nous allons faire coïncider le 
rapport largeur / hauteur de notre caméra avec celui du Viewport, pour 
avoir une image non déformée :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">setAspectRatio</span><span class="p">(</span><span class="n">Real</span><span class="p">(</span><span class="n">vue</span><span class="o">-&gt;</span><span class="n">getActualWidth</span><span class="p">())</span> <span class="o">/</span> <span class="n">Real</span><span class="p">(</span><span class="n">vue</span><span class="o">-&gt;</span><span class="n">getActualHeight</span><span class="p">()));</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Les deux méthodes appelées grâce à la vue permettent de récupérer sa 
largeur et sa hauteur, auxquelles on applique un cast vers le format 
Ogre::Real pour obtenir un ratio décimal. Dans le cas contraire, le 
ratio serait tronqué pour être entier et la tête de notre ogre favori 
serait déformée.<br>
<br>
Sachez aussi que c'est le Viewport qui définit la couleur de fond de la 
scène que vous voyez si aucun objet n'apparaît plus. Ici, nous avions du
 noir, mais il est tout à fait possible de mettre du bleu par exemple.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">vue</span><span class="o">-&gt;</span><span class="n">setBackgroundColour</span><span class="p">(</span><span class="n">ColourValue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">));</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Voici donc ma méthode createViewports() au complet :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">void</span> <span class="n">PremiereApplication</span><span class="o">::</span><span class="n">createViewports</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">Viewport</span> <span class="o">*</span><span class="n">vue</span> <span class="o">=</span> <span class="n">mWindow</span><span class="o">-&gt;</span><span class="n">addViewport</span><span class="p">(</span><span class="n">mCamera</span><span class="p">);</span>
    <span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">setAspectRatio</span><span class="p">(</span><span class="n">Real</span><span class="p">(</span><span class="n">vue</span><span class="o">-&gt;</span><span class="n">getActualWidth</span><span class="p">())</span> <span class="o">/</span> <span class="n">Real</span><span class="p">(</span><span class="n">vue</span><span class="o">-&gt;</span><span class="n">getActualHeight</span><span class="p">()));</span>
    <span class="n">vue</span><span class="o">-&gt;</span><span class="n">setBackgroundColour</span><span class="p">(</span><span class="n">ColourValue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Maintenant, notre scène possède un magnifique <span class="barre">ciel</span> fond bleu. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/heureux.png" alt=":D" class="smilies"> <br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/241384.jpg" alt="Image utilisateur"></div>
		</div>
		<hr>
		
	<div id="chap_conclusion">
	Il est important d'avoir bien compris ce chapitre, notamment le système
 de coordonnées et les relations de parenté entre les nœuds de scène 
pour pouvoir placer facilement ses objets dans la scène, sans avoir à 
faire plein de tentatives pour "voir ce que ça donne". C'est du temps 
perdu !<br>
<br>
Et n'oubliez pas : le repère main droite, c'est une façon rapide et 
facile de visualiser vos axes, plutôt que d'aller vérifier leur ordre 
sur un schéma !
	</div>
	
	<hr>
	<h1 id="chap_334494">Allumez la lumière !</h1>
	<div id="chap_intro">
	La gestion des lumières est souvent ce qui représente la moitié du 
travail pour créer l'ambiance dans un jeu. Un couloir sombre, des ombres
 mouvantes sur les murs...  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/huh.png" alt=":o" class="smilies">  Rien de mieux pour une ambiance glauque par exemple. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/langue.png" alt=":p" class="smilies"><br>
<br>
Ogre permet bien sûr de créer ce genre d'ambiance, avec une panoplie de lumières et d'ombres pour s'adapter à tous les besoins.<br>
<br>
Notre mesh est prêt à passer sous les feux des projecteurs.  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/soleil.png" alt=":soleil:" class="smilies">
	</div>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_334486">Les lumières</h2>
		<div class="ss_part_texte">
		<h3>Quelques fonctions de base</h3><br>
<br>
Pour pouvoir voir quelque chose dans une scène, il est nécessaire 
d'avoir des lumières qui vont permettre de répartir l'éclairage et de 
donner un aspect plus vrai à votre environnement. Il faut savoir que 
lorsque vous initialisez votre scène, aucune lumière n'est présente, 
tous les modèles de la scène devraient donc rester noirs.<br>
<br>
<div class="rmq question">Comment a-t-on pu voir nos objets depuis le début de ce cours dans ce cas ?</div><br>
<br>
En plus des lumières, il existe une propriété du Scene Manager qui est 
très pratique et qui permet de définir une lumière ambiante. Cela permet
 d'éclairer la scène de façon homogène avec une certaine luminosité. Par
 défaut, on a un éclairage à la lumière blanche qui permet de voir ce 
qui se passe dans la scène, mais pour la suite du tutoriel, afin de bien
 voir l'influence de nos lumières, nous allons retirer cet éclairage en 
lui appliquant la couleur noire. La ligne suivante peut être ajoutée au 
début de la méthode createScene().<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">setAmbientLight</span><span class="p">(</span><span class="n">ColourValue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">));</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
La classe ColourValue permet de définir une couleur en entrant les 
quantités respectives de rouge,  de vert puis de bleu dans un nombre 
compris entre 0 et 1. Il est aussi possible de définir une composante 
alpha (la transparence), utile pour des textures par exemple.<br>
<br>
<br>
Pour créer une lumière, encore une fois c'est très simple. Comme c'est 
un objet de scène, je pense que vous avez déjà deviné que l'on va passer
 par une certaine classe pour l'instancier...<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Light</span> <span class="o">*</span><span class="n">light</span> <span class="o">=</span> <span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">createLight</span><span class="p">(</span><span class="s">"lumiere1"</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Oui, à nouveau, c'est le Scene Manager qui va s'occuper de la création 
pour nous, toujours assez facilement vous l'aurez remarqué.<br>
<br>
<div class="rmq information">Par défaut, la lumière créée est de type 
ponctuelle. Vous avez plus de détails sur les différents types de 
lumière un peu plus bas.</div><br>
<br>
Mettons tout de suite en place quelques paramètres de base : la couleur émise, la position et la puissance.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">light</span><span class="o">-&gt;</span><span class="n">setDiffuseColour</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
<span class="n">light</span><span class="o">-&gt;</span><span class="n">setSpecularColour</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
<span class="n">light</span><span class="o">-&gt;</span><span class="n">setPosition</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="n">light</span><span class="o">-&gt;</span><span class="n">setPowerScale</span><span class="p">(</span><span class="mf">3.0</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
En ajoutant ce code après la création de la lumière, on obtient un 
lumière positionnée sur le côté de notre mesh. En tournant autour, vous 
verrez que le côté opposé est plus sombre.<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/241570.jpg" alt="Image utilisateur"></div><br>
<br>
Les deux premiers paramètres sont les couleurs diffuses et spéculaires, au format <acronym title="Rouge, Vert, Bleu">RVB</acronym>,
 avec des valeurs qui doivent être comprises entre 0 et 1. J'ai ici 
choisi une lumière proche de le lumière blanche avec une composante 
verte plus faible pour éviter de rendre notre scène trop flashy. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/hihi.png" alt="^^" class="smilies"> Vous pouvez bien sûr changer les paramètres pour essayer des couleurs... inattendues. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/clin.png" alt=";)" class="smilies"> <br>
<br>
Ce point sera revu plus en détail dans un chapitre abordant les 
matériaux ; sachez seulement que la couleur diffuse est la couleur sous 
laquelle vont apparaître les objets non brillants, et que la couleur 
spéculaire est un paramètre supplémentaire pour les matériaux 
réfléchissants comme le métal ou le verre. Pour une lumière, on met 
généralement la même couleur pour ces deux paramètres.<br>
<br>
Vient ensuite la méthode setPosition(), qui ne devrait pas vous poser de
 problèmes, et enfin une dernière ligne permettant d'amplifier ou de 
diminuer l'intensité lumineuse. Par défaut, ce coefficient est de 1, 
mais pour notre scène j'ai voulu l'augmenter pour qu'on y voie un peu 
plus clair : n'hésitez pas à jouer un peu avec pour faire des essais.<br>
<br>
<br>
Enfin, sachez qu'il est possible d'attacher une lumière à un nœud de 
scène. Dans ce cas, la méthode Light::setPosition() définit la position 
relative de la lumière par rapport au nœud.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">node</span><span class="o">-&gt;</span><span class="n">attachObject</span><span class="p">(</span><span class="n">light</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Vous pouvez donc facilement placer une lumière à la position d'un mesh 
censé émettre de la lumière - par exemple les phares d'une voiture - et 
les déplacer en même temps grâce à une seule commande vers le nœud de 
scène !<br>
<br>
<h3>Les types de lumières</h3><br>
<br>
Je vous l'annonçais, Ogre peut gérer différents types de lumières selon l'effet désiré. Ils sont au nombre de 3 :<br>
<ul>
<li>la lumière ponctuelle : cette lumière émet dans toutes les directions à partir de sa position ;</li>
<li>la lumière directionnelle, une lumière dont les rayons vont dans une
 direction unique et qui n'a pas de position. C'est le genre de lumière 
qui permet de reproduire l'éclairage du soleil par exemple ;</li>
<li>le projecteur ou spot : c'est une lumière qui émet un cône lumineux à partir de sa position, à la façon d'une lampe-torche.</li>
</ul><br>
<br>
<h4>Lumière ponctuelle</h4><br>
C'est le type de lumière créé par défaut que l'on a vu plus haut. Pour 
le modifier manuellement, il faut utiliser le type LT_POINT.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">light</span><span class="o">-&gt;</span><span class="n">setType</span><span class="p">(</span><span class="n">Light</span><span class="o">::</span><span class="n">LT_POINT</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Avec ce type de lumière, il existe une méthode nous permettant aussi de limiter la portée de notre éclairage.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">light</span><span class="o">-&gt;</span><span class="n">setAttenuation</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.007</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div> <br>
<br>
Voici le prototype de la fonction :<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Light</span><span class="o">::</span><span class="n">setAttenuation</span><span class="p">(</span> <span class="n">Real</span> <span class="n">range</span><span class="p">,</span> <span class="n">Real</span> <span class="n">constant</span><span class="p">,</span> <span class="n">Real</span> <span class="n">linear</span><span class="p">,</span> <span class="n">Real</span> <span class="n">quadratic</span> <span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div>	<br>
<br>
C'est plus délicat car les paramètres doivent être choisis avec soin. Le
 premier est la distance caractéristique d'atténuation, c'est-à-dire la 
distance à partir de laquelle la luminosité diminue. constant est une 
constante d'atténuation comprise entre 0 et 1. Plus elle est proche de 
0, et plus le passage de la lumière à l'ombre est brutal. Enfin linear 
et quadratic sont les paramètres de la courbe d'atténuation, et doivent 
être assez faibles, sinon la lumière s'atténue trop rapidement. Vous 
pouvez jouer un peu avec les valeurs pour voir le comportement de 
l'atténuation, qui est assez subtil.<br>
<br>
<div class="rmq question">Ça ne marche pas ! L'ogre est bien éclairé mais le sol reste désespérément noir !</div><br>
<br>
L'atténuation ajoute une caractéristique un peu différente pour la 
gestion de la lumière. En effet, l'éclairage des surfaces est calculé en
 fonction des vertices situés dans la zone d'éclairage. Lorsqu'un 
vertice est dans la zone d'éclairage du spot, la surface autour de lui 
est éclairée, sinon elle est dans l'ombre. Ogre se charge ensuite de 
faire les dégradés entre les vertices plus ou moins éclairés.<br>
<br>
Mais ici, notre plan n'est constitué que de quatre vertices (les coins),
 dont aucun n'est éclairé par le spot. Le sol n'est donc pas éclairé. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/hihi.png" alt="^^" class="smilies"><br>
<br>
Pour régler ça, il suffit de modifier notre sol pour qu'il possède plus 
de vertices. Retrouvez la définition du plan et modifiez les paramètres 
de découpage pour obtenir 10 segments en largeur et en longueur (les 
deux paramètres avant le <span class="code2 cpp"><span class="kc">true</span></span>).<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Plane</span> <span class="n">plan</span><span class="p">(</span><span class="n">Vector3</span><span class="o">::</span><span class="n">UNIT_Y</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">MeshManager</span><span class="o">::</span><span class="n">getSingleton</span><span class="p">().</span><span class="n">createPlane</span><span class="p">(</span><span class="s">"sol"</span><span class="p">,</span> <span class="n">ResourceGroupManager</span><span class="o">::</span><span class="n">DEFAULT_RESOURCE_GROUP_NAME</span><span class="p">,</span> <span class="n">plan</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Vector3</span><span class="o">::</span><span class="n">UNIT_Z</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/241571.jpg" alt="Image utilisateur"></div><br>
<br>
<br>
Notez que plus il y aura de vertices sur le modèle, plus ce sera précis, mais ce sera un peu plus coûteux en ressources.<br>
<br>
<h4>Lumière directionnelle</h4><br>
Étant donné que cette lumière est de type « soleil » et qu'elle émet à 
l'infini, il n'est pas utile de renseigner sa position. En revanche, la 
méthode setDirection() permet de définir le vecteur directeur des rayons
 lumineux.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">light</span><span class="o">-&gt;</span><span class="n">setType</span><span class="p">(</span><span class="n">Light</span><span class="o">::</span><span class="n">LT_DIRECTIONAL</span><span class="p">);</span>
<span class="n">light</span><span class="o">-&gt;</span><span class="n">setDirection</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<h4>Projecteur</h4><br>
Le projecteur permet généralement de simuler un éclairage artificiel en 
proposant une lumière directionnelle définie dans un cône central et un 
cône extérieur, avec deux intensités différentes. Le cône central 
définit une lumière plus forte que le cône extérieur, où la lumière est 
quelque peu atténuée. Ces deux cônes sont définis par leur angle 
d'ouverture, ainsi que par un <span class="italique">falloff</span>, c'est-à-dire un coefficient indiquant si la transition entre les deux cônes doit être plus ou moins rapide :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">light</span><span class="o">-&gt;</span><span class="n">setType</span><span class="p">(</span><span class="n">Light</span><span class="o">::</span><span class="n">LT_SPOTLIGHT</span><span class="p">);</span>
<span class="n">light</span><span class="o">-&gt;</span><span class="n">setPosition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">);</span>
<span class="n">light</span><span class="o">-&gt;</span><span class="n">setDirection</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">light</span><span class="o">-&gt;</span><span class="n">setSpotlightRange</span><span class="p">(</span><span class="n">Degree</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">Degree</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Notez que l'éclairage du spot obéit aux mêmes règles que pour 
l'atténuation d'une lumière ponctuelle : il faut que les vertices soient
 éclairés pour que l'éclairage soit visible.<br>
<br>
Notre spot devrait éclairer le sol d'une façon similaire à la lumière 
ponctuelle avec atténuation ; cependant, retenez bien que cela ne va que
 dans une seule direction :<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/241527.jpg" alt="Image utilisateur"></div><br>
<br>
De même que pour les lumières ponctuelles, vous pouvez ajouter une 
portée limitée à votre projecteur avec la méthode setAttenuation().
		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_334495">Les ombres</h2>
		<div class="ss_part_texte">
		<h3>Activer les ombres</h3><br>
<br>
Tout d'abord, on doit paramétrer nos lumières et nos entités pour projeter (ou non) des ombres.<br>
<br>
Que ce soit pour les lumières ou les entités, on utilise la même méthode pour choisir d'activer ou non la projection :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">light</span><span class="o">-&gt;</span><span class="n">setCastShadows</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="n">head</span><span class="o">-&gt;</span><span class="n">setCastShadows</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Si vous voulez qu'une entité ne projette aucune ombre, il suffit de mettre le paramètre à <span class="code2 cpp"><span class="kc">false</span></span>.
 De même si vous voulez qu'une lumière ne projette aucune ombre pour les
 entités (pour une lumière d'ambiance ou d'ajustement, par exemple).<br>
<br>
N'oubliez pas de désactiver la projection d'ombres pour le sol. D'une 
part parce que celui-ci n'a pas besoin de projeter d'ombres, d'autre 
part parce que certaines techniques nécessitent d'avoir ce paramètre 
désactivé pour avoir une ombre sur le mesh.<br>
<br>
<br>
Avant de pouvoir afficher les ombres, il faut les activer. Cela se fait dans le Scene Manager, par exemple :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">setShadowTechnique</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">SHADOWTYPE_STENCIL_ADDITIVE</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
On définit ici la technique de rendu qui sera utilisée pour les ombres dans la scène (voir ci-dessous).<br>
<br>
<h3>Les différents types d'ombres</h3><br>
<br>
Ogre permet de générer différents types d'ombres selon les besoins, qui 
dépendent généralement des modèles concernés par la projection d'ombres.<br>
<br>
Il existe deux techniques pour la génération d'ombres :<br>
<ul>
<li>le type « Stencil » (pochoir en anglais) ;</li>
<li>le type « Texture ».</li>
</ul><br>
<br>
Les ombres de type Stencil sont très précises dans les contours et 
permettent une très bonne projection d'ombre lorsque l'on y regarde de 
près. En revanche, elles sont assez coûteuses en ressources, notamment 
lorsque les mesh sont animés. Enfin, elles ne prennent pas du tout en 
compte la transparence des textures, un cube de texture transparente 
projettera donc une ombre si ce paramètre est activé.<br>
Les ombres de type Texture permettent de gérer la transparence des 
textures et sont moins coûteuses en ressources, mais leur précision est 
plus faible.<br>
<br>
Enfin, chacune de ces deux catégories est composée de deux techniques, l'une dite <span class="italique">modulative</span>, l'autre <span class="italique">additive</span>. On obtient ainsi quatre techniques possibles :<br>
<ul>
<li>SHADOWTYPE_TEXTURE_MODULATIVE</li>
<li>SHADOWTYPE_TEXTURE_ADDITIVE</li>
<li>SHADOWTYPE_STENCIL_MODULATIVE</li>
<li>SHADOWTYPE_STENCIL_ADDITIVE</li>
</ul><br>
<br>
Notez que dans chacun des cas, la technique additive est la meilleure, 
notamment pour une approche de type Stencil. La différence pour les 
techniques de type Texture est minime ; en revanche, la technique 
Stencil additive permet d'obtenir des ombres plus ou moins sombres en 
fonction de l'éclairage grâce à des passes successives, tandis que la 
méthode Stencil modulative ne fait que projeter le modèle au sol une 
seule fois pour chaque lumière.<br>
<br>
<br>
C'est donc dans le Scene Manager que l'on s'occupe de déterminer la 
technique de rendu des ombres. Par défaut, celles-ci ne sont pas 
rendues.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">setShadowTechnique</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">SHADOWTYPE_STENCIL_MODULATIVE</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<div class="rmq attention">Il n'est possible d'avoir qu'une seule 
technique enregistrée à la fois dans un Scene Manager. Il n'est pas 
possible de choisir les types d'ombres à générer pour chaque lumière de 
la scène. Il faut donc faire un choix pour l'ensemble de vos ombres.</div><br>
<br>
Ci-dessous, l'approche basée sur la texture, peu précise mais peu coûteuse en ressources :<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/241467.jpg" alt="Image utilisateur"></div><br>
<br>
Voici ce que l'on obtient avec la technique Stencil modulative (première
 image) et additive (deuxième image), si l'on met une lumière de chaque 
coté de la scène à des distances différentes :<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/241469.jpg" alt="Technique stencil modulative"></div><br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/241466.jpg" alt="Technique stencil additive"></div>
		</div>
		<hr>
		
	<div id="chap_conclusion">
	Entités, nœuds, caméras, lumières... Mine de rien, nous avons déjà 
parcouru un bon nombre d'objets de base que l'on peut insérer dans une 
scène. Hé vous êtes toujours là ?! On va pouvoir continuer, dans ce cas.
 <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/clin.png" alt=";)" class="smilies"><br>
<br>
Dans le prochain chapitre, nous allons notamment nous intéresser à la 
gestion des entrées clavier / souris et plus généralement à une façon de
 faire des traitements entre chaque image rendue par Ogre.
	</div>
	
	<hr>
	<h1 id="chap_425391">La gestion des entrées</h1>
	<div id="chap_intro">
	Jusqu'ici, nous avons surtout utilisé les objets de base d'Ogre que 
nous avons intégrés à notre scène petit à petit. On a pu ainsi insérer 
la tête d'un ogre, symbole du moteur, l'observer sous toutes les 
coutures en tournant autour...<br>
<br>
<div class="rmq question">D'ailleurs, je ne me souviens pas avoir écrit 
du code pour pouvoir déplacer la caméra. C'est génial Ogre, le clavier 
et la souris marchent tout seuls !</div><br>
<br>
Chers lecteurs, il est maintenant temps d'apprendre à gérer nous-mêmes 
les entrées dans notre application, ce qui était jusqu'ici fait par les 
méthodes de la classe ExampleApplication. <br>
<br>
À la fin de ce chapitre, vous serez aptes à configurer vous-mêmes les 
touches du clavier que vous souhaitez utiliser, les actions à effectuer 
lors de l'appui sur une touche, bref vous aurez la mainmise sur les 
possibilités offertes à l'utilisateur.  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/soleil.png" alt=":soleil:" class="smilies">
	</div>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_425389">Les frame listeners</h2>
		<div class="ss_part_texte">
		<h3>Des « écouteurs d'images » ?</h3><br>
<br>
<h4>Utilité</h4><br>
<br>
Comme pour la télévision, tout ce que vous voyez sur l'écran de votre 
ordinateur n'est qu'une succession d'images affichées les unes après les
 autres de façon très rapide pour donner l'impression de mouvement à 
l'œil. Ogre n'échappe pas à la règle et comme tout moteur graphique, il 
affiche une image de la scène telle qu'elle est à chaque instant, après 
avoir fait les éventuels calculs que vous lui aurez demandés.<br>
<br>
<div class="rmq question">Bon ok, j'ai bien compris ça, mais quel est le rapport avec la gestion des entrées ?</div><br>
<br>
Lorsque vous gérez les entrées de l'utilisateur (et même pour faire des 
calculs divers durant l'exécution de votre programme), l'ordinateur 
effectue les instructions nécessaires entre deux images (ou <span class="italique">frames</span> en anglais), donc pendant un temps très court.<br>
<br>
En pratique, le moteur fonctionne dans une boucle, qui ne fait 
qu'afficher une image, puis faire des calculs ; et ainsi de suite, sans 
s'arrêter. Il est donc possible pour le programmeur de donner ses 
instructions avant qu'une image soit rendue, ou bien après, ou bien même
 pendant que la carte graphique fait le rendu graphique.<br>
<br>
Lorsque l'on aura vu comment créer cette boucle de rendu, nous serons à 
même de donner les instructions de la manière dont nous le désirons. En 
attendant, je vais vous présenter une classe qui a l'avantage de 
permettre de faire tout ce que je viens de vous expliquer de façon très 
simple : le frame listener.<br>
<br>
<h4>Les méthodes à connaître</h4><br>
<br>
Un frame listener est une classe interface qui possède trois méthodes, dont voici les prototypes :<br>
<ul>
<li><span class="code2 cpp"><span class="k">virtual</span> <span class="kt">bool</span> <span class="n">frameStarted</span><span class="p">(</span><span class="k">const</span> <span class="n">FrameEvent</span><span class="o">&amp;</span> <span class="n">evt</span><span class="p">);</span></span></li>
<li><span class="code2 cpp"><span class="k">virtual</span> <span class="kt">bool</span> <span class="n">frameRenderingQueued</span><span class="p">(</span><span class="k">const</span> <span class="n">FrameEvent</span><span class="o">&amp;</span> <span class="n">evt</span><span class="p">);</span></span></li>
<li><span class="code2 cpp"><span class="k">virtual</span> <span class="kt">bool</span> <span class="n">frameEnded</span><span class="p">(</span><span class="k">const</span> <span class="n">FrameEvent</span><span class="o">&amp;</span> <span class="n">evt</span><span class="p">);</span></span></li>
</ul><br>
Chacune de ces méthodes est appelée à un moment précis de la boucle de 
rendu : avant que la frame ne soit rendue (frameStarted), après que la 
frame ait été rendue (frameEnded), ou bien juste après que le processeur
 graphique ait reçu les instructions pour le rendu 
(frameRenderingQueued).<br>
<br>
En créant un objet dérivé de la classe frame listener dans votre 
application et en réimplémentant ces méthodes virtuelles, vous avez donc
 la possibilité de demander à Ogre d'effectuer les calculs dont vous 
avez besoin à chaque image.<br>
<br>
<div class="rmq question">Mais tu nous donnes trois méthodes : comment savoir laquelle choisir ?</div><br>
<br>
Tout d'abord, frameStarted() et frameEnded() sont très similaires, étant
 donné qu'elles ont pour seule différence d'être appelées respectivement
 au début et à la fin de la boucle de rendu. Mais comme on est dans une 
boucle, en réalité il ne se passe quasiment rien entre l'appel à 
frameEnded() et celui à frameStarted(). La différence peut être utile 
par exemple si vous avez un calcul qu'il semble plus logique d'effectuer
 après que l'image soit rendue plutôt qu'avant, mais ce n'est qu'une 
question de lecture du code selon moi.<br>
<br>
En revanche la dernière est plus subtile. Comme je l'ai dit, elle est 
appelée dès que la carte graphique reçoit les instructions nécessaires 
pour afficher l'image à rendre.<br>
<br>
Vous le savez probablement, c'est une opération très coûteuse en 
ressources et c'est souvent ce qui ralentit les jeux vidéo mettant en 
jeu de nombreux effets graphiques. Pendant ce temps-là, le processeur 
central... Eh bien on peut dire qu'il attend que ça se passe. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/rire.gif" alt=":lol:">
 Par conséquent, si vous appelez la méthode frameRenderingQueued() pour 
faire des calculs, vous évitez d'avoir un processeur peu occupé pendant 
que la carte graphique fait son boulot !<br>
<br>
De manière générale, on pourra utiliser cette méthode pour des 
opérations lourdes dont on sait qu'elles seront répétées à chaque image,
 afin de rentabiliser l'utilisation du processeur.<br>
<br>
<h4>Contrôle de l'exécution</h4><br>
<br>
La valeur de retour des méthodes d'un frame listener est un booléen 
récupéré par Ogre pour savoir s'il doit continuer ou non l'exécution du 
programme.<br>
<br>
Tant que cette valeur est <span class="code2 cpp"><span class="kc">true</span></span>, le rendu continue. En revanche, si une des méthodes renvoie la valeur <span class="code2 cpp"><span class="kc">false</span></span>, l'exécution s'interrompt et le programme se ferme.<br>
<br>
<h4>Utiliser plusieurs frame listeners</h4><br>
<br>
Il est possible de créer autant de frame listeners que vous le désirez, 
pour effectuer des opérations diverses. En revanche, il est conseillé de
 ne pas en abuser pour éviter de trop segmenter votre application, il 
peut être intéressant d'appeler d'autres fonctions à partir d'un frame 
listener plutôt que d'en créer trop.<br>
<br>
Enfin, et c'est là le plus important :<br>
<br>
<div class="rmq erreur">L'ordre d'exécution des frame listeners est laissé aux soins du moteur. Vous n'avez AUCUN contrôle dessus !</div><br>
<br>
En d'autres termes, si vous avez besoin d'effectuer des opérations dans 
un ordre précis, ne les mettez pas dans des frame listeners différents, 
car vous ne pourrez pas décider de l'ordre d'exécution. Il faut alors 
laisser un seul frame listener gérer les opérations, ou ne pas passer 
par eux (ce sera possible lorsque nous attaquerons la boucle de rendu).<br>
<br>
<h3>Le frame listener en pratique</h3><br>
<br>
Comme nous allons vouloir redéfinir les méthodes du frame listener, il 
faut en faire une classe dérivée. Vu que nous sommes dans la gestion des
 entrées, nous allons tout de suite préparer le terrain en créant une 
classe InputListener dérivant de ExampleFrameListener.<br>
<br>
<div class="rmq information">Je dérive ici de la classe 
ExampleFrameListener, elle-même dérivée de FrameListener, car la classe 
ExampleApplication met déjà en place une gestion des entrées et attend 
un ExampleFrameListener. Cette classe s'occupe aussi de construire les 
objets nécessaires à l'écoute des entrées souris/clavier, ce que nous 
aborderons ultérieurement.<br>
Cependant, la méthode de traitement reste identique, nous allons juste 
devoir redéfinir frameRenderingQueued() pour implémenter notre propre 
gestion des entrées à la place de celle prévue par ExampleFrameListener.</div><br>
<br>
<span class="code">Code : C++ - InputListener.h - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="syntax"><pre><span class="cp">#include "ExampleFrameListener.h"</span>

<span class="k">class</span> <span class="nc">InputListener</span> <span class="o">:</span> <span class="k">public</span> <span class="n">ExampleFrameListener</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="n">InputListener</span><span class="p">(</span><span class="n">RenderWindow</span><span class="o">*</span> <span class="n">win</span><span class="p">,</span> <span class="n">Camera</span><span class="o">*</span> <span class="n">cam</span><span class="p">,</span> <span class="n">SceneManager</span> <span class="o">*</span><span class="n">sceneMgr</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">bufferedKeys</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">bufferedMouse</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">bufferedJoy</span> <span class="o">=</span> <span class="kc">false</span> <span class="p">);</span>
    <span class="k">virtual</span> <span class="kt">bool</span> <span class="n">frameRenderingQueued</span><span class="p">(</span><span class="k">const</span> <span class="n">FrameEvent</span><span class="o">&amp;</span> <span class="n">evt</span><span class="p">);</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">SceneManager</span> <span class="o">*</span><span class="n">mSceneMgr</span><span class="p">;</span>

    <span class="kt">bool</span> <span class="n">mToucheAppuyee</span><span class="p">;</span>

    <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">mMouvement</span><span class="p">;</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">mVitesse</span><span class="p">;</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">mVitesseRotation</span><span class="p">;</span>

    <span class="n">Ogre</span><span class="o">::</span><span class="n">Radian</span> <span class="n">mRotationX</span><span class="p">;</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">Radian</span> <span class="n">mRotationY</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Concernant les attributs indiqués, j'ai tout d'abord inséré un pointeur 
sur le Scene Manager, qui servira à retrouver des objets dans la scène.<br>
<br>
Le booléen nous sera utile lors de la création d'un interrupteur, pour 
garder une trace de l'état dans lequel se trouve une touche 
particulière.<br>
<br>
Ensuite viennent des nombres qui contiendront la distance de déplacement
 de la caméra et sa vitesse, puis des angles de rotation.<br>
<br>
<br>
Dans votre fichier InputListener.cpp, préparez le constructeur ainsi que
 l'implémentation des méthodes, avec un corps vide pour l'instant :<br>
<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">InputListener</span><span class="o">::</span><span class="n">InputListener</span><span class="p">(</span><span class="n">RenderWindow</span><span class="o">*</span> <span class="n">win</span><span class="p">,</span> <span class="n">Camera</span><span class="o">*</span> <span class="n">cam</span><span class="p">,</span> <span class="n">SceneManager</span> <span class="o">*</span><span class="n">sceneMgr</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">bufferedKeys</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">bufferedMouse</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">bufferedJoy</span> <span class="o">=</span> <span class="kc">false</span> <span class="p">)</span> 
       <span class="o">:</span> <span class="n">ExampleFrameListener</span><span class="p">(</span><span class="n">win</span><span class="p">,</span> <span class="n">cam</span><span class="p">,</span> <span class="n">bufferedKeys</span><span class="p">,</span> <span class="n">bufferedMouse</span><span class="p">,</span> <span class="n">bufferedJoy</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">mSceneMgr</span> <span class="o">=</span> <span class="n">sceneMgr</span><span class="p">;</span>
    <span class="n">mVitesse</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
    <span class="n">mVitesseRotation</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>
    <span class="n">mToucheAppuyee</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<br>
Revenons sur le constructeur que je vous propose. Sachez déjà qu'il n'y a
 pas de constructeur écrit pour les frame listeners, car c'est une 
classe interface, seules les trois méthodes que j'ai présentées plus 
haut importent. En revanche, la classe ExampleFrameListener possède un 
constructeur qui prépare le terrain pour l'utilisation des entrées, que 
j'appelle dans ma classe dérivée. Mon constructeur prend six paramètres,
 les trois premiers étant votre RenderWindow pour l'application, la 
caméra que vous utilisez et le Scene Manager.<br>
<br>
Les trois booléens suivants indiquent si vous désirez utiliser le buffer
 respectivement pour le clavier, la souris et le joystick. Comme ce sera
 l'objet de la dernière partie de ce chapitre, je mets par défaut <span class="code2 cpp"><span class="kc">false</span></span>.<br>
<br>
Dans le corps du constructeur, j'initialise mes attributs mSceneMgr, 
mVitesse et mToucheAppuyee, qui nous serviront par la suite.<br>
<br>
Il n'y a pas d'attribut à ajouter dans notre classe PremiereApplication,
 la classe ExampleApplication contient déjà un pointeur sur un 
ExampleFrameListener.
		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_425388">OIS</h2>
		<div class="ss_part_texte">
		Pour gérer les entrées de l'utilisateur, nous allons utiliser la bibliothèque OIS (<span class="italique">Object Oriented Input System</span>,
 signifiant Système d'entrées orienté objet), qui est distribuée par 
défaut avec le SDK d'Ogre. Comme je l'ai dit en introduction de ce 
cours, un moteur 3D n'a pas de méthodes pour gérer autre chose que ce 
qui s'affiche sur votre écran, ce n'est pas son but. C'est pourquoi nous
 utiliserons cette bibliothèque qui s'intègre très bien dans Ogre pour 
récupérer les actions du joueur.<br>
<br>
<br>
Pour ce faire, OIS représente les périphériques d'entrée par des objets, qui sont les suivants :<br>
<br>
<ul>
<li><span class="italique">Mouse</span> pour la souris ;</li>
<li><span class="italique">Keyboard</span> pour le clavier ;</li>
<li><span class="italique">Joystick</span> pour les joysticks ou manettes de jeu.</li>
</ul><br>
<br>
<div class="rmq attention">Qui dit nouvelle bibliothèque dit nouveau namespace ! Ces classes se trouvent donc dans l'espace de nom OIS.</div><br>
<br>
Les touches du clavier et les boutons de la souris sont des énumérations, définies comme ceci :<br>
<br>
<ul>
<li>OIS::KC_<span class="italique">NOMDELATOUCHE</span> pour le clavier ;</li>
<li>OIS::MB_<span class="italique">NOMDUBOUTON</span> pour la souris.</li>
</ul><br>
<br>
Ce qui donne par exemple OIS::KC_A pour la touche 'A', ou OIS::MC_Left pour le clic gauche.<br>
<br>
<div class="rmq information">J'en profite pour préciser (si vous voulez 
expérimenter ensuite) que la touche 'Entrée' s'appelle 'Return' en 
anglais, ne cherchez donc pas OIS::KC_ENTER, vous ne trouverez pas. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/clin.png" alt=";)" class="smilies"> </div><br>
<br>
<div class="rmq attention">Une dernière chose bonne à savoir : les codes
 de touches d'OIS correspondent aux touches physiques d'un clavier 
QWERTY. Ce qui signifie par exemple que OIS::KC_A correspond à la touche
 Q sur votre clavier AZERTY. Je n'ai pour l'instant pas trouvé de moyen 
de changer ça simplement (sans mapper les touches une par une), mais on 
s'y accommode, vous verrez. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/hihi.png" alt="^^" class="smilies"></div><br>
<br>
Afin d'utiliser OIS, il faut inclure le header correspondant. Celui-ci 
se trouve dans le dossier OIS du dossier include, on ajoutera donc la 
ligne de préprocesseur suivante en tête du header de InputListener :<br>
<br>
<span class="code">Code : C++ - InputListener.h - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="cp">#include &lt;OIS/OIS.h&gt;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Bien sûr, vous pouvez aussi ajouter le répertoire OIS à la liste des 
includes de votre IDE pour éviter d'avoir à le préciser dans le code.
		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_425392">Allons-y sans buffer</h2>
		<div class="ss_part_texte">
		<h3>Explications</h3><br>
<br>
Dans le constructeur de notre frame listener, je vous ai dit que l'on 
avait mis les paramètres concernant l'utilisation du buffer à <span class="code2 cpp"><span class="kc">false</span></span>, car c'est l'objet de la dernière partie de ce chapitre. Mais que signifie le fait d'utiliser ou non le buffer ?<br>
<br>
Lorsque vous appuyez sur une touche, le clavier envoie un signal à 
l'ordinateur pour lui dire qu'une touche est actuellement pressée, en 
précisant quelle touche est concernée. Ce signal est envoyé tant que la 
touche reste enfoncée.<br>
<br>
De son coté, notre programme effectue sa boucle infinie, rendant les 
images et faisant les calculs demandés. Supposons que vous appuyez sur 
une touche à un instant donné. Lorsque l'ordinateur arrivera à 
l'instruction lui demandant de regarder ce qui se passe sur le clavier, 
il va voir qu'une touche est enfoncée et cherchera à effectuer les 
opérations demandées, et ceci tant que la touche reste enfoncée. C'est 
donc très pratique si l'on veut déplacer la caméra dans la scène par 
exemple : tant que la touche est enfoncée, on avance d'une certaine 
distance à chaque tour de boucle.<br>
<br>
Mais imaginons que vous vouliez juste effectuer une action ponctuelle, 
comme ouvrir votre inventaire, ou bien actionner un interrupteur. En 
appuyant sur la touche, il y a très peu de chances pour que celle-ci ne 
reste enfoncée que pendant le temps d'affichage d'une seule image. Le 
programme va donc actionner une fois l'interrupteur, puis à l'image 
suivante, la touche étant toujours enfoncée, il va l'actionner à 
nouveau, et ainsi de suite... Il n'est pas possible pour l'ordinateur de
 faire seul la différence entre une touche enfoncée et une touche qui 
vient d'être enfoncée.<br>
<br>
Nous allons donc voir comment régler ce problème « à la main », puis 
nous verrons l'utilisation du buffer, qui constitue une autre façon de 
traiter l'entrée.<br>
<br>
<h3>Création du frame listener</h3><br>
<br>
Avant de passer à la suite, réimplémentez la méthode 
createFrameListener() présente dans ExampleApplication dans la classe 
PremiereApplication en ajoutant le prototype et la définition :<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">void</span> <span class="n">PremiereApplication</span><span class="o">::</span><span class="n">createFrameListener</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">mFrameListener</span><span class="o">=</span> <span class="k">new</span> <span class="n">InputListener</span><span class="p">(</span><span class="n">mWindow</span><span class="p">,</span> <span class="n">mCamera</span><span class="p">,</span> <span class="n">mSceneMgr</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="n">mRoot</span><span class="o">-&gt;</span><span class="n">addFrameListener</span><span class="p">(</span><span class="n">mFrameListener</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
La première ligne crée le frame listener en appelant le constructeur 
préparé plus tôt ; la seconde indique à l'objet root que nous avons un 
nouveau frame listener qu'il faudra penser à appeler. Le root est 
l'élément de base de l'application Ogre qui s'occupe notamment de gérer 
les frame listeners, nous le reverrons plus tard en approfondissant le 
fonctionnement du moteur.<br>
<br>
<h3>Déplacer la caméra</h3><br>
<br>
Tout d'abord, nous allons considérer le déplacement de caméra, pour 
lequel nous n'avons pas besoin de savoir si la touche vient d'être 
appuyée : c'est simplement son état actuel qui compte.<br>
<br>
<br>
Premièrement, il nous faut récupérer l'état actuel du clavier et de la 
souris. Localisez la méthode frameRenderingQueued() de votre 
InputListener et insérez-y ceci :<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="syntax"><pre><span class="k">if</span><span class="p">(</span><span class="n">mMouse</span><span class="p">)</span>
    <span class="n">mMouse</span><span class="o">-&gt;</span><span class="n">capture</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span><span class="n">mKeyboard</span><span class="p">)</span>
    <span class="n">mKeyboard</span><span class="o">-&gt;</span><span class="n">capture</span><span class="p">();</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Ces deux lignes permettent de mettre à jour nos objets pour obtenir le nom des touches enfoncées.<br>
<br>
Vérifions d'abord si la touche Echap est utilisée, auquel cas nous quitterons l'application.<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="k">if</span><span class="p">(</span><span class="n">mKeyboard</span><span class="o">-&gt;</span><span class="n">isKeyDown</span><span class="p">(</span><span class="n">OIS</span><span class="o">::</span><span class="n">KC_ESCAPE</span><span class="p">))</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Nous devons ensuite mettre à jour la valeur de mMouvement, qui sera la 
distance parcourue par la caméra si une direction est choisie. Comme le 
nombre d'images par seconde est variable, nous utilisons la propriété 
timeSinceLastFrame de l'événement, multiplié par la vitesse de la 
caméra. Le produit de la vitesse par le temps écoulé nous donne donc la 
distance parcourue.<br>
<br>
J'ai aussi créé un vecteur dans lequel nous allons enregistrer les 
déplacement à effectuer. En effet, on peut utiliser plusieurs touches en
 même temps, il faut donc additionner les directions demandées, et les 
conserver pour déplacer la caméra en une seule fois.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">Vector3</span> <span class="n">deplacement</span> <span class="o">=</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Vector3</span><span class="o">::</span><span class="n">ZERO</span><span class="p">;</span>
<span class="n">mMouvement</span> <span class="o">=</span> <span class="n">mVitesse</span> <span class="o">*</span> <span class="n">evt</span><span class="p">.</span><span class="n">timeSinceLastFrame</span><span class="p">;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Nous allons utiliser les flèches du clavier et les touches Z, S, Q, D 
pour nous déplacer ; j'ai aussi implémenté les touches fléchées, qui 
sont une configuration alternative pour le déplacement. Il faut donc 
vérifier si les touches qui nous intéressent sont enfoncées :<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="syntax"><pre><span class="k">if</span><span class="p">(</span><span class="n">mKeyboard</span><span class="o">-&gt;</span><span class="n">isKeyDown</span><span class="p">(</span><span class="n">OIS</span><span class="o">::</span><span class="n">KC_LEFT</span><span class="p">)</span> <span class="o">||</span> <span class="n">mKeyboard</span><span class="o">-&gt;</span><span class="n">isKeyDown</span><span class="p">(</span><span class="n">OIS</span><span class="o">::</span><span class="n">KC_A</span><span class="p">))</span> <span class="c1">// La touche A d'un clavier QWERTY correspond au Q sur un AZERTY</span>
    <span class="n">deplacement</span><span class="p">.</span><span class="n">x</span> <span class="o">-=</span> <span class="n">mMouvement</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="n">mKeyboard</span><span class="o">-&gt;</span><span class="n">isKeyDown</span><span class="p">(</span><span class="n">OIS</span><span class="o">::</span><span class="n">KC_RIGHT</span><span class="p">)</span> <span class="o">||</span> <span class="n">mKeyboard</span><span class="o">-&gt;</span><span class="n">isKeyDown</span><span class="p">(</span><span class="n">OIS</span><span class="o">::</span><span class="n">KC_D</span><span class="p">))</span>
    <span class="n">deplacement</span><span class="p">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">mMouvement</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="n">mKeyboard</span><span class="o">-&gt;</span><span class="n">isKeyDown</span><span class="p">(</span><span class="n">OIS</span><span class="o">::</span><span class="n">KC_UP</span><span class="p">)</span> <span class="o">||</span> <span class="n">mKeyboard</span><span class="o">-&gt;</span><span class="n">isKeyDown</span><span class="p">(</span><span class="n">OIS</span><span class="o">::</span><span class="n">KC_W</span><span class="p">))</span> <span class="c1">// W correspond au Z du AZERTY</span>
    <span class="n">deplacement</span><span class="p">.</span><span class="n">z</span> <span class="o">-=</span> <span class="n">mMouvement</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="n">mKeyboard</span><span class="o">-&gt;</span><span class="n">isKeyDown</span><span class="p">(</span><span class="n">OIS</span><span class="o">::</span><span class="n">KC_DOWN</span><span class="p">)</span> <span class="o">||</span> <span class="n">mKeyboard</span><span class="o">-&gt;</span><span class="n">isKeyDown</span><span class="p">(</span><span class="n">OIS</span><span class="o">::</span><span class="n">KC_S</span><span class="p">))</span>
    <span class="n">deplacement</span><span class="p">.</span><span class="n">z</span> <span class="o">+=</span> <span class="n">mMouvement</span><span class="p">;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<div class="rmq attention">Attention aux signes ! Vous devez respecter ce que nous avons vu dans le chapitre sur les déplacements !</div><br>
<br>
Le déplacement de la caméra fonctionne, il ne manque plus que la 
rotation de celle-ci. Il nous suffit pour cela de récupérer le 
déplacement relatif depuis la dernière fois que la souris a bougé 
(depuis le dernier appel à frameRenderingQueued() donc).<br>
<br>
Pour retrouver cette valeur, on passe successivement par les attributs suivants :<br>
<ul>	
<li>le mouseState contenu dans l'objet souris, contenant diverses informations sur l'état de la souris ;</li>	
<li>l'axe que l'on désire observer : ici, ce sera X ou Y pour le yaw ou le pitch ;</li>	
<li>le déplacement relatif de la souris suivant cet axe.</li>
</ul><br>
<br>
Maintenant, occupons-nous du mouvement de la souris. Pour récupérer le 
déplacement de celle-ci, nous devons récupérer son état, comme indiqué 
dans le code suivant.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="k">const</span> <span class="n">OIS</span><span class="o">::</span><span class="n">MouseState</span> <span class="o">&amp;</span><span class="n">mouseState</span> <span class="o">=</span> <span class="n">mMouse</span><span class="o">-&gt;</span><span class="n">getMouseState</span><span class="p">();</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
À partir de cette référence on peut notamment récupérer le déplacement 
de la souris depuis la dernière image, en appelant l'axe X ou Y puis 
l'attribut rel.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mRotationX</span> <span class="o">=</span> <span class="n">Degree</span><span class="p">(</span><span class="o">-</span><span class="n">mouseState</span><span class="p">.</span><span class="n">Y</span><span class="p">.</span><span class="n">rel</span> <span class="o">*</span> <span class="n">mVitesseRotation</span><span class="p">);</span>
<span class="n">mRotationY</span> <span class="o">=</span> <span class="n">Degree</span><span class="p">(</span><span class="o">-</span><span class="n">mouseState</span><span class="p">.</span><span class="n">X</span><span class="p">.</span><span class="n">rel</span> <span class="o">*</span> <span class="n">mVitesseRotation</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Il faut particulièrement faire attention aux axes et aux signes ici. Je 
considère que mRotationX (respectivement mRotationY) correspond à la 
rotation autour de l'axe X (respectivement Y), c'est-à-dire lorsque je 
déplace ma souris en avant ou en arrière (respectivement à gauche ou à 
droite). Or, le déplacement vers l'avant ou l'arrière de la souris 
correspond à son axe Y, c'est pour ça que je demande l'axe Y de la 
souris pour trouver la rotation autour de X dans l'espace 3D.<br>
<br>
On rajoute une multiplication par la vitesse de rotation voulue et on 
convertit le tout en degrés, sinon le mouvement est bien trop rapide.<br>
<br>
Enfin, on appelle les méthodes de rotation et de déplacement de la caméra :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">yaw</span><span class="p">(</span><span class="n">mRotationY</span><span class="p">);</span>
<span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">pitch</span><span class="p">(</span><span class="n">mRotationX</span><span class="p">);</span>
<span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">moveRelative</span><span class="p">(</span><span class="n">deplacement</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
La dernière ligne, comme vous le remarquez, déplace la caméra par 
rapport à son repère local, ce qui évite de faire la transformation de 
la variable <span class="italique">deplacement</span> à la main. Il est aussi possible de demander un déplacement par rapport au repère absolu avec Camera::move().<br>
<br>
<h4>Et avec un nœud de scène ?</h4><br>
<br>
J'en profite pour vous montrer comment on aurait procédé pour déplacer 
un nœud de scène par exemple, qui utilise la méthode translate().<br>
<br>
Les deux lignes suivantes sont équivalentes : <br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">node</span><span class="o">-&gt;</span><span class="n">translate</span><span class="p">(</span><span class="n">deplacement</span><span class="p">,</span> <span class="n">TS_LOCAL</span><span class="p">);</span>
<span class="n">node</span><span class="o">-&gt;</span><span class="n">translate</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">getOrientation</span><span class="p">()</span> <span class="o">*</span> <span class="n">deplacement</span><span class="p">,</span> <span class="n">TS_PARENT</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
La première ligne est très similaire à celle utilisée pour la caméra, il
 suffit de préciser que l'on se déplace par rapport au repère local du 
nœud de scène.<br>
<br>
La seconde solution indique un déplacement relatif au nœud parent, mais 
utilise le quaternion retourné par la méthode getOrientation() multiplié
 par le vecteur de déplacement pour obtenir la direction souhaitée dans 
ce repère. En pratique, on utilisera seulement la première ligne, plus 
courte et plus propre dans le code.<br>
<br>
<h3>Mini-TP : créer un interrupteur</h3><br>
<br>
Pour gérer un événement qui ne doit arriver qu'une fois lorsque la 
touche est appuyée, il y a une précaution supplémentaire à prendre. Je 
vous ai dit plus haut que votre ordinateur ne retenait pas l'état dans 
lequel se trouvait votre clavier ou votre souris à l'image précédente. 
Cependant, rien ne nous empêche de le faire nous-mêmes !<br>
<br>
Je vous propose d'écrire ces lignes de code vous-mêmes, avec quelques indications.<br>
<br>
Disons que l'on veut utiliser la touche T pour allumer et éteindre la 
lumière de notre scène. Il va donc falloir vérifier à chaque image si la
 touche T est enfoncée, et si en plus ce n'était pas déjà le cas à 
l'image précédente. Pour cela, on utilisera l'attribut mToucheAppuyee de
 notre classe InputListener.<br>
<br>
Un indice : le SceneManager possède une méthode getLight() qui permet de
 récupérer un pointeur sur une lumière à partir du nom de celle-ci...  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/siffle.png" alt=":-°"> <br>
<br>
À vos claviers ! La réponse se trouve juste après.<br>
<br>
<span class="spoiler_hidden">Secret <a href="#" onclick="switch_spoiler_hidden(this); return false;">(cliquez pour afficher)</a></span><div class="spoiler2_hidden"><div class="spoiler3_hidden"><br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">bool</span> <span class="n">etatTouche</span> <span class="o">=</span> <span class="n">mKeyboard</span><span class="o">-&gt;</span><span class="n">isKeyDown</span><span class="p">(</span><span class="n">OIS</span><span class="o">::</span><span class="n">KC_T</span><span class="p">);</span>

<span class="k">if</span><span class="p">(</span><span class="n">etatTouche</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">mToucheAppuyee</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">Light</span> <span class="o">*</span><span class="n">light</span> <span class="o">=</span> <span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">getLight</span><span class="p">(</span><span class="s">"lumiere1"</span><span class="p">);</span>
    <span class="n">light</span><span class="o">-&gt;</span><span class="n">setVisible</span><span class="p">(</span><span class="o">!</span><span class="n">light</span><span class="o">-&gt;</span><span class="n">isVisible</span><span class="p">());</span>
<span class="p">}</span>
<span class="n">mToucheAppuyee</span> <span class="o">=</span> <span class="n">etatTouche</span><span class="p">;</span>
</pre></div>
</td></tr></tbody></table></div><br>
</div></div><br>
<br>
Vous avez réussi ? Si oui c'est très bien, si non, voyons ensemble le raisonnement.<br>
<br>
Tout d'abord, je récupère l'état actuel de ma touche T dans une variable
 locale. Je vérifie si la touche est actuellement enfoncée et si elle ne
 l'était pas déjà à l'aide de l'attribut mToucheAppuyee. Si ma condition
 est vérifiée, je récupère ma lumière, et je change son état (visible ou
 non).<br>
<br>
Enfin, j'enregistre l'état actuel de ma touche T dans mToucheAppuyee, en
 prévision de la prochaine image ! Si je ne faisais pas ça, j'aurais 
toujours la même valeur pour mon booléen, ce qui n'est pas très utile.  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/smile.png" alt=":)">
		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_425387">Avec buffer, c'est plus simple ?</h2>
		<div class="ss_part_texte">
		C'est bien beau cette méthode pour retenir si les touches viennent ou 
non d'être appuyées, mais comment va-t-on faire si l'on veut surveiller 
l'état de quinze touches différentes ? Je ne sais pas vous, mais je n'ai
 pas envie de m'embêter à créer quinze variables pour garder une trace 
de tout ce beau monde, je suis un peu flemmard.  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/siffle.png" alt=":-°"> <br>
<br>
Heureusement, OIS a pensé à tout, nous allons donc voir une autre façon 
de faire ce que l'on vient juste d'écrire. On va commencer comme 
précédemment par le déplacement de la caméra, puis on verra comment 
gérer notre interrupteur.<br>
<br>
<h3>Mise en place</h3><br>
<br>
Nous allons commencer par activer l'utilisation du buffer pour la souris
 et le clavier lors de la construction de notre frame listener. Il 
suffit donc de mettre les paramètres correspondants à <span class="code2 cpp"><span class="kc">true</span></span>.<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">void</span> <span class="n">PremiereApplication</span><span class="o">::</span><span class="n">createFrameListener</span><span class="p">()</span>
<span class="p">{</span>
<span class="ln-xtra">    <span class="n">mFrameListener</span><span class="o">=</span> <span class="k">new</span> <span class="n">InputListener</span><span class="p">(</span><span class="n">mWindow</span><span class="p">,</span> <span class="n">mCamera</span><span class="p">,</span> <span class="n">mSceneMgr</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span></span>
    <span class="n">mRoot</span><span class="o">-&gt;</span><span class="n">addFrameListener</span><span class="p">(</span><span class="n">mFrameListener</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<div class="rmq question">C'est tout ?</div><br>
<br>
Quasiment, il va simplement falloir rajouter deux petites lignes dans le constructeur pour que tout soit prêt.<br>
<br>
Afin d'utiliser le buffer, il faut fournir un objet (un « écouteur » 
dérivant d'une des classes OIS::***Listener selon le périphérique à 
écouter) qui sera celui qui recevra les événements du type <span class="italique">"cette touche vient d'être appuyée, que dois-je faire ?"</span>. Pour cela, OIS fournit une méthode pour chacun de trois périphériques d'entrée (clavier, souris, joystick) :<br>
<br>
<ul>	
<li><span class="code2 cpp"><span class="k">virtual</span> <span class="kt">void</span> <span class="n">OIS</span><span class="o">::</span><span class="n">Mouse</span><span class="o">::</span><span class="n">setEventCallback</span><span class="p">(</span><span class="n">OIS</span><span class="o">::</span><span class="n">MouseListener</span><span class="o">*</span> <span class="n">mouseListener</span><span class="p">);</span></span></li>	
<li><span class="code2 cpp"><span class="k">virtual</span> <span class="kt">void</span> <span class="n">OIS</span><span class="o">::</span><span class="n">Keyboard</span><span class="o">::</span><span class="n">setEventCallback</span><span class="p">(</span><span class="n">OIS</span><span class="o">::</span><span class="n">KeyListener</span><span class="o">*</span> <span class="n">keyListener</span><span class="p">);</span></span></li>	
<li><span class="code2 cpp"><span class="k">virtual</span> <span class="kt">void</span> <span class="n">OIS</span><span class="o">::</span><span class="n">JoyStick</span><span class="o">::</span><span class="n">setEventCallback</span><span class="p">(</span><span class="n">OIS</span><span class="o">::</span><span class="n">JoyStickListener</span><span class="o">*</span> <span class="n">joystickListener</span><span class="p">);</span></span></li>
</ul><br>
<br>
Cette méthode prend donc en paramètre un pointeur sur un listener du 
périphérique que vous voulez utiliser. Nous allons donc rajouter deux 
classes mères de notre InputListener : OIS::MouseListener et 
OIS::KeyListener. Modifiez donc la déclaration de la classe 
InputListener :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="k">class</span> <span class="nc">InputListener</span> <span class="o">:</span> <span class="k">public</span> <span class="n">ExampleFrameListener</span><span class="p">,</span> <span class="n">OIS</span><span class="o">::</span><span class="n">KeyListener</span><span class="p">,</span> <span class="n">OIS</span><span class="o">::</span><span class="n">MouseListener</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Dans le constructeur, vous pouvez maintenant insérer les deux lignes 
suivantes (mMouse et mKeyboard sont déclarées dans ExampleFrameListener)
 :<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mMouse</span><span class="o">-&gt;</span><span class="n">setEventCallback</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="n">mKeyboard</span><span class="o">-&gt;</span><span class="n">setEventCallback</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<div class="rmq attention">Vous ne pouvez enregistrer qu'un seul 
écouteur par périphérique d'entrée. En cas d'appels multiples à la 
méthode setEventCallback(), c'est le dernier appel qui définit 
l'écouteur à utiliser. Pour que différents objets reçoivent les 
événements, il faudra donc les redistribuer à partir de l'écouteur 
receveur.</div><br>
<br>
Au chapitre des modifications, supprimez les anciens attributs d'InputListener et mettez ceux-ci :<br>
<br>
<span class="code">Code : C++ - InputListener.h - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="syntax"><pre><span class="k">private</span><span class="o">:</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">SceneManager</span> <span class="o">*</span><span class="n">mSceneMgr</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">mContinuer</span><span class="p">;</span>

    <span class="n">Ogre</span><span class="o">::</span><span class="n">Vector3</span> <span class="n">mMouvement</span><span class="p">;</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">mVitesse</span><span class="p">;</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">mVitesseRotation</span><span class="p">;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
En initialisant ces attributs, votre constructeur devrait maintenant ressembler à ceci :<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">InputListener</span><span class="p">(</span><span class="n">RenderWindow</span><span class="o">*</span> <span class="n">win</span><span class="p">,</span> <span class="n">Camera</span><span class="o">*</span> <span class="n">cam</span><span class="p">,</span> <span class="n">SceneManager</span> <span class="o">*</span><span class="n">sceneMgr</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">bufferedKeys</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">bufferedMouse</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">bufferedJoy</span> <span class="o">=</span> <span class="kc">false</span> <span class="p">)</span> 
   <span class="o">:</span> <span class="n">ExampleFrameListener</span><span class="p">(</span><span class="n">win</span><span class="p">,</span> <span class="n">cam</span><span class="p">,</span> <span class="n">bufferedKeys</span><span class="p">,</span> <span class="n">bufferedMouse</span><span class="p">,</span> <span class="n">bufferedJoy</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">mSceneMgr</span> <span class="o">=</span> <span class="n">sceneMgr</span><span class="p">;</span>
    <span class="n">mContinuer</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

    <span class="n">mMouvement</span> <span class="o">=</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Vector3</span><span class="o">::</span><span class="n">ZERO</span><span class="p">;</span>
    <span class="n">mVitesse</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
    <span class="n">mVitesseRotation</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">;</span>

    <span class="n">mMouse</span><span class="o">-&gt;</span><span class="n">setEventCallback</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">mKeyboard</span><span class="o">-&gt;</span><span class="n">setEventCallback</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
L'attribut mContinuer permettra d'enregistrer l'appui sur la touche 
Echap, mMouvement sera le vecteur de la direction dans laquelle on doit 
se déplacer et mVitesseRotation un facteur multiplicatif permettant 
d'ajuster la vitesse de rotation de la caméra.<br>
<br>
On met donc à jour la valeur de retour de la méthode frameRenderingQueued().<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">bool</span> <span class="n">InputListener</span><span class="o">::</span><span class="n">frameRenderingQueued</span><span class="p">(</span><span class="k">const</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">FrameEvent</span><span class="o">&amp;</span> <span class="n">evt</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">mMouse</span><span class="p">)</span>
        <span class="n">mMouse</span><span class="o">-&gt;</span><span class="n">capture</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">mKeyboard</span><span class="p">)</span>
        <span class="n">mKeyboard</span><span class="o">-&gt;</span><span class="n">capture</span><span class="p">();</span>
    
<span class="ln-xtra">    <span class="k">return</span> <span class="n">mContinuer</span><span class="p">;</span></span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Enfin, il y a des méthodes virtuelles pures à réimplémenter dans notre 
classe. Ces méthodes seront appelées lors de l'événement correspondant 
sur le clavier (touche enfoncée ou relâchée) ou sur la souris (bouton 
appuyé ou relâché, déplacement). De même que les méthodes des frame 
listeners d'Ogre, elles renvoient un booléen que l'on utilisera pour 
savoir si l'on doit interrompre le programme.<br>
<br>
Ajoutons donc les prototypes dans notre header et un simple retour de valeur dans le corps des méthodes pour commencer.<br>
<br>
<div class="rmq information">Contrairement aux méthodes des frame 
listeners, la valeur de retour ne détermine pas si l'on doit continuer 
ou non l'exécution. C'est pour cela que l'on devra passer par l'attribut
 mContinuer pour surveiller l'appui sur la touche Echap.</div><br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">bool</span> <span class="n">InputListener</span><span class="o">::</span><span class="n">mouseMoved</span><span class="p">(</span><span class="k">const</span> <span class="n">OIS</span><span class="o">::</span><span class="n">MouseEvent</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">bool</span> <span class="n">InputListener</span><span class="o">::</span><span class="n">mousePressed</span><span class="p">(</span><span class="k">const</span> <span class="n">OIS</span><span class="o">::</span><span class="n">MouseEvent</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">,</span> <span class="n">OIS</span><span class="o">::</span><span class="n">MouseButtonID</span> <span class="n">id</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span> 
<span class="p">}</span>
<span class="kt">bool</span> <span class="n">InputListener</span><span class="o">::</span><span class="n">mouseReleased</span><span class="p">(</span><span class="k">const</span> <span class="n">OIS</span><span class="o">::</span><span class="n">MouseEvent</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">,</span> <span class="n">OIS</span><span class="o">::</span><span class="n">MouseButtonID</span> <span class="n">id</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
 
<span class="kt">bool</span> <span class="n">InputListener</span><span class="o">::</span><span class="n">keyPressed</span><span class="p">(</span><span class="k">const</span> <span class="n">OIS</span><span class="o">::</span><span class="n">KeyEvent</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">bool</span> <span class="n">InputListener</span><span class="o">::</span><span class="n">keyReleased</span><span class="p">(</span><span class="k">const</span> <span class="n">OIS</span><span class="o">::</span><span class="n">KeyEvent</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
On commence par implémenter la touche Echap. Si elle est appuyée, on passe simplement l'attribut mContinuer à <span class="code2 cpp"><span class="kc">false</span></span>.<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">bool</span> <span class="n">InputListener</span><span class="o">::</span><span class="n">keyPressed</span><span class="p">(</span><span class="k">const</span> <span class="n">OIS</span><span class="o">::</span><span class="n">KeyEvent</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">switch</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">key</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="k">case</span> <span class="n">OIS</span><span class="o">::</span><span class="nl">KC_ESCAPE:</span>
        <span class="n">mContinuer</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">mContinuer</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
On gère ensuite l'appui sur les touches de déplacement en modifiant les 
composantes de mMouvement en fonction de la touche. On va aussi 
multiplier la vitesse de déplacement par deux lorsque l'on appuie sur la
 touche majuscule gauche.<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">bool</span> <span class="n">InputListener</span><span class="o">::</span><span class="n">keyPressed</span><span class="p">(</span><span class="k">const</span> <span class="n">OIS</span><span class="o">::</span><span class="n">KeyEvent</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">switch</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">key</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="k">case</span> <span class="n">OIS</span><span class="o">::</span><span class="nl">KC_ESCAPE:</span>
        <span class="n">mContinuer</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">OIS</span><span class="o">::</span><span class="nl">KC_W:</span>
        <span class="n">mMouvement</span><span class="p">.</span><span class="n">z</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">OIS</span><span class="o">::</span><span class="nl">KC_S:</span>
        <span class="n">mMouvement</span><span class="p">.</span><span class="n">z</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">OIS</span><span class="o">::</span><span class="nl">KC_A:</span>
        <span class="n">mMouvement</span><span class="p">.</span><span class="n">x</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">OIS</span><span class="o">::</span><span class="nl">KC_D:</span>
        <span class="n">mMouvement</span><span class="p">.</span><span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">OIS</span><span class="o">::</span><span class="nl">KC_LSHIFT:</span>
        <span class="n">mVitesse</span> <span class="o">*=</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">mContinuer</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Enfin, dans la méthode keyReleased, on va « retirer » la composante que 
l'on ajoute lors de l'appui sur une touche. Le code est donc semblable, 
seuls les signes changent.<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">bool</span> <span class="n">InputListener</span><span class="o">::</span><span class="n">keyReleased</span><span class="p">(</span><span class="k">const</span> <span class="n">OIS</span><span class="o">::</span><span class="n">KeyEvent</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">switch</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">key</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="k">case</span> <span class="n">OIS</span><span class="o">::</span><span class="nl">KC_W:</span>
        <span class="n">mMouvement</span><span class="p">.</span><span class="n">z</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">OIS</span><span class="o">::</span><span class="nl">KC_S:</span>
        <span class="n">mMouvement</span><span class="p">.</span><span class="n">z</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">OIS</span><span class="o">::</span><span class="nl">KC_A:</span>
        <span class="n">mMouvement</span><span class="p">.</span><span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">OIS</span><span class="o">::</span><span class="nl">KC_D:</span>
        <span class="n">mMouvement</span><span class="p">.</span><span class="n">x</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">OIS</span><span class="o">::</span><span class="nl">KC_LSHIFT:</span>
        <span class="n">mVitesse</span> <span class="o">/=</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Maintenant que l'on gère correctement l'évolution de nos variables de 
mouvement et de vitesse de déplacement, il faut écrire le déplacement de
 la caméra dans la méthode frameRenderingQueued().<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="syntax"><pre><span class="k">virtual</span> <span class="kt">bool</span> <span class="n">frameRenderingQueued</span><span class="p">(</span><span class="k">const</span> <span class="n">FrameEvent</span><span class="o">&amp;</span> <span class="n">evt</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">mMouse</span><span class="p">)</span>
        <span class="n">mMouse</span><span class="o">-&gt;</span><span class="n">capture</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">mKeyboard</span><span class="p">)</span>
        <span class="n">mKeyboard</span><span class="o">-&gt;</span><span class="n">capture</span><span class="p">();</span>

<span class="ln-xtra">    <span class="n">Ogre</span><span class="o">::</span><span class="n">Vector3</span> <span class="n">deplacement</span> <span class="o">=</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Vector3</span><span class="o">::</span><span class="n">ZERO</span><span class="p">;</span></span>
<span class="ln-xtra">    <span class="n">deplacement</span> <span class="o">=</span> <span class="n">mMouvement</span> <span class="o">*</span> <span class="n">mVitesse</span> <span class="o">*</span> <span class="n">evt</span><span class="p">.</span><span class="n">timeSinceLastFrame</span><span class="p">;</span></span>
<span class="ln-xtra">    <span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">moveRelative</span><span class="p">(</span><span class="n">deplacement</span><span class="p">);</span></span>

    <span class="k">return</span> <span class="n">mContinuer</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<br>
<br>
Pour la rotation de la caméra, tout se passe dans la méthode 
mouseMoved(), dont l'événement reçu en paramètre contient l'état de la 
souris, permettant comme précédemment de retrouver le déplacement 
relatif de la souris.<br>
<br>
On multiplie cette valeur relative par la vitesse de rotation, on fait attention aux signes, et voici ce qu'on obtient :<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">bool</span> <span class="n">InputListener</span><span class="o">::</span><span class="n">mouseMoved</span><span class="p">(</span><span class="k">const</span> <span class="n">OIS</span><span class="o">::</span><span class="n">MouseEvent</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">yaw</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Degree</span><span class="p">(</span><span class="o">-</span><span class="n">mVitesseRotation</span> <span class="o">*</span> <span class="n">e</span><span class="p">.</span><span class="n">state</span><span class="p">.</span><span class="n">X</span><span class="p">.</span><span class="n">rel</span><span class="p">));</span>
    <span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">pitch</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Degree</span><span class="p">(</span><span class="o">-</span><span class="n">mVitesseRotation</span> <span class="o">*</span> <span class="n">e</span><span class="p">.</span><span class="n">state</span><span class="p">.</span><span class="n">Y</span><span class="p">.</span><span class="n">rel</span><span class="p">));</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<br>
Vous pouvez maintenant compiler et exécuter votre application ; les 
commandes de déplacement sont maintenant gérées entièrement par notre 
classe InputListener, n'hésitez donc pas à adapter les variables 
initialisées dans le constructeur si vous voulez accélérer ou ralentir 
les mouvements par exemple.<br>
<br>
<br>
Cette méthode de gestion des entrées permet donc de gérer plus 
facilement l'appui ponctuel sur une touche, tout en conservant une 
gestion simple des touches qui peuvent rester enfoncées (pour le 
déplacement ici).<br>
<br>
Gardez cependant bien à l'esprit, comme je l'ai précisé au début, qu'il 
ne peut y avoir qu'un seul écouteur par périphérique d'entrée et qu'il 
faudra donc penser à rapporter l'appui sur les touches à des écouteurs 
annexes lorsque votre application grossira, sinon vous allez vite vous 
retrouver avec un code lourd et mal organisé.<br>
Mais vous êtes déjà des programmeurs avisés et bien organisés, vous 
n'aurez donc pas de problème pour appliquer ces quelques conseils, j'en 
suis certain. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/clin.png" alt=";)" class="smilies">
		</div>
		<hr>
		
	<div id="chap_conclusion">
	Dans ce chapitre, nous avons vu comment gérer nous-mêmes les entrées de
 l'utilisateur avec la bibliothèque OIS, ainsi que le principe des frame
 listeners, qui nous ont ici été bien utiles alors que nous n'avons pas 
encore vu le fonctionnement de la boucle de rendu.<br>
<br>
Le prochain chapitre promet d'être intéressant : nous allons en effet 
utiliser le module de terrain d'Ogre qui a été refait dans la version 
1.7 et qui offre une gestion beaucoup plus optimisée des terrains par 
rapport aux versions précédentes. Je n'en dis pas plus, on se retrouve 
de l'autre côté.
	</div>
	
	<hr>
	<h1 id="chap_425394">Gardez les pieds sur terre !</h1>
	<div id="chap_intro">
	Lorsque l'on réalise un environnement 3D, l'une des composantes 
récurrentes de la scène est sans aucun doute le terrain environnant 
accompagné du ciel au-dessus de nos têtes (pour les extérieurs, en tout 
cas).<br>
<br>
Sans outil particulier, créer un terrain pourrait relever d'un travail 
de longue haleine si l'on devait créer le mesh dans les moindres détails
 pour l'insérer ensuite à la scène. La gestion d'une telle entité serait
 aussi relativement complexe, puisqu'il doit pouvoir interagir avec tous
 les objets susceptibles de se déplacer dans la scène.<br>
<br>
Heureusement, plutôt que de placer notre terrain comme une simple entité
 dans la scène, Ogre propose de passer par une classe Terrain qui, comme
 son nom l'indique si bien, permet de gérer des terrains dans la scène.<br>
<br>
Comme je le disais, le terrain n'est généralement pas seul et le ciel 
joue un rôle important pour le réalisme de la scène. Là encore, quelques
 outils bienvenus offrent différentes solutions pour obtenir un résultat
 convaincant.
	</div>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_425396">Créer un terrain</h2>
		<div class="ss_part_texte">
		<h3>Préparation</h3><br>
<br>
Avant de commencer, il va falloir modifier un peu notre projet avec de 
nouvelles dépendances pour que les terrains soient utilisables.<br>
<br>
Dans l'éditeur de lien, ajoutez le fichier librairie <span class="courrier">OgreTerrain.lib</span> (ou bien <span class="courrier">OgreTerrain_d.lib</span> si vous compilez en debug).<br>
<br>
Il faut maintenant ajouter un fichier en-tête dans notre classe :<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="cp">#include &lt;Ogre/Terrain/OgreTerrain.h&gt;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Enfin, si vous ne les avez pas déjà placées dans le répertoire de votre 
exécutable, copiez ces 2 DLL dans le dossier correspondant à votre 
configuration (les DLL de debug se terminent aussi par « _d ») :<br>
<ul>	
<li>OgreTerrain.dll</li>	
<li>OgrePaging.dll</li>
</ul><br>
<br>
<h3>Quelques paramètres à régler</h3><br>
<br>
Commençons par ajouter deux attributs dans notre classe 
PremiereApplication. Un objet Terrain, qui gérera les propriétés de 
notre terrain, puis un objet TerrainGlobalOptions, qui définit des 
propriétés générales pour les terrains dans notre application, notamment
 l'éclairage.<br>
<br>
<div class="rmq attention">La présence de cet objet TerrainGlobalOptions
  est obligatoire lorsque vous voulez utiliser les terrains dans votre 
scène, sous peine d'erreur à l'exécution. </div><br>
<br>
<span class="code">Code : C++ - PremiereApplication.h - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">Terrain</span> <span class="o">*</span><span class="n">mTerrain</span><span class="p">;</span>
<span class="n">Ogre</span><span class="o">::</span><span class="n">TerrainGlobalOptions</span> <span class="o">*</span><span class="n">mGlobals</span><span class="p">;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Au début de la méthode createScene(), nous allons régler quelques 
paramètres pour que notre terrain apparaisse sous son meilleur jour.<br>
<br>
Premièrement, je vous conseille d'augmenter la distance de vue de la caméra et de la positionner en hauteur :<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">setFarClipDistance</span><span class="p">(</span><span class="mi">20000</span><span class="p">);</span>
<span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">setPosition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Il est aussi possible de régler la distance de vue à l'infini, en 
mettant 0 comme paramètre. Cependant, cela dépend de votre machine, il 
faut donc vérifier si vous pouvez vous le permettre avant de 
l'appliquer.<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="k">if</span> <span class="p">(</span><span class="n">mRoot</span><span class="o">-&gt;</span><span class="n">getRenderSystem</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">getCapabilities</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">hasCapability</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">RSC_INFINITE_FAR_PLANE</span><span class="p">))</span>
    <span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">setFarClipDistance</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
On peut ensuite définir un éclairage d'ambiance particulier pour le 
terrain dans Ogre, plutôt que de le gérer de façon distincte. Pour cela,
 il suffit de définir une lumière directionnelle avec les paramètres qui
 vous paraissent adaptés à votre environnement. J'ai ajouté cette 
lumière en tant qu'attribut de ma classe, car je l'utiliserai dans une 
autre fonction.<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">Vector3</span> <span class="n">lightdir</span><span class="p">(</span><span class="mf">0.55f</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3f</span><span class="p">,</span> <span class="mf">0.75f</span><span class="p">);</span>
<span class="n">mLight</span> <span class="o">=</span> <span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">createLight</span><span class="p">(</span><span class="s">"terrainLight"</span><span class="p">);</span>
<span class="n">mLight</span><span class="o">-&gt;</span><span class="n">setType</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Light</span><span class="o">::</span><span class="n">LT_DIRECTIONAL</span><span class="p">);</span>
<span class="n">mLight</span><span class="o">-&gt;</span><span class="n">setDirection</span><span class="p">(</span><span class="n">lightdir</span><span class="p">);</span>
<span class="n">mLight</span><span class="o">-&gt;</span><span class="n">setDiffuseColour</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">ColourValue</span><span class="o">::</span><span class="n">White</span><span class="p">);</span>
<span class="n">mLight</span><span class="o">-&gt;</span><span class="n">setSpecularColour</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">ColourValue</span><span class="p">(</span><span class="mf">0.4f</span><span class="p">,</span> <span class="mf">0.4f</span><span class="p">,</span> <span class="mf">0.4f</span><span class="p">));</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Pour garder un peu d'ordre dans le code, nous allons définir une méthode
 createTerrain(), qui sera appelée dans createScene() et qui prendra en 
charge toute l'initialisation du terrain.<br>
<br>
À l'intérieur de celle-ci, commencez par créer le TerrainGlobalOptions :<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">void</span> <span class="n">PremiereApplication</span><span class="o">::</span><span class="n">createTerrain</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">mGlobals</span> <span class="o">=</span> <span class="n">OGRE_NEW</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">TerrainGlobalOptions</span><span class="p">();</span>
    <span class="n">mGlobals</span><span class="o">-&gt;</span><span class="n">setMaxPixelError</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<div class="rmq question">Doucement, d'où il sort ce OGRE_NEW ? Pourquoi tu n'utilises pas tout simplement <span class="code2 cpp"><span class="k">new</span></span> pour créer ton objet ?</div><br>
<br>
C'est en effet le premier objet d'Ogre que nous allons créer nous-mêmes, sans passer par l'intermédiaire du Scene Manager.<br>
Le moteur fournit différentes macros pour allouer l'espace en mémoire 
lorsque vous instanciez une classe d'Ogre. De façon générale, les 
développeurs conseillent d'utiliser ces macros lorsque vous devez faire 
de l'allocation dynamique sur les objets du moteur qui dérivent de 
Ogre::AllocatedObject. Vous pouvez voir la hiérarchie des classes dans <a href="http://www.ogre3d.org/docs/api/html/hierarchy.html">la documentation</a>.<br>
En ce qui concerne la destruction des objets, l'utilisation de 
l'opérateur OGRE_NEW implique l'utilisation de l'opérateur OGRE_DELETE 
pour libérer l'espace mémoire.<br>
<br>
La seconde ligne appelle la méthode setMaxPixelError() qui donne la 
précision avec laquelle le terrain est rendu. La valeur indiquée est 
l'erreur tolérée, en pixels, pour l'affichage du terrain. Plus la valeur
 est faible, plus le terrain correspond au modèle donné, plus elle est 
forte et plus il sera imprécis, en donnant l'impression d'un terrain 
nivelé.<br>
<br>
<br>
On applique maintenant les réglages concernant l'éclairage à nos options globales.<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mGlobals</span><span class="o">-&gt;</span><span class="n">setLightMapDirection</span><span class="p">(</span><span class="n">mLight</span><span class="o">-&gt;</span><span class="n">getDerivedDirection</span><span class="p">());</span>
<span class="n">mGlobals</span><span class="o">-&gt;</span><span class="n">setCompositeMapDistance</span><span class="p">(</span><span class="mi">3000</span><span class="p">);</span>
<span class="n">mGlobals</span><span class="o">-&gt;</span><span class="n">setCompositeMapAmbient</span><span class="p">(</span><span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">getAmbientLight</span><span class="p">());</span>
<span class="n">mGlobals</span><span class="o">-&gt;</span><span class="n">setCompositeMapDiffuse</span><span class="p">(</span><span class="n">mLight</span><span class="o">-&gt;</span><span class="n">getDiffuseColour</span><span class="p">());</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<h3>Le terrain</h3><br>
<br>
Maintenant, passons à la création du terrain lui-même. Comme pour les 
options du terrain, nous ne passons pas par une méthode du Scene Manager
 pour créer le terrain, mais par le constructeur de la classe, qui prend
 tout de même en paramètre le Scene Manager de votre scène.<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mTerrain</span> <span class="o">=</span> <span class="n">OGRE_NEW</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Terrain</span><span class="p">(</span><span class="n">mSceneMgr</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Il faut à présent définir précisément les paramètres de notre terrain : son relief, sa taille et ses textures.<br>
<br>
<div class="rmq question">Comment est-ce que je vais définir le relief 
de mon terrain ? Je veux bien le modéliser sous Blender, mais je suis 
pas très fort en modélisation... Et je ne me vois pas coder tout avec 
Ogre. Tu n'as pas une recette magique sous le coude ?  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/magicien.png" alt=":magicien:" class="smilies"> </div><br>
<br>
Il suffit de demander ! Il est temps que je vous parle des heightmaps !<br>
<br>
<h4>Les heightmaps</h4><br>
<br>
Une heightmap, qu'est-ce que c'est ?<br>
<br>
En traduisant littéralement, ou pourrait appeler ça une « carte du 
relief » ou « carte de l'altitude ». En d'autre termes, c'est une image 
qui contient des informations de relief.<br>
<br>
On les utilise pour stocker le relief d'un terrain, mais aussi pour 
connaitre le relief d'une texture, afin de donner l'impression de relief
 sur un mesh alors qu'en réalité il est plat ou simplement lisse (c'est 
le principe du <a href="http://fr.wikipedia.org/wiki/Placage_de_relief">bump mapping</a>).<br>
<br>
Cette méthode a le principal avantage d'être très légère en terme de 
stockage, puisque l'on a simplement une image à la place d'un modèle 3D 
complet qui prendrait beaucoup plus d'espace à stocker.<br>
<br>
<div class="rmq question">Ok, ok. Mais à quoi elle ressemble, cette image ?  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/angry.gif" alt=":colere:" class="smilies"> </div><br>
<br>
Voici l'image que nous allons utiliser pour notre terrain :<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/248540.png" alt="Image utilisateur" title="Image utilisateur"></div><br>
Comme vous le voyez c'est une simple image en noir et blanc, et pourtant cela suffit amplement !<br>
<br>
En effet, si l'on utilise uniquement des niveaux de gris dans une image,
 chaque pixel peut prendre 256 valeurs, 0 correspondant au noir et à la 
hauteur la plus faible, 255 au blanc et à la plus forte altitude. On a 
donc 256 altitudes possibles pour notre terrain, ce qui est tout à fait 
honnête et suffit à la majorité des cas.<br>
<br>
<div class="rmq information">J'ai un peu simplifié l'explication ici. En
 réalité, chaque pixel possède trois valeurs, correspondant à la 
quantité de rouge, de vert et de bleu, chacune de ces valeurs allant de 0
 à 255. Or pour les niveaux de gris, ces trois valeurs doivent être 
identiques, ce qui laisse 255 triplets de valeurs : (0, 0, 0) pour le 
noir, puis les niveaux de gris et enfin (255, 255, 255) pour le blanc).</div><br>
<br>
Lors de la création d'un fichier heightmap, on fait en sorte que le 
point le plus haut de notre carte soit blanc et que le point le plus bas
 soit noir, afin d'utiliser toute la plage de valeurs disponibles dans 
la carte et éviter les dénivellations peu naturelles.<br>
<br>
Pour charger un fichier heightmap, on passe par un objet Image qui va 
chercher le nom du fichier que vous voulez dans les ressources déjà 
chargées. J'utilise le fichier terrain.png, que vous pouvez trouver dans
 "OgreSDK\media\materials\textures".<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">Image</span> <span class="n">img</span><span class="p">;</span>
<span class="n">img</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"terrain.png"</span><span class="p">,</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">ResourceGroupManager</span><span class="o">::</span><span class="n">DEFAULT_RESOURCE_GROUP_NAME</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<h4>Les paramètres géométriques</h4><br>
<br>
Pour fournir toutes les informations dont le terrain a besoin pour être 
généré, on utilise sa méthode prepare() qui prend en paramètre un 
Terrain::ImportData, qui est en gros une classe contenant l'ensemble des
 paramètres à fournir au terrain. On va donc commencer par créer cet 
objet :<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">Terrain</span><span class="o">::</span><span class="n">ImportData</span> <span class="n">imp</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">inputImage</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">img</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">terrainSize</span> <span class="o">=</span> <span class="n">img</span><span class="p">.</span><span class="n">getWidth</span><span class="p">();</span>
<span class="n">imp</span><span class="p">.</span><span class="n">worldSize</span> <span class="o">=</span> <span class="mi">8000</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">inputScale</span> <span class="o">=</span> <span class="mi">600</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">minBatchSize</span> <span class="o">=</span> <span class="mi">33</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">maxBatchSize</span> <span class="o">=</span> <span class="mi">65</span><span class="p">;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
On commence par récupérer l'image et sa taille avec les lignes 2 et 3. 
Étant donné que les terrains sont carrés, votre image doit elle aussi 
être carrée, faites attention à cela.<br>
<br>
Ensuite, le paramètre worldSize indique la taille du terrain, 
c'est-à-dire la longueur de ses côtés en unités de la scène. Plus ce 
nombre est grand, plus l'image est agrandie.<br>
<br>
Le nombre suivant correspond à l'échelle adoptée pour l'altitude du 
terrain. C'est la hauteur qui sépare un point de la carte représenté par
 un pixel noir d'un point représenté par un pixel blanc. Il doit donc 
être choisi en parallèle avec la taille du monde, puisque s'il est trop 
élevé et que le monde est trop petit, vous aurez un relief très escarpé.<br>
<br>
Les deux dernières valeurs renseignent les tailles minimale et maximale de batch pour notre terrain.<br>
<br>
<div class="rmq question">Tu pourrais articuler un peu plus, je ne comprends pas tout... <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/unsure.gif" alt=":euh:" class="smilies"> </div><br>
<br>
Oui, d'accord : ce point mérite un petit paragraphe théorique, au moins pour les plus curieux d'entre vous. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/heureux.png" alt=":D" class="smilies"><br>
<br>
<h4>La Batch Size</h4><br>
<br>
Le mot anglais <span class="italique">batch</span> signifie « lot » ou « paquet ». Dans notre cas, qu'est-ce que cela signifie ?<br>
<br>
Vous savez probablement (et je vous l'ai rappelé, si vous avez suivi  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/clin.png" alt=";)" class="smilies">
 ) que l'affichage de modèle 3D à l'écran consomme beaucoup de 
ressources. Dans le cas d'un paysage extérieur, si vous avez un champ de
 vision très dégagé, vous êtes censés pouvoir voir beaucoup d'éléments 
du paysage à l'écran, ce qui fait un travail colossal pour votre 
ordinateur, surtout s'il doit calculer la position de chaque brin 
d'herbe à l'horizon !<br>
<br>
<div class="rmq question">Tu sais, moi, les brins d'herbe qui sont à 
plus de 100 mètres, je ne les vois pas, alors je passerai l'éponge si 
mon ordinateur ne les affiche pas...</div><br>
<br>
C'est précisément ce qui se passe dans de telles conditions. Plutôt que 
de chercher à calculer dans les moindres détails la façon dont apparaît 
la pelouse à l'autre bout du paysage, pour ensuite ne l'afficher que sur
 une toute petite surface de l'écran, le moteur va simplifier les choses
 et calculer de façon grossière l'affichage de ces objets.<br>
<br>
Ainsi, les textures peuvent être simplifiées, mais aussi les meshs, dont
 l'ordinateur va réduire le nombre de vertices pour avoir moins de 
calculs à faire, vu que vous ne voyez pas les détails (on parle aussi de
 niveau de détail, ou <acronym title="Level of Detail">LOD</acronym>.<br>
<br>
Pour un terrain, le maillage pourrait donc avoir un aspect similaire à celui-ci (image issue du <a href="http://www.ogre3d.org/tikiwiki/-LOD&amp;highlight=level%20of%20detail">wiki d'Ogre3D.org</a>) :<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/248573.jpg" alt="Image utilisateur" title="Image utilisateur"></div><br>
<br>
La zone où se situe la caméra est la plus détaillée, le reste est simplifié.<br>
<br>
La taille de batch vous permet donc d'indiquer à quel degré cette simplification se fait.<br>
<br>
Le terrain est divisé en lots, donc la taille varie en fonction de la 
distance de la caméra à ces lots. Plus on s'éloigne, plus le lot est 
simplifié par suppression de vertices. Lorsque plusieurs lots atteignent
 une taille minimale, ils sont regroupés en un seul lot, qui est à son 
tour simplifié progressivement si la caméra continue de reculer.<br>
<br>
Si la taille minimum de batch est faible, les lots adjacents auront plus
 facilement un niveau de détail équivalent, mais il y aura plus de lots à
 gérer par l'ordinateur. En revanche, si elle est élevée, on regroupe 
plus rapidement les lots, mais les frontières entre ceux-ci sont plus 
facilement visibles, car le niveau de détail peut varier plus fortement.<br>
<br>
Les valeurs que j'ai mises sont des valeurs courantes, sachez juste que 
la taille maximum est de 65 et qu'elles doivent obéir à la formule 
suivante :<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/mimetex_002.gif" alt="taille = 2^n + 1"></div><br>
<br>
<h4>Mise en place des textures</h4><br>
<br>
Pour gérer les textures, l'outil Terrain d'Ogre utilise des calques. 
Chacun de ces calques correspond à une texture, que vous pourrez ensuite
 appliquer où bon vous semblera.<br>
<br>
Comme on parle de calques, autant vous dire tout de suite qu'il est 
possible de les superposer, de donner plus ou moins d'intensité à un 
calque, pour créer des effets élaborés.<br>
<br>
Nous allons commencer avec une seule texture pour faire simple et 
assimiler le principe. Tout se fait à l'aide de notre importateur de 
données :<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">worldSize</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">textureNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="s">"grass_green-01_diffusespecular.dds"</span><span class="p">);</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">textureNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="s">"grass_green-01_normalheight.dds"</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Ici les fonctions sont relativement explicites, pour les anglophones en tout cas. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/langue.png" alt=":p" class="smilies"><br>
<br>
La première ligne donne la taille de la liste de calques, ici je n'en ai
 mis qu'un seul. La seconde ligne donne la taille de la texture dans le 
monde. Plus le nombre est important, plus la texture sera zoomée, et 
inversement.<br>
<br>
Les deux lignes suivantes insèrent chacune une texture dans notre calque (textureNames est un vector).<br>
<br>
<div class="rmq question">Deux textures ? Je croyais qu'on mettait les textures sur des calques différents ?</div><br>
<br>
En fait, on devrait plutôt dire qu'un calque contient un matériau.<br>
<br>
Les matériaux sont faits avec deux textures :<br>
<ul>
<li>une texture diffuse, qui contient les couleurs, les motifs du matériau ;</li>
<li>une texture normale, contenant des informations sur le relief du matériau.</li>
</ul><br>
<br>
La combinaison de ces deux textures permet d'avoir un matériau complet.<br>
<br>
<h4>Filtrage anisotrope</h4><br>
<br>
Pendant que je suis au point sur les textures, je vais revenir 
rapidement sur le niveau de détail, qui est réglable pour les matériaux 
via le filtrage de texture.<br>
<br>
Vous pouvez donc régler la netteté du placage de textures sur vos meshs via un niveau de filtrage.<br>
<br>
On peut distinguer quatre options de filtrages, de la plus grossière à la plus précise :<br>
<ul>	
<li>aucun filtrage ;</li>	
<li>bilinéaire ;</li>	
<li>trilinéaire ;</li>	
<li>anisotrope.</li>
</ul><br>
<br>
Voici la différence entre un filtrage anisotrope (à gauche) et une 
texture sans filtrage (à droite). La différence est relativement subtile
 ici mais visible tout de même.<br>
<br>
<div class="centre"><a href="http://uploads.siteduzero.com/files/249001_250000/249264.jpg"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/249264.jpg" alt="Image utilisateur"></a></div><br>
<br>
Je vous propose donc d'opter pour un filtrage anisotrope, avec une 
valeur de 8 (la valeur par défaut est 1 et équivaut à l'absence de 
filtrage). Vous devez donc rajouter ces deux lignes dans votre code, au 
début de la méthode createScene() par exemple.<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">MaterialManager</span><span class="o">::</span><span class="n">getSingleton</span><span class="p">().</span><span class="n">setDefaultTextureFiltering</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">TFO_ANISOTROPIC</span><span class="p">);</span>
<span class="n">Ogre</span><span class="o">::</span><span class="n">MaterialManager</span><span class="o">::</span><span class="n">getSingleton</span><span class="p">().</span><span class="n">setDefaultAnisotropy</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<div class="rmq information">Le filtrage de textures n'est pas propre uniquement aux terrains, mais affecte toutes les textures affichées par le moteur.</div><br>
<br>
<h4>Chargement et nettoyage</h4><br>
<br>
Une fois que les paramètres ont été définis dans l'ImportData, il ne reste qu'à préparer et charger le terrain :<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">prepare</span><span class="p">(</span><span class="n">imp</span><span class="p">);</span>
<span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">load</span><span class="p">();</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Pour terminer et faire un peu de place en mémoire, il est conseillé 
d'appeler la méthode suivante qui se chargera de libérer la mémoire 
allouée temporairement pour la création de votre terrain. Placez donc 
cette ligne à la fin de la méthode createTerrain().<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">freeTemporaryResources</span><span class="p">();</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Compilez et lancez l'application pour obtenir un joli paysage !
		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_425395">Le plaquage de texture</h2>
		<div class="ss_part_texte">
		Je l'ai dit plus haut, Ogre nous permet d'utiliser différents calques 
pour nos matériaux. La bonne nouvelle dans tout cela, c'est qu'on va 
pouvoir faire comme à l'école : mettre les calques les uns sur les 
autres, modifier leur opacité pour avoir une texture plus ou moins 
visible, tout en décidant de la zone où l'on veut appliquer la texture.<br>
<br>
La première étape consiste à rajouter des calques dans notre liste, 
avant de créer le terrain. Remplacez donc le bloc que vous aviez par le 
code suivant, afin d'ajouter deux nouveaux matériaux.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">worldSize</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">textureNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="s">"grass_green-01_diffusespecular.dds"</span><span class="p">);</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">textureNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="s">"grass_green-01_normalheight.dds"</span><span class="p">);</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">worldSize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">textureNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="s">"growth_weirdfungus-03_diffusespecular.dds"</span><span class="p">);</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">textureNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="s">"growth_weirdfungus-03_normalheight.dds"</span><span class="p">);</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">worldSize</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">textureNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="s">"dirt_grayrocky_diffusespecular.dds"</span><span class="p">);</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">textureNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="s">"dirt_grayrocky_normalheight.dds"</span><span class="p">);</span>
<span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">prepare</span><span class="p">(</span><span class="n">imp</span><span class="p">);</span>
<span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">load</span><span class="p">();</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Si vous exécutez le code maintenant, rien n'aura changé sur votre 
terrain. Par défaut, c'est uniquement le premier matériau qui est 
affiché. Il est donc nécessaire d'ajouter quelques lignes pour dire de 
quelle façon nous voulons faire notre plaquage de texture.<br>
<br>
Le principe est assez simple à comprendre si on y va petit à petit. 
Chaque calque d'un terrain possède un objet TerrainLayerBlendMap (que 
j'appellerai dorénavant Blend Map) qui exprime la façon dont le calque 
est fusionné avec les calques inférieurs (le calque le plus bas est le 
calque 0).<br>
<br>
Cette fusion est simplement une affaire de transparence. Les calques 
sont placés les uns sur les autres, et la composante transparente 
indique si la texture en dessous est plus ou moins visible. Il est de 
plus possible de faire varier la transparence du calque en chaque point 
de celui-ci, ce qui permet d'avoir un placage par zone.<br>
<br>
À la suite du bloc de code précédent, commencez par récupérer les Blend 
Map correspondant au calque numéro 1, que nous venons d'ajouter (nous 
nous occuperons du second ensuite).<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">TerrainLayerBlendMap</span><span class="o">*</span> <span class="n">blendMap1</span> <span class="o">=</span> <span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">getLayerBlendMap</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Nous allons commencer par plaquer une seule texture au-dessus de l'herbe, sur toute la surface de notre terrain.<br>
<br>
L'idée est de parcourir l'ensemble des points du calque avec deux boucles <span class="code2 cpp"><span class="k">for</span></span>
 (il y a autant de points qu'il y avait de pixels dans notre heightmap) 
et de leur attribuer la transparence désirée, entre 1 (totalement 
opaque) et 255 (transparent).<br>
<br>
<div class="rmq erreur">La valeur la plus faible est bien 1 et non 0. Si vous mettez 0, la texture est transparente ! </div><br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">float</span><span class="o">*</span> <span class="n">pBlend1</span> <span class="o">=</span> <span class="n">blendMap1</span><span class="o">-&gt;</span><span class="n">getBlendPointer</span><span class="p">();</span>
<span class="k">for</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">uint16</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">getLayerBlendMapSize</span><span class="p">();</span> <span class="o">++</span><span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">uint16</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">getLayerBlendMapSize</span><span class="p">();</span> <span class="o">++</span><span class="n">x</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="o">*</span><span class="n">pBlend1</span><span class="o">++</span> <span class="o">=</span> <span class="mi">150</span><span class="p">;</span> <span class="c1">// opacité désirée pour le point courant</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Pour terminer, il faut mettre à jour notre Blend Map en appelant les 
méthodes dirty() puis update(). La première sert à préciser que les 
données de la Blend map sont obsolètes et doivent être mises à jour, 
tandis que la seconde fait effectivement la mise à jour.<br>
<br>
<div class="rmq information">Si vous n'appelez pas d'abord dirty(), update() n'aura aucun effet.</div><br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">blendMap1</span><span class="o">-&gt;</span><span class="n">dirty</span><span class="p">();</span>
<span class="n">blendMap1</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">();</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Je vous mets le code complet de la méthode createTerrain() si vous voulez vérifier que tout est en ordre :<br>
<br>
<span class="spoiler_hidden">Secret <a href="#" onclick="switch_spoiler_hidden(this); return false;">(cliquez pour afficher)</a></span><div class="spoiler2_hidden"><div class="spoiler3_hidden"><br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mTerrain</span> <span class="o">=</span> <span class="n">OGRE_NEW</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Terrain</span><span class="p">(</span><span class="n">mSceneMgr</span><span class="p">);</span>

<span class="c1">// options globales</span>
<span class="n">mGlobals</span> <span class="o">=</span> <span class="n">OGRE_NEW</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">TerrainGlobalOptions</span><span class="p">();</span>
<span class="n">mGlobals</span><span class="o">-&gt;</span><span class="n">setMaxPixelError</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="n">mGlobals</span><span class="o">-&gt;</span><span class="n">setCompositeMapDistance</span><span class="p">(</span><span class="mi">8000</span><span class="p">);</span>
<span class="n">mGlobals</span><span class="o">-&gt;</span><span class="n">setLightMapDirection</span><span class="p">(</span><span class="n">mLight</span><span class="o">-&gt;</span><span class="n">getDerivedDirection</span><span class="p">());</span>
<span class="n">mGlobals</span><span class="o">-&gt;</span><span class="n">setCompositeMapAmbient</span><span class="p">(</span><span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">getAmbientLight</span><span class="p">());</span>
<span class="n">mGlobals</span><span class="o">-&gt;</span><span class="n">setCompositeMapDiffuse</span><span class="p">(</span><span class="n">mLight</span><span class="o">-&gt;</span><span class="n">getDiffuseColour</span><span class="p">());</span>

<span class="n">Ogre</span><span class="o">::</span><span class="n">Image</span> <span class="n">img</span><span class="p">;</span>
<span class="n">img</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"terrain.png"</span><span class="p">,</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">ResourceGroupManager</span><span class="o">::</span><span class="n">DEFAULT_RESOURCE_GROUP_NAME</span><span class="p">);</span>

<span class="c1">// informations géométriques</span>
<span class="n">Ogre</span><span class="o">::</span><span class="n">Terrain</span><span class="o">::</span><span class="n">ImportData</span> <span class="n">imp</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">inputImage</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">img</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">terrainSize</span> <span class="o">=</span> <span class="n">img</span><span class="p">.</span><span class="n">getWidth</span><span class="p">();</span>
<span class="n">imp</span><span class="p">.</span><span class="n">worldSize</span> <span class="o">=</span> <span class="mi">8000</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">inputScale</span> <span class="o">=</span> <span class="mi">600</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">minBatchSize</span> <span class="o">=</span> <span class="mi">33</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">maxBatchSize</span> <span class="o">=</span> <span class="mi">65</span><span class="p">;</span>

<span class="c1">// textures</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">worldSize</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">textureNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="s">"grass_green-01_diffusespecular.dds"</span><span class="p">);</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">textureNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="s">"grass_green-01_normalheight.dds"</span><span class="p">);</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">worldSize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">textureNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="s">"growth_weirdfungus-03_diffusespecular.dds"</span><span class="p">);</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">textureNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="s">"growth_weirdfungus-03_normalheight.dds"</span><span class="p">);</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">worldSize</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">textureNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="s">"dirt_grayrocky_diffusespecular.dds"</span><span class="p">);</span>
<span class="n">imp</span><span class="p">.</span><span class="n">layerList</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">textureNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="s">"dirt_grayrocky_normalheight.dds"</span><span class="p">);</span>
<span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">prepare</span><span class="p">(</span><span class="n">imp</span><span class="p">);</span>
<span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">load</span><span class="p">();</span>

<span class="c1">// plaquage de texture</span>
<span class="n">Ogre</span><span class="o">::</span><span class="n">TerrainLayerBlendMap</span><span class="o">*</span> <span class="n">blendMap1</span> <span class="o">=</span> <span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">getLayerBlendMap</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="kt">float</span><span class="o">*</span> <span class="n">pBlend1</span> <span class="o">=</span> <span class="n">blendMap1</span><span class="o">-&gt;</span><span class="n">getBlendPointer</span><span class="p">();</span>

<span class="k">for</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">uint16</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">getLayerBlendMapSize</span><span class="p">();</span> <span class="o">++</span><span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">uint16</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">getLayerBlendMapSize</span><span class="p">();</span> <span class="o">++</span><span class="n">x</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="o">*</span><span class="n">pBlend1</span><span class="o">++</span> <span class="o">=</span> <span class="mi">150</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">blendMap1</span><span class="o">-&gt;</span><span class="n">dirty</span><span class="p">();</span>
<span class="n">blendMap1</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">();</span>

<span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">freeTemporaryResources</span><span class="p">();</span>
</pre></div>
</td></tr></tbody></table></div><br>
</div></div><br>
<br>
Vous pouvez maintenant exécuter l'application ! Profitez-en pour 
vérifier en vous approchant du sol que l'on distingue bien l'herbe et 
par-dessus la terre.  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/hihi.png" alt="^^" class="smilies"> <br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/248855.jpg" alt="Image utilisateur"></div><br>
<br>
<div class="rmq question">Mais c'est moche !  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/blink.gif" alt="o_O" class="smilies">  </div><br>
<br>
D'accord, la forme n'est pas terrible. Mais le principe y est, c'est un début.<br>
<br>
On va tout de suite essayer de faire quelque chose de plus esthétique.  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/hihi.png" alt="^^" class="smilies"><br>
<br>
Pour cela, maintenant que vous avez saisi les grandes étapes, je vous propose un mini-TP pour vous entraîner.<br>
<br>
<h3>Au boulot !</h3><br>
<br>
<h4>Objectif</h4><br>
<br>
Une image vaut sûrement mieux qu'un long discours, voici donc ce que vous allez devoir obtenir :<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/248854.jpg" alt="Image utilisateur"></div><br>
<br>
L'idée est de texturer le terrain en fonction de l'altitude. Si l'on est
 en dessous d'un certain seuil, il n'y a que de la terre qui apparaît ; 
au-dessus, on a de l'herbe.<br>
<br>
<h4>Indications</h4><br>
<br>
Vous n'avez pas besoin de grand-chose pour faire cela, simplement quelques secondes de réflexion !<br>
<br>
Je vous donne tout de même les méthodes qui sont utiles, notamment pour 
trouver l'altitude du terrain en fonction de la position :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">float</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Terrain</span><span class="o">::</span><span class="n">getHeightAtTerrainPosition</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">x</span><span class="p">,</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Cette fonction retourne l'altitude en fonction de la position, sachant que x et y sont compris entre 0 et 1.<br>
<br>
Pour récupérer ces deux valeurs, on utilise une méthode de 
TerrainLayerBlendMap qui convertit les coordonnées de l'image en 
coordonnées du terrain (celles dont vous avez besoin) :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">void</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">TerrainLayerBlendMap</span><span class="o">::</span><span class="n">convertImageToTerrainSpace</span><span class="p">(</span><span class="n">size_t</span> <span class="n">x</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">y</span><span class="p">,</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="o">*</span> <span class="n">outX</span><span class="p">,</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="o">*</span> <span class="n">outY</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div> 	<br>
<br>
Enfin, je vous laisse choisir l'altitude limite entre l'herbe et la 
terre : si vous avez bien suivi la création du terrain, vous devriez 
trouver tout seuls une valeur opportune. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/clin.png" alt=";)" class="smilies"><br>
<br>
Vous avez toutes les cartes en mains maintenant. Vous avez 10 minutes !<br>
<br>
<h4>Correction</h4><br>
<br>
Comme avez dû le deviner, tout se passe dans les deux boucles <span class="code2 cpp"><span class="k">for</span></span>.<br>
<br>
Pour chaque point parcouru, on recherche ses coordonnées dans le repère 
du terrain, puis on récupère la hauteur, que l'on compare à notre 
hauteur limite. Si on est en dessous, on affiche la texture de terre 
avec une opacité maximum, sinon on ne fait qu'incrémenter le pointeur de
 la Blend map.<br>
<br>
Voici donc le code modifié :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="syntax"><pre><span class="k">for</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">uint16</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">getLayerBlendMapSize</span><span class="p">();</span> <span class="o">++</span><span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">uint16</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">getLayerBlendMapSize</span><span class="p">();</span> <span class="o">++</span><span class="n">x</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">terrainX</span><span class="p">,</span> <span class="n">terrainY</span><span class="p">;</span>

        <span class="n">blendMap1</span><span class="o">-&gt;</span><span class="n">convertImageToTerrainSpace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">terrainX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">terrainY</span><span class="p">);</span>
        <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">height</span> <span class="o">=</span> <span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">getHeightAtTerrainPosition</span><span class="p">(</span><span class="n">terrainX</span><span class="p">,</span> <span class="n">terrainY</span><span class="p">);</span>

        <span class="k">if</span><span class="p">(</span><span class="n">height</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">)</span>
            <span class="o">*</span><span class="n">pBlend1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

        <span class="n">pBlend1</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<div class="rmq information">Vous pouvez aussi bien sûr récupérer la 
Blend map numéro 2 plus haut pour voir le résultat avec une autre 
texture, c'est ce que j'ai fait pour obtenir l'image référence pour le 
TP.</div><br>
<br>
<h3>Pour aller plus loin</h3><br>
<br>
Sur le même principe, nous allons voir comment appliquer deux textures 
différentes sur une petite largeur, à une altitude donnée.<br>
<br>
Ceci peut être utile si vous voulez réaliser des étendues d'eau dans 
votre terrain : au bord de l'eau, il y a de la boue, un peu au-dessus, 
de la terre sèche, puis ensuite l'herbe reprend ses droits. C'est ce que
 nous allons faire, avec une opacité progressive, mais sans l'eau, ce 
sera pour plus tard. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/heureux.png" alt=":D" class="smilies"><br>
<br>
Nous devons commencer par récupérer un pointeur sur notre seconde Blend 
Map pour pouvoir gérer la seconde texture en plus de la première. Il y a
 donc deux lignes à rajouter en conséquence avant les boucles.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">TerrainLayerBlendMap</span><span class="o">*</span> <span class="n">blendMap1</span> <span class="o">=</span> <span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">getLayerBlendMap</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="ln-xtra"><span class="n">Ogre</span><span class="o">::</span><span class="n">TerrainLayerBlendMap</span><span class="o">*</span> <span class="n">blendMap2</span> <span class="o">=</span> <span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">getLayerBlendMap</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span></span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">float</span><span class="o">*</span> <span class="n">pBlend1</span> <span class="o">=</span> <span class="n">blendMap1</span><span class="o">-&gt;</span><span class="n">getBlendPointer</span><span class="p">();</span>
<span class="ln-xtra"><span class="kt">float</span><span class="o">*</span> <span class="n">pBlend2</span> <span class="o">=</span> <span class="n">blendMap2</span><span class="o">-&gt;</span><span class="n">getBlendPointer</span><span class="p">();</span></span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Définissons aussi deux variables pour chacune des textures : la hauteur à
 laquelle se situe la texture et la largeur de la bande que l'on veut 
obtenir.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">minHeight1</span> <span class="o">=</span> <span class="mi">70</span><span class="p">;</span>
<span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">fadeDist1</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
<span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">minHeight2</span> <span class="o">=</span> <span class="mi">70</span><span class="p">;</span>
<span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">fadeDist2</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Dans la boucle, on déclare trois variables : deux coordonnées du terrain et la transparence pour le point actuel.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">terrainX</span><span class="p">,</span> <span class="n">terrainY</span><span class="p">,</span> <span class="n">transparence</span><span class="p">;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
On récupère ensuite la hauteur du terrain comme précédemment.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">blendMap1</span><span class="o">-&gt;</span><span class="n">convertImageToTerrainSpace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">terrainX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">terrainY</span><span class="p">);</span>
<span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">height</span> <span class="o">=</span> <span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">getHeightAtTerrainPosition</span><span class="p">(</span><span class="n">terrainX</span><span class="p">,</span> <span class="n">terrainY</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Ensuite, pour chaque texture, on calcule la différence entre la hauteur 
du point actuel et la hauteur que l'on veut pour la texture, divisée par
 la largeur de la bande. Si le point est censé être recouvert par la 
texture, ce nombre sera donc compris entre 0 et 1.<br>
<br>
On utilise ensuite la méthode statique Clamp() qui a pour prototype :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="k">static</span> <span class="n">T</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Math</span><span class="o">::</span><span class="n">Clamp</span><span class="p">(</span><span class="n">T</span> <span class="n">val</span><span class="p">,</span> <span class="n">T</span> <span class="n">minval</span><span class="p">,</span> <span class="n">T</span> <span class="n">maxval</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Si val est inférieure à minval, la fonction retourne minval ; si val est
 supérieure à maxval, on retourne maxval. Si val est dans l'intervalle, 
on la retourne directement.<br>
<br>
Comme on ne veut afficher que les points donc la valeur calculée 
précédemment est comprise entre 0 et 1, on va utiliser cette méthode 
pour « couper » toutes les valeurs en dehors de l'intervalle.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">transparence</span> <span class="o">=</span> <span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="n">minHeight1</span><span class="p">)</span> <span class="o">/</span> <span class="n">fadeDist1</span><span class="p">;</span>
<span class="n">transparence</span> <span class="o">=</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Math</span><span class="o">::</span><span class="n">Clamp</span><span class="p">(</span><span class="n">transparence</span><span class="p">,</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span><span class="p">)</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span><span class="p">)</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Pour terminer, on multiplie transparence par 255 pour avoir une valeur comprise entre 0 et 255.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="o">*</span><span class="n">pBlend1</span><span class="o">++</span> <span class="o">=</span> <span class="n">transparence</span> <span class="o">*</span> <span class="mi">255</span><span class="p">;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<div class="rmq information">On observe que si transparence est à 
l'extérieur de l'intervalle [0 ; 1] après le premier calcul, Clamp 
retournera 0 ou 1. Quand on multiplie par 255, on obtient donc 0 ou 255,
 qui sont les deux valeurs pour lesquelles la texture est transparente. 
Mission accomplie !</div><br>
<br>
On copie ces trois lignes pour la seconde texture, et on obtient le code suivant dans nos boucles :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="syntax"><pre><span class="k">for</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">uint16</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">getLayerBlendMapSize</span><span class="p">();</span> <span class="o">++</span><span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">uint16</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">getLayerBlendMapSize</span><span class="p">();</span> <span class="o">++</span><span class="n">x</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">terrainX</span><span class="p">,</span> <span class="n">terrainY</span><span class="p">,</span> <span class="n">transparence</span><span class="p">;</span>

        <span class="n">blendMap1</span><span class="o">-&gt;</span><span class="n">convertImageToTerrainSpace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">terrainX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">terrainY</span><span class="p">);</span>
        <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">height</span> <span class="o">=</span> <span class="n">mTerrain</span><span class="o">-&gt;</span><span class="n">getHeightAtTerrainPosition</span><span class="p">(</span><span class="n">terrainX</span><span class="p">,</span> <span class="n">terrainY</span><span class="p">);</span>

        <span class="n">transparence</span> <span class="o">=</span> <span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="n">minHeight1</span><span class="p">)</span> <span class="o">/</span> <span class="n">fadeDist1</span><span class="p">;</span>
        <span class="n">transparence</span> <span class="o">=</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Math</span><span class="o">::</span><span class="n">Clamp</span><span class="p">(</span><span class="n">transparence</span><span class="p">,</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span><span class="p">)</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span><span class="p">)</span><span class="mi">1</span><span class="p">);</span>
        <span class="o">*</span><span class="n">pBlend1</span><span class="o">++</span> <span class="o">=</span> <span class="n">transparence</span> <span class="o">*</span> <span class="mi">255</span><span class="p">;</span>

        <span class="n">transparence</span> <span class="o">=</span> <span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="n">minHeight2</span><span class="p">)</span> <span class="o">/</span> <span class="n">fadeDist2</span><span class="p">;</span>
        <span class="n">transparence</span> <span class="o">=</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Math</span><span class="o">::</span><span class="n">Clamp</span><span class="p">(</span><span class="n">transparence</span><span class="p">,</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span><span class="p">)</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span><span class="p">)</span><span class="mi">1</span><span class="p">);</span>
        <span class="o">*</span><span class="n">pBlend2</span><span class="o">++</span> <span class="o">=</span> <span class="n">transparence</span> <span class="o">*</span> <span class="mi">255</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Pensez à mettre à jour la seconde Blend Map une fois que les modifications sont terminées :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">blendMap1</span><span class="o">-&gt;</span><span class="n">dirty</span><span class="p">();</span>
<span class="ln-xtra"><span class="n">blendMap2</span><span class="o">-&gt;</span><span class="n">dirty</span><span class="p">();</span></span>
<span class="n">blendMap1</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">();</span>
<span class="ln-xtra"><span class="n">blendMap2</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">();</span></span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/248857.jpg" alt="Image utilisateur"></div>
		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_425393">Et si on en veut plus ?</h2>
		<div class="ss_part_texte">
		<h3>Les groupes de terrains</h3><br>
<br>
Un groupe de terrains range les terrains comme dans un tableau à deux 
dimensions, on obtient donc un système de coordonnées du groupe de 
terrains pour retrouver chacun des terrains contenus dans celui-ci.<br>
<br>
Dans le groupe, tous les terrains ont la même taille, afin de pouvoir 
les aligner dans une grille. Vous ne pouvez donc pas créer des terrains 
de tailles diverses pour les ranger dans un TerrainGroup.<br>
<br>
<h3>Création</h3><br>
<br>
On commence par ajouter un include au début de la classe puis on 
remplace notre instance de Terrain par un TerrainGroup, ensuite on 
l'initialisera dans notre méthode createTerrain() :<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="syntax"><pre><span class="cp">#include &lt;Ogre/Terrain/OgreTerrainGroup.h&gt;</span>

<span class="c1">//...</span>

<span class="n">Ogre</span><span class="o">::</span><span class="n">TerrainGroup</span> <span class="o">*</span><span class="n">mTerrainGroup</span><span class="p">;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Après les lignes permettant de charger l'image heightmap dans la méthode createTerrain(), insérez les lignes suivantes.<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mTerrainGroup</span> <span class="o">=</span> <span class="n">OGRE_NEW</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">TerrainGroup</span><span class="p">(</span><span class="n">mSceneMgr</span><span class="p">,</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Terrain</span><span class="o">::</span><span class="n">ALIGN_X_Z</span><span class="p">,</span> <span class="n">img</span><span class="p">.</span><span class="n">getWidth</span><span class="p">(),</span> <span class="mi">8000</span><span class="p">);</span>
<span class="n">mTerrainGroup</span><span class="o">-&gt;</span><span class="n">setOrigin</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Vector3</span><span class="o">::</span><span class="n">ZERO</span><span class="p">);</span>
<span class="n">mTerrainGroup</span><span class="o">-&gt;</span><span class="n">setFilenameConvention</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">String</span><span class="p">(</span><span class="s">"TerrainDuZero"</span><span class="p">),</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">String</span><span class="p">(</span><span class="s">"dat"</span><span class="p">));</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Les paramètres à fournir au TerrainGroup sont le Scene manager, 
l'alignement du terrain par rapport au repère global (vous pouvez créer 
un terrain vertical, par exemple), la taille des heightmaps utilisées et
 la taille d'un terrain.<br>
<br>
On définit ensuite la position de l'origine du groupe de terrains, puis 
le nom (et l'extension) que l'on veut attribuer à nos fichiers qui 
seront créés pour sauvegarder les terrains par la suite.<br>
<br>
Pour les données des terrains enregistrées dans un objet ImportData, 
nous allons modifier un peu le fonctionnement du programme. On récupère 
en fait directement une référence sur un ImportData fourni par le 
TerrainGroup, que l'on modifie directement et qui sera valable pour 
l'ensemble des terrains du groupe. À noter que la ligne de définition de
 la heightmap n'est plus utile ici, cela sera indiqué lors de la 
création des terrains.<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="syntax"><pre><span class="ln-xtra"><span class="n">Ogre</span><span class="o">::</span><span class="n">Terrain</span><span class="o">::</span><span class="n">ImportData</span><span class="o">&amp;</span> <span class="n">imp</span> <span class="o">=</span> <span class="n">mTerrainGroup</span><span class="o">-&gt;</span><span class="n">getDefaultImportSettings</span><span class="p">();</span></span>
<span class="n">imp</span><span class="p">.</span><span class="n">terrainSize</span> <span class="o">=</span> <span class="n">img</span><span class="p">.</span><span class="n">getWidth</span><span class="p">();</span>
<span class="n">imp</span><span class="p">.</span><span class="n">worldSize</span> <span class="o">=</span> <span class="mi">8000</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">inputScale</span> <span class="o">=</span> <span class="mi">600</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">minBatchSize</span> <span class="o">=</span> <span class="mi">33</span><span class="p">;</span>
<span class="n">imp</span><span class="p">.</span><span class="n">maxBatchSize</span> <span class="o">=</span> <span class="mi">65</span><span class="p">;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Il est maintenant temps de créer les terrains du groupe. On définit la 
taille du groupe et pour chaque case, on appelle une méthode 
definirTerrain() définie plus bas qui s'occupera de créer chaque terrain
 indépendamment.<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">int</span> <span class="n">largeur</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">longueur</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">largeur</span><span class="p">;</span> <span class="n">x</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">longueur</span><span class="p">;</span> <span class="n">y</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">definirTerrain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">mTerrainGroup</span><span class="o">-&gt;</span><span class="n">loadAllTerrains</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Le groupe se charge pour terminer d'appeler les méthodes load() de 
chaque terrain à travers la méthode loadAllTerrains(). Cette méthode 
prend un booléen en paramètre qui indique si le chargement doit être 
synchrone, c'est-à-dire exécuté dans un seul thread (le thread principal
 ici). Par défaut cette valeur est fausse, c'est-à-dire que les terrains
 sont chargés dans plusieurs threads si c'est possible.<br>
<br>
<div class="rmq attention">Le chargement devient vite très lourd si l'on
 ajoute beaucoup de terrains aux groupes. Nous verrons plus bas comment 
accélérer le chargement.</div><br>
<br>
<br>
Maintenant, nous devons écrire la méthode definirTerrain() qui utilise 
la méthode defineTerrain() de TerrainGroup. Celle-ci va prendre 3 
paramètres : les deux coordonnées du terrain dans le groupe de terrains 
(sa position sur la grille, donc) et l'image heightmap utilisée pour ce 
terrain. Les coordonnées du terrain au sein du groupe peuvent être 
négatives.<br>
<br>
Juste avant d'appeler le terrain, on va faire une vérification sur les 
coordonnées : si l'abscisse du terrain est impaire, on inverse l'image 
suivant l'axe Y, si l'ordonnée est impaire, on inverse l'image cette 
fois-ci selon l'axe X. Cela permet aux terrains du groupe de ne pas 
avoir de différence d'altitude lors des jointures. Si vous utilisez des 
heightmaps différents sur les terrains du groupe (ce qui sera 
probablement le cas), vous devrez faire attention à ce que les altitudes
 des bords correspondent pour éviter les trous à ces endroits.<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">void</span> <span class="n">PremiereApplication</span><span class="o">::</span><span class="n">definirTerrain</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">Image</span> <span class="n">img</span><span class="p">;</span>
    <span class="n">img</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"terrain.png"</span><span class="p">,</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">ResourceGroupManager</span><span class="o">::</span><span class="n">DEFAULT_RESOURCE_GROUP_NAME</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">img</span><span class="p">.</span><span class="n">flipAroundY</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">y</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">img</span><span class="p">.</span><span class="n">flipAroundX</span><span class="p">();</span>
    <span class="n">mTerrainGroup</span><span class="o">-&gt;</span><span class="n">defineTerrain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">img</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<br>
Une fois que les terrains sont chargés, il faut leur appliquer les 
textures définies. On utilise pour cela un itérateur sur le groupe de 
terrains et, pour chaque terrain, on appelle une méthode initBlendMaps()
 qui contient le code pour texturer les terrains.<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">TerrainGroup</span><span class="o">::</span><span class="n">TerrainIterator</span> <span class="n">ti</span> <span class="o">=</span> <span class="n">mTerrainGroup</span><span class="o">-&gt;</span><span class="n">getTerrainIterator</span><span class="p">();</span>
<span class="k">while</span><span class="p">(</span><span class="n">ti</span><span class="p">.</span><span class="n">hasMoreElements</span><span class="p">())</span>
<span class="p">{</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">Terrain</span><span class="o">*</span> <span class="n">t</span> <span class="o">=</span> <span class="n">ti</span><span class="p">.</span><span class="n">getNext</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">instance</span><span class="p">;</span>
    <span class="n">initBlendMaps</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
La méthode initBlendMaps() contient uniquement du code que l'on a déjà 
vu mais que j'ai déplacé pour plus de clarté. Elle prend en paramètre le
 terrain dont on doit modifier les Blend maps.<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">void</span> <span class="n">PremiereApplication</span><span class="o">::</span><span class="n">initBlendMaps</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Terrain</span> <span class="o">*</span><span class="n">terrain</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">TerrainLayerBlendMap</span><span class="o">*</span> <span class="n">blendMap1</span> <span class="o">=</span> <span class="n">terrain</span><span class="o">-&gt;</span><span class="n">getLayerBlendMap</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">TerrainLayerBlendMap</span><span class="o">*</span> <span class="n">blendMap2</span> <span class="o">=</span> <span class="n">terrain</span><span class="o">-&gt;</span><span class="n">getLayerBlendMap</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">minHeight1</span> <span class="o">=</span> <span class="mi">70</span><span class="p">;</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">fadeDist1</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">minHeight2</span> <span class="o">=</span> <span class="mi">70</span><span class="p">;</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">fadeDist2</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
    <span class="kt">float</span><span class="o">*</span> <span class="n">pBlend1</span> <span class="o">=</span> <span class="n">blendMap1</span><span class="o">-&gt;</span><span class="n">getBlendPointer</span><span class="p">();</span>
    <span class="kt">float</span><span class="o">*</span> <span class="n">pBlend2</span> <span class="o">=</span> <span class="n">blendMap2</span><span class="o">-&gt;</span><span class="n">getBlendPointer</span><span class="p">();</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">uint16</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">terrain</span><span class="o">-&gt;</span><span class="n">getLayerBlendMapSize</span><span class="p">();</span> <span class="o">++</span><span class="n">y</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">uint16</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">terrain</span><span class="o">-&gt;</span><span class="n">getLayerBlendMapSize</span><span class="p">();</span> <span class="o">++</span><span class="n">x</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">terrainX</span><span class="p">,</span> <span class="n">terrainY</span><span class="p">,</span> <span class="n">transparence</span><span class="p">;</span>

            <span class="n">blendMap1</span><span class="o">-&gt;</span><span class="n">convertImageToTerrainSpace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">terrainX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">terrainY</span><span class="p">);</span>
            <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span> <span class="n">height</span> <span class="o">=</span> <span class="n">terrain</span><span class="o">-&gt;</span><span class="n">getHeightAtTerrainPosition</span><span class="p">(</span><span class="n">terrainX</span><span class="p">,</span> <span class="n">terrainY</span><span class="p">);</span>

            <span class="n">transparence</span> <span class="o">=</span> <span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="n">minHeight1</span><span class="p">)</span> <span class="o">/</span> <span class="n">fadeDist1</span><span class="p">;</span>
            <span class="n">transparence</span> <span class="o">=</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Math</span><span class="o">::</span><span class="n">Clamp</span><span class="p">(</span><span class="n">transparence</span><span class="p">,</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span><span class="p">)</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span><span class="p">)</span><span class="mi">1</span><span class="p">);</span>
            <span class="o">*</span><span class="n">pBlend1</span><span class="o">++</span> <span class="o">=</span> <span class="n">transparence</span> <span class="o">*</span> <span class="mi">255</span><span class="p">;</span>

            <span class="n">transparence</span> <span class="o">=</span> <span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="n">minHeight2</span><span class="p">)</span> <span class="o">/</span> <span class="n">fadeDist2</span><span class="p">;</span>
            <span class="n">transparence</span> <span class="o">=</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Math</span><span class="o">::</span><span class="n">Clamp</span><span class="p">(</span><span class="n">transparence</span><span class="p">,</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span><span class="p">)</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span><span class="p">)</span><span class="mi">1</span><span class="p">);</span>
            <span class="o">*</span><span class="n">pBlend2</span><span class="o">++</span> <span class="o">=</span> <span class="n">transparence</span> <span class="o">*</span> <span class="mi">255</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">blendMap1</span><span class="o">-&gt;</span><span class="n">dirty</span><span class="p">();</span>
    <span class="n">blendMap2</span><span class="o">-&gt;</span><span class="n">dirty</span><span class="p">();</span>
    <span class="n">blendMap1</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">();</span>
    <span class="n">blendMap2</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Pour terminer, comme avec un terrain seul, on libère la mémoire utilisée par le TerrainGroup.<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mTerrainGroup</span><span class="o">-&gt;</span><span class="n">freeTemporaryResources</span><span class="p">();</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Votre scène doit maintenant avoir une surface plus grande que la 
première fois (on a maintenant quatre terrains). Vous pouvez encore 
augmenter le nombre de terrains, mais attention, le temps de chargement 
augmente rapidement !<br>
<br>
<h3>Optimiser le temps de chargement</h3><br>
<br>
Vous avez certainement remarqué que la génération du terrain prend un 
temps conséquent lorsque le groupe s'agrandit. La création du terrain à 
partir du fichier heightmap nécessite en effet de convertir les données 
de l'image en données exploitables par le moteur.<br>
<br>
Afin de réduire le temps de chargement, il est possible d'enregistrer un
 fichier qui contient toutes les informations sur le terrain construit 
pour éviter de relire l'image à chaque lancement de l'application. 
L'inconvénient majeur est la place occupée par ces fichiers générés, qui
 contiennent beaucoup plus d'informations qu'une simple heightmap.<br>
<br>
En regardant la création du groupe de terrains, vous voyez que l'on a 
défini une convention de nommage pour des fichiers, mais qui est pour 
l'instant inutilisée.<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mTerrainGroup</span><span class="o">-&gt;</span><span class="n">setFilenameConvention</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">String</span><span class="p">(</span><span class="s">"TerrainDuZero"</span><span class="p">),</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">String</span><span class="p">(</span><span class="s">"dat"</span><span class="p">));</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Cette ligne sert lors de la sauvegarde de fichiers de terrain : ceux-ci 
seront nommés en commençant par « TerrainDuZero » suivi d'un nombre 
permettant d'identifier le terrain, puis de l'extension de fichier « dat
 ».<br>
<br>
Pour utiliser la sauvegarde des terrains, nous allons ajouter un 
attribut mTerrainCreated à la classe PremiereApplication qui permettra 
de savoir si l'on a généré le terrain à partir d'une image ou bien si 
l'on a lu un fichier terrain. Dans le premier cas, on saura qu'à la fin 
de la méthode createTerrain() il faut penser à sauvegarder les fichiers 
de terrain pour le prochain lancement de l'application.<br>
<br>
<span class="code">Code : C++ - PremiereApplication.h - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">bool</span> <span class="n">mTerrainCreated</span><span class="p">;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Initialisez sa valeur à <span class="code2 cpp"><span class="kc">false</span></span> au début de la méthode createTerrain().<br>
<br>
Maintenant, dans notre méthode definirTerrain(), il faut vérifier si le 
fichier terrain existe déjà ou bien s'il faut faire la génération depuis
 le heightmap comme le faisait jusqu'alors. Dans le second cas, on passe
 la variable mTerrainCreated à <span class="code2 cpp"><span class="kc">true</span></span>.<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">void</span> <span class="n">PremiereApplication</span><span class="o">::</span><span class="n">definirTerrain</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
<span class="ln-xtra">    <span class="k">if</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">ResourceGroupManager</span><span class="o">::</span><span class="n">getSingleton</span><span class="p">().</span><span class="n">resourceExists</span><span class="p">(</span><span class="n">mTerrainGroup</span><span class="o">-&gt;</span><span class="n">getResourceGroup</span><span class="p">(),</span> <span class="n">mTerrainGroup</span><span class="o">-&gt;</span><span class="n">generateFilename</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)))</span></span>
<span class="ln-xtra">    <span class="p">{</span></span>
<span class="ln-xtra">        <span class="n">mTerrainGroup</span><span class="o">-&gt;</span><span class="n">defineTerrain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span></span>
<span class="ln-xtra">    <span class="p">}</span></span>
<span class="ln-xtra">    <span class="k">else</span></span>
    <span class="p">{</span>
        <span class="n">Ogre</span><span class="o">::</span><span class="n">Image</span> <span class="n">img</span><span class="p">;</span>
        <span class="n">img</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"terrain.png"</span><span class="p">,</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">ResourceGroupManager</span><span class="o">::</span><span class="n">DEFAULT_RESOURCE_GROUP_NAME</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">img</span><span class="p">.</span><span class="n">flipAroundY</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="n">y</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">img</span><span class="p">.</span><span class="n">flipAroundX</span><span class="p">();</span>
        <span class="n">mTerrainGroup</span><span class="o">-&gt;</span><span class="n">defineTerrain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">img</span><span class="p">);</span>
<span class="ln-xtra">        <span class="n">mTerrainCreated</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span></span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Revenons sur la condition à tester pour vérifier l'existence du fichier généré.<br>
<br>
Grâce au Ogre::ResourceGroupManager, on peut vérifier s'il existe une 
ressource précise dans l'ensemble des ressources chargées au démarrage 
du programme. Les paramètres de la méthode sont le groupe de ressources 
dans lequel on veut chercher la ressource ainsi que le nom du fichier 
recherché. Vous voyez que le nom du fichier généré par le groupe de 
terrains dépend de ses coordonnées X et Y, ainsi que de la convention 
que l'on a définie au début.<br>
<br>
Si le fichier est trouvé, on appelle la méthode definieTerrain() avec 
seulement les coordonnées en paramètres. Dans ce cas, Ogre va aller 
chercher directement le fichier correspondant à ces coordonnées. Dans le
 cas contraire, on exécute le bloc que l'on avait précédemment et qui 
charge le terrain à partir de l'image de heightmap.<br>
<br>
Il ne reste plus qu'à demander la sauvegarde des fichiers si l'on a 
généré les terrains juste avant de libérer les ressources dans la 
méthode createTerrain() :<br>
<br>
<span class="code">Code : C++ - PremiereApplication.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="k">if</span><span class="p">(</span><span class="n">mTerrainCreated</span><span class="p">)</span>
    <span class="n">mTerrainGroup</span><span class="o">-&gt;</span><span class="n">saveAllTerrains</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Lancez l'application, le temps de chargement doit être un peu plus long 
qu'auparavant car l'ordinateur sauvegarde en même temps les fichiers 
générés sur le disque. Une fois que l'application est lancée, fermez-la 
puis relancez-la. Le temps de chargement doit normalement être meilleur.<br>
<br>
Vous devriez trouver les fichiers générés dans le dossier OgreSDK\media.
 Pour information, les miens font chacun une taille de 12 Mo.
		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_425390">Un ciel au-dessus de nos têtes</h2>
		<div class="ss_part_texte">
		Pour réaliser un ciel réaliste, Ogre possède trois solutions 
similaires très simples à utiliser. Le principe est de créer un objet 
représentant le ciel au-dessus de votre tête (la caméra, donc) et de le 
déplacer en même temps que vous bougez. Cette astuce permet de vous 
donner l'impression que vous êtes très loin du ciel et des nuages, ce 
qui est la base d'un ciel réaliste.<br>
<br>
<h3>Skybox</h3><br>
<br>
La skybox est une grande boîte texturée à l'intérieur qui permet 
d'afficher un ciel dans toutes les directions dans lesquelles vous 
regardez.<br>
<br>
Pour en installer une, c'est très simple, il y a une méthode dédiée :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">setSkyBox</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="s">"Examples/EveningSkyBox"</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Le premier paramètre indique si vous désirez activez la skybox, le 
second précise la texture que vous voulez utiliser pour celle-ci.<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/251045.jpg" alt="Image utilisateur"></div><br>
<br>
On peut ensuite jouer sur des paramètres qui ont des valeurs par défaut 
qui permettent de modifier la façon dont la skybox est rendue :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">setSkyBox</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="s">"Examples/EveningSkyBox"</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Le troisième paramètre est la distance à laquelle se trouve le bord de 
la skybox par rapport à la caméra, et le quatrième indique si la skybox 
doit être rendue ou non avant les autres objets de la scène.<br>
<br>
Si ce dernier paramètre est <span class="code2 cpp"><span class="kc">true</span></span>
 (valeur par défaut), tous les objets de la scène seront dessinés 
par-dessus la skybox et apparaitront donc devant celle-ci. En revanche, 
s'il est <span class="code2 cpp"><span class="kc">false</span></span>, 
les objets qui sont situés plus loin que la valeur du troisième 
paramètre ne seront pas affichés, car ils seront dessinés derrière la 
skybox !<br>
<br>
Par exemple, avec une distance de 1000, voici ce que l'on voit :<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/251046.jpg" alt="Image utilisateur"></div><br>
<br>
<div class="rmq information">On voit ici nettement l'angle dans le terrain tronqué, preuve que l'on est bien dans une boîte.</div><br>
<br>
Le terrain est affiché sur une moins grande distance, puisque tout ce 
qui est à plus de 1000 unités de la caméra se trouve derrière la skybox.<br>
<br>
La plupart du temps vous ne voudrez pas que cela se produise, c'est 
pourquoi ces deux derniers paramètres pourront être laissés par défaut.<br>
<br>
Des matériaux d'exemple pour les skybox sont fournis avec votre installation d'Ogre, dans le fichier <span class="courrier">OgreSDK\media\materials\scripts\Examples.material</span>. En voici quelques-uns que vous pouvez essayer pour avoir un aperçu.<br>
<br>
<ul>	
<li>EarlyMorningSkyBox</li>	
<li>MorningSkyBox</li>	
<li>EveningSkyBox</li>	
<li>StormySkyBox</li>	
<li>SpaceSkyBox</li>
</ul><br>
<br>
<h3>Skydome</h3><br>
<br>
Le principe du skydome est le même que pour la skybox ; cependant, la 
façon dont la texture est plaquée sur l'objet est différente. Vous êtes 
toujours dans une boîte, mais la texture est plaquée de manière 
sphérique, ce qui permet un peu plus de réalisme, mais laisse la face 
basse non texturée. On ne l'utilisera donc que si l'on a un sol pour 
masquer cette partie de la boîte.<br>
<br>
De même que pour une skybox, le code est très simple, mais s'enrichit de deux paramètres.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">setSkyDome</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="s">"Examples/CloudySky"</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Cette fois, vous devriez voir un ciel nuageux au-dessus de votre 
terrain. En allant au bord, vous verrez que la face inférieure est vide,
 et que la partie basse de la boîte voit sa texture déformée par la 
méthode de plaquage.<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/251053.jpg" alt="Image utilisateur"></div><br>
<br>
Les deux premiers paramètres sont identiques que pour la skybox : activation du dôme et choix de la texture.<br>
<br>
<div class="rmq erreur">Les textures spécialement créées pour les skybox
 ne sont pas adaptées aux dômes ! Étant donné que la texture n'est pas 
plaquée de la même façon, il n'y a généralement pas de compatibilité.</div><br>
<br>
Le paramètre suivant est la courbure du dôme, qui doit être comprise 
entre 2 et 65. Plus la valeur est faible, plus la courbure est faible et
 donc le ciel paraît sensiblement plus loin. En revanche, une valeur 
haute provoque moins de déformations, mais je trouve la différence 
minime, c'est pourquoi j'opte généralement une valeur faible.<br>
<br>
En quatrième paramètre, vous précisez le nombre de fois (ce n'est pas 
forcément un nombre entier) que la texture doit être plaquée sur une 
surface donnée. Cela permet d'adapter l'échelle de la texture à 
l'échelle du terrain.<br>
Avec une valeur un peu trop élevée (ici 32), on comprend un peu mieux ce que cela donne :<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/251054.jpg" alt="Image utilisateur"></div><br>
<br>
Les paramètres 5 et 6, non précisés ici, correspondent à la distance du 
skydome et à l'ordre de rendu, que nous avions déjà dans le cas de la 
skybox.<br>
<br>
<h3>Skyplane</h3><br>
<br>
Ce dernier objet est un peu différent des deux premiers, puisque l'on 
n'utilise plus une boîte mais un simple plan pour définir le ciel. Cela 
implique d'ores et déjà qu'il sera préférable de l'utiliser lorsque 
l'horizon n'est pas visible.<br>
<br>
Pour créer un skyplane, il faut commencer par créer un plan :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">Plane</span> <span class="n">plane</span><span class="p">;</span>
<span class="n">plane</span><span class="p">.</span><span class="n">d</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span>
<span class="n">plane</span><span class="p">.</span><span class="n">normal</span> <span class="o">=</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Vector3</span><span class="o">::</span><span class="n">NEGATIVE_UNIT_Y</span><span class="p">;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
On appelle ensuite la méthode correspondante du Scene Manager pour créer le skyplane.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">setSkyPlane</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="n">plane</span><span class="p">,</span> <span class="s">"Examples/SpaceSkyPlane"</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">75</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Notez que l'on donne le plan que l'on vient de créer à la méthode, ainsi
 que sa taille et le nombre de fois que la texture doit être plaquée 
pour les deux derniers paramètres.<br>
<br>
Comme précédemment, on a aussi quelques paramètres facultatifs pour notre ciel.<br>
<br>
Le paramètre 6 détermine à nouveau l'ordre d'affichage du ciel par rapport aux autres objets.<br>
<br>
Le suivant est un peu plus intéressant puisqu'il permet de corriger un peu l'inconvénient principal du skyplane, sa platitude.<br>
On peut donc ajouter une courbure au ciel, mais il faut alors définir le
 nombre de segments du plan dans ses deux dimensions (les deux derniers 
paramètres). Il n'est en effet pas possible de courber un plan qui n'est
 pas divisé par des segments. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/hihi.png" alt="^^" class="smilies"><br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">setSkyPlane</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="n">plane</span><span class="p">,</span> <span class="s">"Examples/SpaceSkyPlane"</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="mf">1.5f</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Enfin, il est bon de savoir que le skyplane à l'avantage d'être très 
économe en ressources et qu'il cohabite très bien avec le brouillard, si
 vous décidez d'en mettre dans la scène.<br>
<br>
<div class="rmq question">Finalement, quel est le meilleur choix pour mon ciel ?</div><br>
<br>
Tout dépend de la scène que vous avez.  S'il est possible de voir le 
ciel dans toutes les directions, vous devrez passer par une skybox pour 
satisfaire cette contrainte. Sinon, un skydome fera très bien l'affaire,
 tout comme le skyplane si vous avez un terrain à fort relief ou bien 
que l'horizon n'est pas visible.
		</div>
		<hr>
		
	<div id="chap_conclusion">
	Vous êtes maintenant prêts à créer de beaux environnements extérieurs 
mélangeant des textures de sol, le tout avec un ciel azur ou encore un 
coucher de soleil... Laissez parler votre créativité, les possibilités 
sont nombreuses !
	</div>
	
<div>
<br>

</div>

<hr>
<h2>Partie 2 : Au cœur de la bête</h2>
<div>
Dans la première partie, nous avons fait connaissance avec Ogre en 
douceur, en découvrant petit à petit comment peupler la scène avec des 
objets, des lumières et des ombres, comment gérer les entrées 
utilisateur... Cette deuxième partie se propose de mettre l'accent sur 
le fonctionnement interne d'Ogre, que j'ai volontairement occulté au 
début pour ne pas vous donner trop d'informations d'un coup.<br>
<br>
Vous êtes maintenant des utilisateurs avertis, je vous propose donc d'ouvrir le capot et de creuser un peu la mécanique d'Ogre !
</div>
	
	<hr>
	<h1 id="chap_439108">Une application à partir de zéro</h1>
	<div id="chap_intro">
	Maintenant que vous avez vu les manipulations basiques dans Ogre en 
utilisant les classes courantes, il va falloir s'attaquer au 
fonctionnement du moteur, plus précisément au squelette d'une 
application Ogre.<br>
<br>
Vous avez probablement envie de vous passer une bonne fois pour toutes 
de la classe ExampleApplication, que je vous ai imposée dans la première
 partie afin de ne pas vous effrayer. Il est donc temps de coder 
nous-mêmes le démarrage du moteur pour avoir enfin un contrôle total sur
 ce qui s'y passe et pouvoir par la suite créer notre propre framework 
pour s'adapter à nos besoins.<br>
<br>
Mettez vos gants, nous allons faire un tour dans la mécanique d'Ogre !<br>

	</div>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_439112">Préparation</h2>
		<div class="ss_part_texte">
		<h3>Les étapes</h3><br>
<br>
Dégrossissons un peu ce qui se passe lorsque Ogre est initialisé afin 
d'être prêt à l'emploi. On peut observer 8 principaux points à retenir 
et à effectuer dans l'ordre.<br>
<br>
<ol class="liste_1">
<li>La création d'un objet Root</li>
<li>La définition des ressources à utiliser</li>
<li>La création du système et de la fenêtre de rendu (appelée <span class="italique">RenderWindow</span>)</li>
<li>L'initialisation des ressources</li>
<li>La création de la scène</li>
<li>Le chargement éventuel de plugins additionnels</li>
<li>La création des frame listeners</li>
<li>Le lancement de la boucle infinie</li></ol><br>
<br>
<h3>Vocabulaire</h3><br>
<br>
<h4>Le Root</h4><br>
Le <span class="italique">Root</span> ("racine" en anglais) est l'objet de <strong><span class="souligne">base</span></strong>
 du moteur Ogre. C'est autour de lui que tout se construit et c'est donc
 lui qui doit être créé en premier lieu. Sa création permet 
l'initialisation du moteur afin de préparer le terrain pour les autres 
objets qui vont venir graviter autour.<br>
<br>
<br>
<h4>Les ressources</h4><br>
Lorsque je parle d'initialiser les ressources, certaines questions 
peuvent venir à l'esprit. Pourquoi faut-il définir les ressources à 
utiliser ? Pourquoi ne pas simplement demander d'ouvrir tel fichier 
lorsque l'on en a besoin dans le code, plutôt que de devoir utiliser un 
fichier listant les ressources et en plus s'embêter lors de 
l'initialisation du moteur ?<br>
<br>
La réponse est simple : nous travaillons dans une application où la 
vitesse est primordiale une fois que le joueur a les commandes. Charger 
les ressources à la volée demande du temps à l'ordinateur, puisqu'il 
doit aller chercher la ressource sur le disque dur, lire le fichier et 
mettre l'objet en mémoire afin de pouvoir l'utiliser. Toutes ces 
opérations sont généralement faites lorsque l'on démarre le jeu ou bien 
que l'on charge un niveau, ce sont les fameux chargements sur lesquels 
vous avez l'habitude de pester lorsqu'ils n'en finissent plus  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/langue.png" alt=":p" class="smilies">
 . Mais une fois que c'est chargé, plus besoin d'y toucher, on n'a plus 
qu'à s'occuper des mécanismes du jeu, ce qui permet de ne pas ralentir 
l'exécution par ces opérations.<br>
<br>
<br>
<h4>La RenderWindow</h4><br>
Un objet RenderWindow représente la fenêtre contenant la scène affichée à
 l'écran. Attention toutefois, la fenêtre dont je parle n'est pas la 
fenêtre avec la barre supérieure contenant les boutons "fermer", 
"agrandir" et "réduire", qui est la fenêtre du système d'exploitation. 
La RenderWindow est le "cadre" de la scène, qui est contenu dans la 
fenêtre du système d'exploitation. La différence est importante car si 
l'on programme un éditeur de scène par exemple, le fenêtre du programme 
contiendra non seulement la RenderWindow mais aussi des menus et des 
boites à outils qui n'ont rien à voir avec Ogre.<br>
<br>
<br>
<h4>La boucle infinie</h4><br>
C'est ici que se passe la quasi totalité du temps d'exécution du 
programme, une fois que l'initialisation est faite. On utilise une 
boucle infinie tout simplement parce que le principe de l'application 
que l'on veut créer est de rendre des images les unes après les autres 
le plus rapidement possible, jusqu'à ce que l'on décide de fermer le 
programme. Dans ce cas, il suffit de d'arrêter la boucle infinie et 
d'exécuter le code qui suit consistant généralement à décharger la 
mémoire utilisée en détruisant les objets créés, etc.<br>
<br>
Il existe une méthode de l'objet root qui permet de lancer 
automatiquement une boucle infinie prédéfinie, c'est la méthode 
Root::startRendering(). Cependant, il est aussi possible de définir une 
boucle infinie personnalisée et d'y mettre les instructions que l'on 
souhaite.<br>
<br>
<br>
<h3>Le projet</h3><br>
<br>
La création du projet se fait de la même façon que pour le premier 
projet que nous avions créé, les dossiers includes et les bibliothèques à
 ajouter sont les mêmes.<br>
<br>
En ce qui concerne le dossier de l’exécutable, il faudra à nouveau 
copier les DLL fournies avec Ogre ainsi que les fichiers resources.cfg 
et plugins.cfg. Comme je l'ai précisé dans les premiers chapitres, ces 
deux fichiers de configuration contiennent respectivement les ressources
 et les plugins à charger dans l'application à son lancement. Il est 
maintenant temps de simplifier un peu tout cela.<br>
<br>
Le fichier resources.cfg liste par défaut tous les répertoires contenus 
dans le dossier media fourni avec le SDK d'Ogre, ce qui signifie que 
depuis le début de ce tutoriel, nous avons à chaque fois chargé <span class="souligne">toutes</span> les ressources disponibles dans ce répertoire.<br>
Pour cette application partant de zéro, nous allons choisir nous-mêmes 
les ressources à charger afin de ne pas mettre en mémoire de fichiers 
inutiles et de gagner en temps de chargement. Vous verrez en lançant le 
programme à la fin de ce chapitre que le temps de démarrage est 
incomparable avec ce qu'on avait jusqu'à maintenant. Vu que vous devriez
 commencer à vous familiariser avec les composants d'Ogre, il est bien 
temps de faire un peu d'optimisation. <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/siffle.png" alt=":-°" class="smilies"> <br>
<br>
Créons donc un dossier intitulé <span class="italique">media</span> dans le répertoire de compilation du projet Ogre, et ajoutons les fichiers suivants :<br>
<ul>	
<li>"penguin.mesh" contenu dans le dossier OgreSDK\media\models</li>	
<li>"penguin.jpg" qui se trouve à OgreSDK\media\materials\textures</li>	
<li>"Penguin.material" dans OgreSDK\media\materials\scripts</li>
</ul><br>
<br>
Il ne reste plus qu'à mettre une ligne unique (et supprimer tout le 
reste) dans notre fichier resources.cfg pour dire à Ogre d'aller 
chercher les ressources que nous venons de copier.<br>
<br>
<span class="code">Code : Autre - resources.cfg - <a href="#" class="select_code">Sélectionner</a></span><div class="code2"><table class="syntaxtable"><tbody><tr><td class="linenos"><pre>1
</pre></td><td class="code"><div class="syntax"><pre>FileSystem=./media</pre></div></td></tr></tbody></table></div><br>
<br>
<div class="rmq information">Si vous voulez organiser vos fichiers de 
ressources avec des sous-dossiers, il faudra rajouter une ligne pour 
chacun des sous-dossiers, comme c'est fait dans le fichier resources.cfg
 par défaut. Ogre ne parcourt pas toute l'arborescence d'un dossier mais
 seulement les fichiers qui sont directement présents dans celui-ci !</div><br>
<br>
Maintenant que le fichier de ressources est simplifié, nous pouvons 
aussi alléger le fichier plugins.cfg en supprimant tout à l'exception 
des API graphiques que nous utiliserons (DirectX ou OpenGL donc). Il est
 possible de modifier l'emplacement des DLL listées dans ce fichier en 
éditant la ligne <span class="italique">PluginFolder</span> qui pointe par défaut sur le répertoire courant.<br>
<br>
Voici donc mon fichier plugins.cfg après épuration :<br>
<br>
<span class="code">Code : Autre - plugins.cfg - <a href="#" class="select_code">Sélectionner</a></span><div class="code2"><table class="syntaxtable"><tbody><tr><td class="linenos"><pre>1
2
3
4
</pre></td><td class="code"><div class="syntax"><pre>PluginFolder=.

Plugin=RenderSystem_Direct3D9
Plugin=RenderSystem_GL</pre></div></td></tr></tbody></table></div><br>
<br>
Nous n'avons donc plus que trois binaires de bibliothèques à placer dans
 le répertoire de l’exécutable (sous windows) : OgreMain, 
RenderSystem_GL et RenderSystem_Direct3D9.<br>

		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_439110">Au début, une fenêtre</h2>
		<div class="ss_part_texte">
		<h3>Mise en place</h3><br>
<br>
Créez un premier fichier main.cpp qui contiendra le code de la fonction 
main(), c'est le même que précédemment, mais cette fois j'ai appelé ma 
classe AppDemarrage, vu qu'on n'en est plus à notre premier coup d'essai
 !<br>
<br>
<span class="code">Code : C++ - main.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="syntax"><pre><span class="cp">#include "AppDemarrage.h"</span>

<span class="cp">#if OGRE_PLATFORM == OGRE_PLATFORM_WIN32</span>
<span class="cp">#define WIN32_LEAN_AND_MEAN</span>
<span class="cp">#include "windows.h"</span>
<span class="cp">#endif</span>

<span class="cp">#if OGRE_PLATFORM == OGRE_PLATFORM_WIN32</span>
<span class="n">INT</span> <span class="n">WINAPI</span> <span class="n">WinMain</span><span class="p">(</span> <span class="n">HINSTANCE</span> <span class="n">hInst</span><span class="p">,</span> <span class="n">HINSTANCE</span><span class="p">,</span> <span class="n">LPSTR</span> <span class="n">strCmdLine</span><span class="p">,</span> <span class="n">INT</span> <span class="p">)</span>
<span class="cp">#else</span>
<span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="cp">#endif</span>
<span class="p">{</span>
    <span class="n">AppDemarrage</span> <span class="n">app</span><span class="p">;</span>

    <span class="k">try</span> <span class="p">{</span>
        <span class="n">app</span><span class="p">.</span><span class="n">start</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span><span class="p">(</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Exception</span><span class="o">&amp;</span> <span class="n">e</span> <span class="p">)</span> <span class="p">{</span>
<span class="cp">#if OGRE_PLATFORM == OGRE_PLATFORM_WIN32</span>
        <span class="n">MessageBox</span><span class="p">(</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">getFullDescription</span><span class="p">().</span><span class="n">c_str</span><span class="p">(),</span> <span class="s">"An exception has occured!"</span><span class="p">,</span> <span class="n">MB_OK</span> <span class="o">|</span> <span class="n">MB_ICONERROR</span> <span class="o">|</span> <span class="n">MB_TASKMODAL</span><span class="p">);</span>
<span class="cp">#else</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">"An exception has occured: "</span> <span class="o">&lt;&lt;</span>
            <span class="n">e</span><span class="p">.</span><span class="n">getFullDescription</span><span class="p">().</span><span class="n">c_str</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="cp">#endif</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
On crée ensuite la classe AppDemarrage dans un header : constructeur, 
destructeur, la fonction start() qui est appelée par le main et un 
attribut Root pour commencer. Nous ajouterons les objets petit à petit.<br>
<br>
<span class="code">Code : C++ - AppDemarrage.h - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="syntax"><pre><span class="cp">#include &lt;OgreException.h&gt;</span>

<span class="k">class</span> <span class="nc">AppDemarrage</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="n">AppDemarrage</span><span class="p">();</span>
    <span class="o">~</span><span class="n">AppDemarrage</span><span class="p">();</span>

    <span class="kt">bool</span> <span class="n">start</span><span class="p">();</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">Root</span> <span class="o">*</span><span class="n">mRoot</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Dans votre fichier AppDemarrage.cpp, initialisez le Root dans le 
constructeur et détruisez-le dans le destructeur. La fonction start() 
est vide pour l'instant.<br>
<br>
<span class="code">Code : C++ - AppDemarrage.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">AppDemarrage</span><span class="o">::</span><span class="n">AppDemarrage</span><span class="p">()</span> <span class="o">:</span> <span class="n">mRoot</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
<span class="n">AppDemarrage</span><span class="o">::~</span><span class="n">AppDemarrage</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">delete</span> <span class="n">mRoot</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">bool</span> <span class="n">AppDemarrage</span><span class="o">::</span><span class="n">start</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<div class="rmq information">Nous rajouterons plusieurs attributs à 
notre classe au cours de ce chapitre. Je ne reviendrai pas sur le 
constructeur par la suite, pensez donc à chaque fois à initialiser ces 
pointeurs avec la valeur 0 pour éviter d'avoir n'importe quoi dedans.</div><br>
<br>
<br>
<h3>Le Root</h3><br>
<br>
Si vous avez lu la première partie de ce chapitre, vous devez vous 
souvenir que la première chose à faire est de créer le Root avant toute 
autre chose. Celui-ci prend plusieurs paramètres :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">Root</span><span class="o">::</span><span class="n">Root</span><span class="p">(</span><span class="k">const</span> <span class="n">String</span> <span class="o">&amp;</span><span class="n">pluginFileName</span> <span class="o">=</span> <span class="s">"plugins.cfg"</span><span class="p">,</span> <span class="k">const</span> <span class="n">String</span> <span class="o">&amp;</span><span class="n">configFileName</span> <span class="o">=</span> <span class="s">"ogre.cfg"</span><span class="p">,</span> <span class="k">const</span> <span class="n">String</span> <span class="o">&amp;</span><span class="n">logFileName</span> <span class="o">=</span> <span class="s">"Ogre.log"</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Le premier est le nom du fichier de plugins à charger, le second est le 
fichier de configuration d'Ogre, qui retient les préférences que vous 
entrez dans la boite de dialogue habituellement pour vous éviter de les 
retaper. Enfin, vous pouvez choisir le nom du fichier de log.<br>
<br>
J'ai laissé les paramètres par défaut, voici donc la première ligne de ma fonction start().<br>
<br>
<span class="code">Code : C++ - AppDemarrage.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mRoot</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Root</span><span class="p">(</span><span class="s">"plugins.cfg"</span><span class="p">,</span> <span class="s">"ogre.cfg"</span><span class="p">,</span> <span class="s">"Ogre.log"</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<div class="rmq attention">Afin de simplifier le code et les 
explications, je n'écris pas de directives de préprocesseur pour tenir 
compte des différentes configurations de compilation possibles. Le 
fichier plugins.cfg n'a par exemple pas le même nom en debug si vous 
utilisez les fichiers fournis avec Ogre, faites donc attention à ce que 
les noms correspondent aux fichiers que vous avez dans vos dossiers.</div><br>
<br>
<h3>Chargement des ressources</h3><br>
<br>
La prochaine étape consiste à charger les ressources à utiliser en 
lisant le fichier resources.cfg. On utilise pour cela la classe 
ConfigFile qui permet de s'occuper de la lecture du fichier de 
ressources avec la méthode load().<br>
<br>
<span class="code">Code : C++ - AppDemarrage.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">ConfigFile</span> <span class="n">configFile</span><span class="p">;</span>
<span class="n">configFile</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"resources.cfg"</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<br>
Une fois le fichier de ressources chargé et lu, il faut ajouter les 
chemins indiqués dans le gestionnaire des groupes de ressources (ou <span class="italique">ResourceGroupManager</span>).
 Ceci se fait grâce à un itérateur de type SectionIterator conçu 
spécialement pour les fichiers de configuration et que le l'on récupère 
via la méthode getSectionIterator() de notre ConfigFile.<br>
<br>
<span class="code">Code : C++ - AppDemarrage.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">ConfigFile</span><span class="o">::</span><span class="n">SectionIterator</span> <span class="n">seci</span> <span class="o">=</span> <span class="n">configFile</span><span class="p">.</span><span class="n">getSectionIterator</span><span class="p">();</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
On utilise ensuite cet itérateur pour parcourir les éléments du fichier 
de configuration ligne par ligne. Pour chaque ligne, on ajoute le 
dossier référencé à l'ensemble des dossiers de ressources pris en compte
 par l'application grâce à la méthode addResourceLocation().<br>
<br>
<span class="code">Code : C++ - AppDemarrage.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">String</span> <span class="n">secName</span><span class="p">,</span> <span class="n">typeName</span><span class="p">,</span> <span class="n">archName</span><span class="p">;</span>
<span class="k">while</span> <span class="p">(</span><span class="n">seci</span><span class="p">.</span><span class="n">hasMoreElements</span><span class="p">())</span>
<span class="p">{</span>
    <span class="n">secName</span> <span class="o">=</span> <span class="n">seci</span><span class="p">.</span><span class="n">peekNextKey</span><span class="p">();</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">ConfigFile</span><span class="o">::</span><span class="n">SettingsMultiMap</span> <span class="o">*</span><span class="n">settings</span> <span class="o">=</span> <span class="n">seci</span><span class="p">.</span><span class="n">getNext</span><span class="p">();</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">ConfigFile</span><span class="o">::</span><span class="n">SettingsMultiMap</span><span class="o">::</span><span class="n">iterator</span> <span class="n">i</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">settings</span><span class="o">-&gt;</span><span class="n">begin</span><span class="p">();</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">settings</span><span class="o">-&gt;</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">typeName</span> <span class="o">=</span> <span class="n">i</span><span class="o">-&gt;</span><span class="n">first</span><span class="p">;</span>
        <span class="n">archName</span> <span class="o">=</span> <span class="n">i</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">;</span>
        <span class="n">Ogre</span><span class="o">::</span><span class="n">ResourceGroupManager</span><span class="o">::</span><span class="n">getSingleton</span><span class="p">().</span><span class="n">addResourceLocation</span><span class="p">(</span>
            <span class="n">archName</span><span class="p">,</span> <span class="n">typeName</span><span class="p">,</span> <span class="n">secName</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Il est maintenant temps de commencer le chargement du moteur en 
lui-même. Pour cela, on commence par vérifier si une configuration 
existante est écrite sur le disque, via la méthode restoreConfig() de 
l'objet root. Si elle retourne la valeur <span class="code2 cpp"><span class="kc">false</span></span>
 (c'est-à-dire qu'aucun fichier de configuration n'existe ou bien que le
 chargement a échoué), on appelle la fenêtre de choix de configuration 
avec showConfigDialog(), qui renvoie <span class="code2 cpp"><span class="kc">true</span></span> si l'utilisateur clique sur le bouton OK. Si ces deux méthodes retournent une valeur fausse, on quitte l'application.<br>
<br>
<br>
<span class="code">Code : C++ - AppDemarrage.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="syntax"><pre><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">mRoot</span><span class="o">-&gt;</span><span class="n">restoreConfig</span><span class="p">()</span> <span class="o">||</span> <span class="n">mRoot</span><span class="o">-&gt;</span><span class="n">showConfigDialog</span><span class="p">()))</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<h4>Configuration manuelle du RenderSystem</h4><br>
<br>
Il est aussi tout à fait possible de définir la configuration par 
vous-même, sans passer par la fenêtre de configuration fournie par Ogre 
ni par la restauration automatique des paramètres précédents. Ce n'est 
pas forcément plus simple, mais si vous voulez changer la fenêtre par 
défaut au lancement c'est la solution qu'il faudra adopter.<br>
Il faut pour cela récupérer le <span class="italique">RenderSystem</span>,
 qui est la bibliothèque graphique qui va s'occuper du rendu du moteur 
(DirectX ou bien OpenGL), puis le paramétrer, c'est-à-dire indiquer la 
bibliothèque graphique qui va s'occuper du rendu du moteur (DirectX ou 
bien OpenGL), de la résolution, de l'affichage (ou non) en plein 
écran...<br>
<br>
Vous pouvez par exemple intégrer un code comme celui-ci pour utiliser 
DirectX en tant que RenderSystem, sans mode plein écran, avec une 
résolution définie et la synchronisation verticale :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="syntax"><pre><span class="c1">// variante : configuration sans boite de dialogue</span>
<span class="n">Ogre</span><span class="o">::</span><span class="n">RenderSystem</span> <span class="o">*</span><span class="n">rs</span> <span class="o">=</span> <span class="n">mRoot</span><span class="o">-&gt;</span><span class="n">getRenderSystemByName</span><span class="p">(</span><span class="s">"Direct3D9 Rendering Subsystem"</span><span class="p">);</span> <span class="c1">// Pour OpenGL : "OpenGL Rendering Subsystem"</span>
<span class="n">mRoot</span><span class="o">-&gt;</span><span class="n">setRenderSystem</span><span class="p">(</span><span class="n">rs</span><span class="p">);</span>
<span class="n">rs</span><span class="o">-&gt;</span><span class="n">setConfigOption</span><span class="p">(</span><span class="s">"Full Screen"</span><span class="p">,</span> <span class="s">"No"</span><span class="p">);</span>
<span class="n">rs</span><span class="o">-&gt;</span><span class="n">setConfigOption</span><span class="p">(</span><span class="s">"Video Mode"</span><span class="p">,</span> <span class="s">"1280 x 800 @ 32-bit colour"</span><span class="p">);</span>
<span class="n">rs</span><span class="o">-&gt;</span><span class="n">setConfigOption</span><span class="p">(</span><span class="s">"VSync"</span><span class="p">,</span> <span class="s">"Yes"</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
On peut bien sûr envisager de créer votre propre fenêtre de 
configuration en récupérant les différents RenderSystem disponibles sur 
notre machine et en listant les options qui leur sont associées. Deux 
méthodes nous sont fournies pour faire cette manipulation :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="k">const</span> <span class="n">RenderSystemList</span><span class="o">&amp;</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Root</span><span class="o">::</span><span class="n">getAvailableRenderers</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="k">virtual</span> <span class="n">ConfigOptionMap</span><span class="o">&amp;</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">RenderSystem</span><span class="o">::</span><span class="n">getConfigOptions</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Une fois les options de configuration récupérées, vous connaitrez les 
paires clé/valeur à entrer en paramètres de la méthode 
setConfigOption().<br>
<br>
Voici un exemple sommaire de récupération des clés et des valeurs 
associées (on suppose que le RenderSystem a été récupéré juste avant) :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">ConfigOptionMap</span> <span class="n">map</span> <span class="o">=</span> <span class="n">rs</span><span class="o">-&gt;</span><span class="n">getConfigOptions</span><span class="p">();</span>
<span class="k">for</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">ConfigOptionMap</span><span class="o">::</span><span class="n">const_iterator</span> <span class="n">it</span> <span class="o">=</span> <span class="n">map</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">map</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="n">it</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">it</span><span class="o">-&gt;</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="c1">// affiche la clé, par exemple "Full Screen"</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">it</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">.</span><span class="n">possibleValues</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>           <span class="c1">// affiche les valeurs possible pour cette clé</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"  "</span> <span class="o">&lt;&lt;</span> <span class="n">it</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">.</span><span class="n">possibleValues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="c1">// par exemple : "Yes", "No"</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Encore une fois, je vous invite à parcourir la <a href="http://www.ogre3d.org/docs/api/html/annotated.html">documentation</a> associée si vous voulez utiliser ces fonctions avec plus de détails.<br>
<br>
<h3>La RenderWindow</h3><br>
<br>
Le système étant initialisé, on crée la fenêtre de l'application, c'est 
la RenderWindow. On la définit comme attribut de la classe AppDemarrage 
et on la crée grâce à la méthode initialise() de l'objet root.<br>
<br>
<span class="code">Code : C++ - AppDemarrage.h - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">RenderWindow</span><span class="o">*</span> <span class="n">mWindow</span><span class="p">;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<span class="code">Code : C++ - AppDemarrage.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mWindow</span> <span class="o">=</span> <span class="n">mRoot</span><span class="o">-&gt;</span><span class="n">initialise</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="s">"Une application de zér0"</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
La méthode initialise() prend comme premier paramètre un booléen 
indiquant si Ogre doit créer lui-même la fenêtre dans laquelle le rendu 
sera fait. Ici, c'est ce que nous voulons, puisque nous n'avons que la 
scène à rendre. En revanche, si vous voulez utiliser un gestionnaire de 
fenêtres spécifique ou même embarquer votre rendu dans une application 
(un éditeur de scène par exemple), vous aurez besoin de créer vous-même 
la fenêtre.<br>
<br>
Comme je décide de créer la fenêtre avec Ogre, je peux aussi indiquer le titre de celle-ci en second paramètre.<br>
<br>
<br>
Dans le cas où vous désirez créer la fenêtre à la main, il faut alors 
appeler la méthode createRenderWindow() de la classe Root. La méthode 
dépendant notamment du système d'exploitation, je ne le détaillerai pas 
ici, je vous invite donc à regarder la <a href="http://www.ogre3d.org/docs/api/html/classOgre_1_1Root.html#a537b7d1d0937f799cfe4936f6b672620">documentation</a> si ce point vous intéresse.<br>
<br>
<br>
<h3>Initialisation des ressources</h3><br>
<br>
L'initialisation des ressources se fait de façon très simple depuis que 
le fichier de ressources a été parcouru, grâce à la méthode 
initialiseAllResourceGroups() du gestionnaire de ressources. Si l'on ne 
veut pas initialiser toutes nos ressources d'un coup, mais seulement un 
groupe, il existe la méthode initialiseResourceGroup() qui permet de ne 
charger qu'un nombre restreint de ressources et qui a la prototype 
suivant :<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">void</span> <span class="n">initialiseResourceGroup</span> <span class="p">(</span><span class="k">const</span> <span class="n">String</span> <span class="o">&amp;</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Cette méthode est utile dans de grosses applications dans lesquelles il 
n'est pas nécessaire d'avoir toutes les ressources à disposition à tout 
instant. Dans notre cas, nous allons tout charger au lancement de 
l'application.<br>
<br>
<span class="code">Code : C++ - AppDemarrage.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">TextureManager</span><span class="o">::</span><span class="n">getSingleton</span><span class="p">().</span><span class="n">setDefaultNumMipmaps</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="n">Ogre</span><span class="o">::</span><span class="n">ResourceGroupManager</span><span class="o">::</span><span class="n">getSingleton</span><span class="p">().</span><span class="n">initialiseAllResourceGroups</span><span class="p">();</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Comme vous le voyez, il est possible de définir le nombre de mipmaps par
 défaut pour les textures chargées. Cette méthode (si on veut l'appeler,
 ce n'est pas obligatoire) doit être appelée avant d'initialiser les 
ressources pour être prise en compte.<br>
<br>
<div class="rmq question">Doucement, qu'est-ce que c'est qu'une mipmap ?  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/unsure.gif" alt=":euh:" class="smilies"> </div><br>
<br>
Pour faire simple, disons que chaque texture d'une taille donnée peut 
être recopiée en une version allégée de taille plus faible, dans le but 
d'être affichée lorsque le niveau de détail demandé est faible (si un 
objet est loin de la caméra notamment). Plutôt que de calculer la 
texture réduite en temps réel à partir de l'original, le moteur va créer
 en même temps que les textures chargées des textures de taille moindre 
qui se substitueront à l'originale si le détail demandé est faible.<br>
<br>
La taille des textures générées est à chaque fois d'un quart (en 
surface) de la précédente. Par exemple, pour une texture de 256x256 
pixels, on pourra avoir 8 mipmaps de 128, 64, 32, 16, 8, 4, 2 et 1 
pixels de coté. Si la texture affichée prend sur l'écran une taille de 
100 pixels, le moteur fera une interpolation en les deux plus proches 
(128 et 64) pour obtenir un résultat convainquant.<br>
<br>
La méthode setDefaultNumMipmaps() définit donc combien de mipmaps par texture on est censé avoir.<br>
<br>
<br>
<h3>La scène</h3><br>
<br>
On revient maintenant en terrain connu avec la création du scene 
manager, que nous avons utilisé dans toute la première partie de ce 
cours. Le premier paramètre est le type de scene manager que l'on veut 
utiliser (ici le type par défaut), puis le nom du scene manager peut 
être facultativement mis en second argument.<br>
<br>
<span class="code">Code : C++ - AppDemarrage.h - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">SceneManager</span><span class="o">*</span> <span class="n">mSceneMgr</span><span class="p">;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<span class="code">Code : C++ - AppDemarrage.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mSceneMgr</span> <span class="o">=</span> <span class="n">mRoot</span><span class="o">-&gt;</span><span class="n">createSceneManager</span><span class="p">(</span><span class="s">"DefaultSceneManager"</span><span class="p">,</span> <span class="s">"Mon Scene Manager"</span><span class="p">);</span>
<span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">setAmbientLight</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">ColourValue</span><span class="p">(</span><span class="mf">1.0f</span><span class="p">,</span> <span class="mf">1.0f</span><span class="p">,</span> <span class="mf">1.0f</span><span class="p">));</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Afin de voir quelque chose au rendu, nous allons créer une scène basique
 qui permettra de vérifier que notre code fonctionne correctement. La 
démarche est la même que ce que nous avons fait dans la première partie :
 créer une caméra, un mesh et ajouter l'ensemble à la scène.<br>
<br>
<span class="code">Code : C++ - AppDemarrage.h - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">Camera</span><span class="o">*</span> <span class="n">mCamera</span><span class="p">;</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<br>
<span class="code">Code : C++ - AppDemarrage.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mCamera</span> <span class="o">=</span> <span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">createCamera</span><span class="p">(</span><span class="s">"PlayerCam"</span><span class="p">);</span>
<span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">setPosition</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">));</span>
<span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">lookAt</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
<span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">setNearClipDistance</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>

<span class="n">Ogre</span><span class="o">::</span><span class="n">Viewport</span><span class="o">*</span> <span class="n">vp</span> <span class="o">=</span> <span class="n">mWindow</span><span class="o">-&gt;</span><span class="n">addViewport</span><span class="p">(</span><span class="n">mCamera</span><span class="p">);</span>
<span class="n">vp</span><span class="o">-&gt;</span><span class="n">setBackgroundColour</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">ColourValue</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
<span class="n">mCamera</span><span class="o">-&gt;</span><span class="n">setAspectRatio</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span><span class="p">(</span><span class="n">vp</span><span class="o">-&gt;</span><span class="n">getActualWidth</span><span class="p">())</span> <span class="o">/</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Real</span><span class="p">(</span><span class="n">vp</span><span class="o">-&gt;</span><span class="n">getActualHeight</span><span class="p">()));</span>

<span class="n">Ogre</span><span class="o">::</span><span class="n">Entity</span> <span class="o">*</span><span class="n">ent</span> <span class="o">=</span> <span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">createEntity</span><span class="p">(</span><span class="s">"pinguin"</span><span class="p">,</span> <span class="s">"penguin.mesh"</span><span class="p">);</span>
<span class="n">Ogre</span><span class="o">::</span><span class="n">SceneNode</span> <span class="o">*</span><span class="n">node</span> <span class="o">=</span> <span class="n">mSceneMgr</span><span class="o">-&gt;</span><span class="n">getRootSceneNode</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">createChildSceneNode</span><span class="p">();</span>
<span class="n">node</span><span class="o">-&gt;</span><span class="n">attachObject</span><span class="p">(</span><span class="n">ent</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Une fois ce code écrit, la scène est construite, la fenêtre créée, tout 
est prêt. Pourtant si vous exécutez l'application, la fenêtre se fermera
 dès que tout sera chargé : la fonction start() se termine, donc repasse
 le contrôle au main() qui termine le programme.<br>
<br>
Il manque donc une chose essentielle au programme, c'est la boucle de rendu.<br>
<br>
<br>
<h3>La boucle de rendu</h3><br>
<br>
L'objet root implémente une méthode startRendering() qui s'occupe de 
faire tourner la boucle infinie dans laquelle se fait le rendu. Cette 
boucle infinie convient parfaitement à notre usage, vous pouvez 
d'ailleur l'ajouter à la fin de la méthode start().<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mRoot</span><span class="o">-&gt;</span><span class="n">startRendering</span><span class="p">();</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Le mesh du pingouin doit alors s'afficher devant la caméra de la même 
manière que le faisait la tête d'ogre dans les chapitres précédents. Il 
n'est bien sûr pas possible de se déplacer vu que l'on ne s'est pas 
encore occupé de mettre en place OIS.<br>
<br>
Tout fonctionne donc, mais pour voir un peu plus en détails comment nous
 pourrions faire quelque chose de fonctionnel à la main, nous allons 
créer notre propre boucle infinie.<br>
<br>
<div class="rmq information">Dans le cas où l'on ne veut pas rafraichir 
l'écran rapidement, dans le cas d'un éditeur par exemple, on ne passera 
pas par une boucle infinie mais on se contentera de rafraichir l'écran 
lorsque l'on se déplace ou que la scène est modifiée.</div><br>
<br>
Pour faire la boucle infinie, commencez par coder une boucle while() ayant pour condition <span class="code2 cpp"><span class="kc">true</span></span>.
 Dans cette boucle, l'objectif est de rendre une image à chaque tour de 
boucle, grâce à la méthode renderOneFrame() de l'objet root.<br>
<br>
Cela suffit a priori pour rendre la scène, mais deux problèmes apparaissent au lancement de l'application.<br>
Premièrement, l'objet RenderWindow ne se met pas à jour, et le programme
 ne semble plus répondre (vous aurez un message de plantage sous 
windows).<br>
Deuxièmement, même si l'on ferme la fenêtre, le processus continue de 
tourner en arrière plan, c'est-à-dire que le programme ne s'arrête pas !<br>
<br>
Pour contourner le premier problème, il faut appeler à chaque tour la 
méthode suivante qui prend en charge le rafraichissement de la fenêtre :<br>
<br>
<span class="code">Code : C++ - AppDemarrage.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">WindowEventUtilities</span><span class="o">::</span><span class="n">messagePump</span><span class="p">();</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Ensuite, pour que l'application s’arrête lorsque l'on ferme la fenêtre, 
il suffit de vérifier si celle-ci est fermée, auquel cas on utilise la 
directive <span class="code2 cpp"><span class="k">return</span></span> pour quitter la méthode start() et a fortiori la boucle infinie.<br>
<br>
Avec ces deux ajouts, votre boucle doit être codée comme dans l'exemple suivant.<br>
<br>
<span class="code">Code : C++ - AppDemarrage.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="syntax"><pre><span class="k">while</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">WindowEventUtilities</span><span class="o">::</span><span class="n">messagePump</span><span class="p">();</span>
 
    <span class="k">if</span><span class="p">(</span><span class="n">mWindow</span><span class="o">-&gt;</span><span class="n">isClosed</span><span class="p">())</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
 
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">mRoot</span><span class="o">-&gt;</span><span class="n">renderOneFrame</span><span class="p">())</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Vous pouvez maintenant lancer l'application, qui devrait vous afficher un pingouin au centre de l'écran.<br>
<br>
<div class="centre"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/275611.png" alt="Image utilisateur"></div><br>

		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_439113">Ajout du Frame Listener</h2>
		<div class="ss_part_texte">
		Nous allons mettre en place le Frame Listener qui nous permet entre 
autres de capturer les entrées du clavier et de la souris fournies par 
OIS, que nous démarrerons dans la partie suivante.<br>
<br>
J'ai décidé de créer une classe InputListener qui hérite de 
FrameListener et dans laquelle nous allons mettre tout le code 
correspondant à la gestion des entrées.<br>
<br>
<span class="code">Code : C++ - InputListener.h - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="syntax"><pre><span class="cp">#include &lt;OIS/OIS.h&gt;</span>
<span class="k">class</span> <span class="nc">InputListener</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">FrameListener</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">RenderWindow</span><span class="o">*</span> <span class="n">mWindow</span><span class="p">;</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">Camera</span><span class="o">*</span>       <span class="n">mCamera</span><span class="p">;</span>

    <span class="n">OIS</span><span class="o">::</span><span class="n">InputManager</span><span class="o">*</span>  <span class="n">mInputManager</span><span class="p">;</span>
    <span class="n">OIS</span><span class="o">::</span><span class="n">Mouse</span><span class="o">*</span>         <span class="n">mMouse</span><span class="p">;</span>
    <span class="n">OIS</span><span class="o">::</span><span class="n">Keyboard</span><span class="o">*</span>      <span class="n">mKeyboard</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Nous devons bien penser à inclure le fichier OIS.h pour pouvoir utiliser
 les trois derniers attributs qui sont le gestionnaire d'entrées, la 
souris et le clavier.<br>
<br>
Le constructeur reçoit deux arguments qui sont la RenderWindow de 
l'application dont nous aurons besoin par la suite et la caméra créée 
dans AppDemarrage.<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">InputListener</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">RenderWindow</span> <span class="o">*</span><span class="n">wnd</span><span class="p">,</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Camera</span> <span class="o">*</span><span class="n">camera</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">mWindow</span> <span class="o">=</span> <span class="n">wnd</span><span class="p">;</span>
    <span class="n">mCamera</span> <span class="o">=</span> <span class="n">camera</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Ensuite, on réécrit la méthode frameRenderingQueued() qui est appelée, 
si vous vous souvenez bien, pendant que l'image en cours est rendue. 
Nous allons gérer ici uniquement la touche echap pur pouvoir quitter 
l'application facilement, mais rien ne vous empêche d'implémenter le 
déplacement de la caméra, cela vous permettra de vérifier si vous avez 
bien retenu le chapitre 6 !<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">bool</span> <span class="n">InputListener</span><span class="o">::</span><span class="n">frameRenderingQueued</span><span class="p">(</span><span class="k">const</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">FrameEvent</span><span class="o">&amp;</span> <span class="n">evt</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">mWindow</span><span class="o">-&gt;</span><span class="n">isClosed</span><span class="p">())</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>

    <span class="n">mKeyboard</span><span class="o">-&gt;</span><span class="n">capture</span><span class="p">();</span>
    <span class="n">mMouse</span><span class="o">-&gt;</span><span class="n">capture</span><span class="p">();</span>
 
    <span class="k">if</span><span class="p">(</span><span class="n">mKeyboard</span><span class="o">-&gt;</span><span class="n">isKeyDown</span><span class="p">(</span><span class="n">OIS</span><span class="o">::</span><span class="n">KC_ESCAPE</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
 
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Enfin, après la création de la scène, on appelle une nouvelle méthode 
createFrameListener (à ajouter dans la classe AppDemarrage) qui va 
instancier notre Frame Listener personnalisé et l'ajouter en tant que 
FrameListener dans l'objet Root pour que les appels soient automatiques.<br>
<br>
<span class="code">Code : C++ - AppDemarrage.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">createScene</span><span class="p">();</span>
<span class="ln-xtra"><span class="n">createFrameListener</span><span class="p">();</span></span>

<span class="c1">// boucle de rendu</span>
<span class="c1">//...</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<span class="code">Code : C++ - AppDemarrage.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">void</span> <span class="n">AppDemarrage</span><span class="o">::</span><span class="n">createFrameListener</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">mInputListener</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InputListener</span><span class="p">(</span><span class="n">mWindow</span><span class="p">,</span> <span class="n">mCamera</span><span class="p">);</span>
    <span class="n">mRoot</span><span class="o">-&gt;</span><span class="n">addFrameListener</span><span class="p">(</span><span class="n">mInputListener</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Nous devons maintenant passer au démarrage d'OIS dans lequel nous allons
 notamment créer les objets Mouse et Keyboard qui nous servent à 
récupérer les entrées utilisateur via la méthode capture().<br>

		</div>
		<hr>
		
		<hr class="separateur_parties">
		<h2 id="ss_part_439111">Implémenter OIS</h2>
		<div class="ss_part_texte">
		Nous avons maintenant une application Ogre fonctionnelle de base dont 
nous connaissons tout le code source, puisque nous l'avons écrit 
nous-même. Vous avez donc probablement remarqué que nous n'avons pas 
encore créé d'objets Mouse ou Keyboard pour supporter les périphériques 
d'entrée et gérer les événements utilisateur via les Frame Listeners.<br>
<br>
Avant que les codes que nous avons vus en première partie puissent être 
utilisés, il faut commencer par implémenter OIS dans notre application, 
chose qui était déjà faite dans la classe ExampleFrameListener que nous 
utilisions.<br>
<br>
Si vous ne l'avez pas déjà fait, rajoutez la bibliothèque OIS (OIS_d en 
debug) dans l'éditeur de lien et copiez la DLL d'OIS dans le répertoire 
de votre exécutable.<br>
<br>
<h3>Démarrer OIS</h3><br>
<br>
Tout le code qui va suivre est à mettre dans une méthode de type <span class="code2 cpp"><span class="kt">void</span></span>
 nommée startOIS() de notre classe InputListener. Rajoutez le prototype 
de cette méthode dans le header de la classe et préparez-vous à en 
écrire le corps. Aussi, il faudra penser à l'appeler dans le 
constructeur du InputListener :<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">InputListener</span><span class="o">::</span><span class="n">InputListener</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">RenderWindow</span> <span class="o">*</span><span class="n">wnd</span><span class="p">,</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">Camera</span> <span class="o">*</span><span class="n">camera</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">mWindow</span> <span class="o">=</span> <span class="n">wnd</span><span class="p">;</span>
    <span class="n">mCamera</span> <span class="o">=</span> <span class="n">camera</span><span class="p">;</span>
<span class="ln-xtra">    <span class="n">startOIS</span><span class="p">();</span></span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Pour ne pas vous dépayser si vous avez déjà regardé les logs d'une 
application Ogre, nous allons placer dans ce log une ligne indiquant que
 nous rentrons dans la phase d'initialisation d'OIS. Ce sera la première
 ligne de la méthode startOIS().<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">Ogre</span><span class="o">::</span><span class="n">LogManager</span><span class="o">::</span><span class="n">getSingletonPtr</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">logMessage</span><span class="p">(</span><span class="s">"*** Initializing OIS ***"</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Bien entendu, avec cette méthode vous pouvez placer tous les messages 
que vous désirez dans le log, ne vous en privez pas mais restez 
raisonnable, ce fichier doit rester lisible pour être utile !<br>
<br>
La suite du code consiste à récupérer un identifiant de la RenderWindow 
utilisée par notre application afin de créer le gestionnaire d'entrées. 
On utilise pour cela une liste de type OIS::ParamList dans laquelle on 
insère une paire clé/valeur correspondant à l'identifiant récupéré plus 
haut avec la méthode RenderWindow::getCustomAttribute().<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">OIS</span><span class="o">::</span><span class="n">ParamList</span> <span class="n">pl</span><span class="p">;</span>
<span class="n">size_t</span> <span class="n">windowHnd</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">ostringstream</span> <span class="n">windowHndStr</span><span class="p">;</span>
 
<span class="n">mWindow</span><span class="o">-&gt;</span><span class="n">getCustomAttribute</span><span class="p">(</span><span class="s">"WINDOW"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">windowHnd</span><span class="p">);</span>
<span class="n">windowHndStr</span> <span class="o">&lt;&lt;</span> <span class="n">windowHnd</span><span class="p">;</span>
<span class="n">pl</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">make_pair</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">"WINDOW"</span><span class="p">),</span> <span class="n">windowHndStr</span><span class="p">.</span><span class="n">str</span><span class="p">()));</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Ce morceau de code sort un peu du cadre du cours mais il est utile d'en 
comprendre le principe si vous voulez pouvoir intégrer une RenderWindow 
dans une autre application dans le cadre d'un éditeur de niveau par 
exemple.<br>
<br>
Une fois le paramètre caractéristique de la RenderWindow récupéré dans 
la liste, on est en mesure d'instancier le gestionnaire d'entrées.<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mInputManager</span> <span class="o">=</span> <span class="n">OIS</span><span class="o">::</span><span class="n">InputManager</span><span class="o">::</span><span class="n">createInputSystem</span><span class="p">(</span> <span class="n">pl</span> <span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
À partir du gestionnaire d'entrées, nous pouvons créer nos objets pour 
la gestion de la souris et du clavier par la méthode 
createInputObject(). Le premier paramètre de cette méthode est le type 
du périphérique à créer, le second vous permet de dire si vous souhaitez
 utiliser le buffer avec ce périphérique. Ici nous n'allons pas 
l'utiliser, j'ai donc mis l'argument correspondant.<br>
<br>
Le type de retour de la méthode étant un pointeur sur un 
OIS::InputObject, il ne faut pas oublier de caster l'objet reçu en un 
OIS::Mouse ou OIS::Keyboard.<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">mMouse</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">OIS</span><span class="o">::</span><span class="n">Mouse</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">mInputManager</span><span class="o">-&gt;</span><span class="n">createInputObject</span><span class="p">(</span> <span class="n">OIS</span><span class="o">::</span><span class="n">OISMouse</span><span class="p">,</span> <span class="kc">false</span> <span class="p">));</span>
<span class="n">mKeyboard</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">OIS</span><span class="o">::</span><span class="n">Keyboard</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">mInputManager</span><span class="o">-&gt;</span><span class="n">createInputObject</span><span class="p">(</span> <span class="n">OIS</span><span class="o">::</span><span class="n">OISKeyboard</span><span class="p">,</span> <span class="kc">false</span> <span class="p">));</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<h3>Lier OIS à la fenêtre</h3><br>
<br>
L'étape suivante consiste à gérer la liaison entre la fenêtre qui 
contient notre application et l'application elle-même. Comme on l'a vu 
lors de l'initialisation, OIS interagit directement avec la fenêtre du 
système d'exploitation pour trouver notamment la position de la souris 
dans celle-ci. Les dimensions de la fenêtre doivent donc être connues 
pour pouvoir estimer la position relative de la souris à partir de ses 
coordonnées sur l'écran.<br>
<br>
Pour que le moindre changement effectué sur la géométrie de la fenêtre 
soit transmis, il nous faut interfacer notre classe avec 
WindowEventListener, qui, à la manière d'un Frame Listener, appelle les 
méthodes adaptées lors de certains événements définis.<br>
<br>
<span class="code">Code : C++ - InputListener.h - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="syntax"><pre><span class="k">class</span> <span class="nc">InputListener</span><span class="o">:</span> <span class="k">public</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">FrameListener</span><span class="p">,</span> <span class="k">public</span> <span class="n">Ogre</span><span class="o">::</span><span class="n">WindowEventListener</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
La classe WindowEventListener possède deux méthodes virtuelles que nous 
allons réécrire : windowResized() et windowClosed(). Elles permettent de
 gérer les événements liés au redimensionnement de la fenêtre ainsi qu'à
 sa fermeture. Lorsque la fenêtre change de dimensions, nous avons vu 
qu'il est en effet nécessaire de fournir les nouvelles valeurs à OIS 
sinon la position de la souris sera erronée.<br>
<br>
<span class="code">Code : C++ - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="syntax"><pre><span class="c1">// Prototypes des méthodes</span>
<span class="k">virtual</span> <span class="kt">void</span> <span class="n">windowResized</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">RenderWindow</span><span class="o">*</span> <span class="n">rw</span><span class="p">);</span>
<span class="k">virtual</span> <span class="kt">void</span> <span class="n">windowClosed</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">RenderWindow</span><span class="o">*</span> <span class="n">rw</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Pour la première méthode, le but est de récupérer la géométrie de la 
fenêtre redimensionnée via la méthode RenderWindow::getMetrics(). La 
largeur et la hauteur récupérées sont ensuite transmises à OIS par le 
MouseState de notre souris. Comme nous l'avions vu dans le chapitre 6, 
le MouseState permet entre autres de récupérer la position de la souris 
dans la fenêtre, calculée notamment grâce à la connaissance de la 
largeur et la hauteur de cette dernière.<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">void</span> <span class="n">InputListener</span><span class="o">::</span><span class="n">windowResized</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">RenderWindow</span><span class="o">*</span> <span class="n">wnd</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">depth</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">;</span>
    <span class="n">wnd</span><span class="o">-&gt;</span><span class="n">getMetrics</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">);</span>
 
    <span class="k">const</span> <span class="n">OIS</span><span class="o">::</span><span class="n">MouseState</span> <span class="o">&amp;</span><span class="n">ms</span> <span class="o">=</span> <span class="n">mMouse</span><span class="o">-&gt;</span><span class="n">getMouseState</span><span class="p">();</span>
    <span class="n">ms</span><span class="p">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span><span class="p">;</span>
    <span class="n">ms</span><span class="p">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Maintenant, la méthode windowClosed() va permettre de fermer OIS en 
détruisant les objets créés lorsque la fenêtre de l'application est 
fermée.<br>
<br>
Étant donné que la fonction sera appelée à chaque fermeture de fenêtre, 
il faut commencer par vérifier si c'est bien notre attribut mWindow qui 
est concerné. Dans ce cas, on s'occupe de détruire les objets 
représentant la souris et le clavier via la méthode 
destroyInputObject(), puis le gestionnaire d'entrées avec 
destroyInputSystem().<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">void</span> <span class="n">InputListener</span><span class="o">::</span><span class="n">windowClosed</span><span class="p">(</span><span class="n">Ogre</span><span class="o">::</span><span class="n">RenderWindow</span><span class="o">*</span> <span class="n">wnd</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">wnd</span> <span class="o">==</span> <span class="n">mWindow</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">mInputManager</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">mInputManager</span><span class="o">-&gt;</span><span class="n">destroyInputObject</span><span class="p">(</span> <span class="n">mMouse</span> <span class="p">);</span>
            <span class="n">mInputManager</span><span class="o">-&gt;</span><span class="n">destroyInputObject</span><span class="p">(</span> <span class="n">mKeyboard</span> <span class="p">);</span>
 
            <span class="n">OIS</span><span class="o">::</span><span class="n">InputManager</span><span class="o">::</span><span class="n">destroyInputSystem</span><span class="p">(</span><span class="n">mInputManager</span><span class="p">);</span>
            <span class="n">mInputManager</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Revenons maintenant à la méthode startOIS(), à la suite de la création 
des objets Mouse et Keyboard. On commence par appeler la méthode 
windowResized() qui va permettre à OIS de récupérer la taille de la 
fenêtre de notre application, puis un appel à addWindowEventListener() 
permet d'enregistrer notre objet InputListener en tant que 
WindowEventListener pour cette fenêtre. Ainsi, à l'avenir, lorsque la 
fenêtre sera redimensionnée ou fermée, les appels à nos fonctions seront
 faits automatiquement.<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">windowResized</span><span class="p">(</span><span class="n">mWindow</span><span class="p">);</span>
<span class="n">Ogre</span><span class="o">::</span><span class="n">WindowEventUtilities</span><span class="o">::</span><span class="n">addWindowEventListener</span><span class="p">(</span><span class="n">mWindow</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Voici donc la méthode startOIS() complète :<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="syntax"><pre><span class="kt">void</span> <span class="n">InputListener</span><span class="o">::</span><span class="n">startOIS</span><span class="p">()</span> 
<span class="p">{</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">LogManager</span><span class="o">::</span><span class="n">getSingletonPtr</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">logMessage</span><span class="p">(</span><span class="s">"*** Initializing OIS ***"</span><span class="p">);</span>

    <span class="n">OIS</span><span class="o">::</span><span class="n">ParamList</span> <span class="n">pl</span><span class="p">;</span>
    <span class="n">size_t</span> <span class="n">windowHnd</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">ostringstream</span> <span class="n">windowHndStr</span><span class="p">;</span>
 
    <span class="n">mWindow</span><span class="o">-&gt;</span><span class="n">getCustomAttribute</span><span class="p">(</span><span class="s">"WINDOW"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">windowHnd</span><span class="p">);</span>
    <span class="n">windowHndStr</span> <span class="o">&lt;&lt;</span> <span class="n">windowHnd</span><span class="p">;</span>
    <span class="n">pl</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">make_pair</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">"WINDOW"</span><span class="p">),</span> <span class="n">windowHndStr</span><span class="p">.</span><span class="n">str</span><span class="p">()));</span>
 
    <span class="n">mInputManager</span> <span class="o">=</span> <span class="n">OIS</span><span class="o">::</span><span class="n">InputManager</span><span class="o">::</span><span class="n">createInputSystem</span><span class="p">(</span> <span class="n">pl</span> <span class="p">);</span>
    <span class="n">mMouse</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">OIS</span><span class="o">::</span><span class="n">Mouse</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">mInputManager</span><span class="o">-&gt;</span><span class="n">createInputObject</span><span class="p">(</span> <span class="n">OIS</span><span class="o">::</span><span class="n">OISMouse</span><span class="p">,</span> <span class="kc">false</span> <span class="p">));</span>
    <span class="n">mKeyboard</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">OIS</span><span class="o">::</span><span class="n">Keyboard</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">mInputManager</span><span class="o">-&gt;</span><span class="n">createInputObject</span><span class="p">(</span> <span class="n">OIS</span><span class="o">::</span><span class="n">OISKeyboard</span><span class="p">,</span> <span class="kc">false</span> <span class="p">));</span>

    <span class="n">windowResized</span><span class="p">(</span><span class="n">mWindow</span><span class="p">);</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">WindowEventUtilities</span><span class="o">::</span><span class="n">addWindowEventListener</span><span class="p">(</span><span class="n">mWindow</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
Enfin, dans le destructeur de la classe InputListener, il faut retirer 
notre application de la liste des écouteurs de la fenêtre puis appeler 
la méthode windowClosed() qui permet la fermeture d'OIS.<br>
<br>
<span class="code">Code : C++ - InputListener.cpp - <a href="#" class="select_code">Sélectionner</a></span><div class="code2 cpp"><table class="syntaxtable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="syntax"><pre><span class="n">InputListener</span><span class="o">::~</span><span class="n">InputListener</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">Ogre</span><span class="o">::</span><span class="n">WindowEventUtilities</span><span class="o">::</span><span class="n">removeWindowEventListener</span><span class="p">(</span><span class="n">mWindow</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="n">windowClosed</span><span class="p">(</span><span class="n">mWindow</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div><br>
<br>
<div class="rmq question">Pourquoi s'occupe-t-on d'appeler la méthode windowClosed() dans le destructeur ? Je pensais que l'appel était automatique.  <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/huh.png" alt=":o" class="smilies"> </div><br>
<br>
Il faut en fait jeter un œil à la documentation pour comprendre comment 
marche exactement cette fonction. Il est précisé que celle-ci n'est 
appelée que lorsque l'utilisateur clique sur la croix en haut à droite 
de sa fenêtre. Or rien ne nous dit que c'est ce qui arrivera pour notre 
application ! La plupart du temps, le joueur choisira une option 
"quitter" dans l'interface graphique ou bien appuiera simplement sur la 
touche <span class="keyboard_shortcut">echap</span> comme nous le 
faisons depuis le début de ce tutoriel. Il est donc nécessaire d'appeler
 explicitement la méthode dans le destructeur pour s'assurer que le 
traitement sera fait.<br>
<br>
<br>
Vous pouvez maintenant compiler et utiliser votre clavier en appuyant sur <span class="keyboard_shortcut">echap</span> pour quitter l'application.
		</div>
		<hr>
		
	<div id="chap_conclusion">
	Vous êtes maintenant capables de lancer une application sans passer par la classe ExampleApplication !<br>
<br>
Si le code n'est pas spécialement complexe, il reste important 
d'effectuer les étapes décrites dans l'ordre pour éviter les erreurs qui
 seront fatales au lancement de l'application. L'application créée est 
aussi très simpliste, mais nous commençons à avoir la plupart des clés 
en main pour créer des programmes Ogre d'importance.
	</div>
	
<div>
<br>

</div>


<hr>

<div id="btuto_conclusion">
	Ce cours n'est pas terminé !<br>
<br>
<br>
Si vous avez des questions, des problèmes avec le code, postez votre 
question sur le forum pour que tout le monde puisse profiter des 
réponses.<br>
Pour toute suggestion à propos du cours, n'hésitez pas à m'envoyer un MP.
</div>

<div class="clearer"></div>

<div class="infobox cadre_auteur_date" id="tuto_details">
  <form action="tutoriel-54-334502.html" method="post">
    <div class="dnone"><input value="c8eb538544019f565b13390776780274d59736e9" name="challenge" type="hidden"></div>

    <h3 class="special">Informations sur le tutoriel</h3>
   
    <div class="conteneur_infobox">
	<a href="#onglets_tutos">Retour en haut <img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/fleche_haut.png" alt="Retour en haut" title="Retour en haut"></a>
	<br>
   	<br>			
<strong>Créé</strong> : Le 16/06/2010 à 09:09:36<br>
<strong>Modifié</strong> : Le 07/03/2011 à 14:20:08<br>

<strong>Avancement</strong> : 30%<br>

<br>


  <a href="http://www.zcorrecteurs.fr/"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/zcorrige.png" alt="L'orthographe, la grammaire et la présentation de ce tutoriel ont été vérifiées par les zCorrecteurs." title="L'orthographe, la grammaire et la présentation de ce tutoriel ont été vérifiées par les zCorrecteurs."></a><br>

<a href="http://www.siteduzero.com/tutoriel-50-334502-72657-decouvrez-ogre-3d.html#r72657">59 commentaires</a><br>

  <a href="http://www.siteduzero.com/tutoriel-3-334502-decouvrez-ogre-3d.html">Revenir au sommaire du tutoriel</a><br>


    </div>
  </form>
</div>



                </div>
            </div>

            <div id="footer">
                <ul>
                    <li>
                        Le Site du Zéro
                        <ul>
                            <li><a href="http://www.siteduzero.com/plan.html">Plan du site</a></li>
                            <li><a href="http://www.siteduzero.com/membres-304.html">L'équipe</a></li>
                            <li><a href="http://www.siteduzero.com/mentions.html">Mentions légales</a></li>
                            <li><a href="http://www.siteduzero.com/accessibilite.html" accesskey="0">Accessibilité</a></li>
                            <li><a href="http://www.siteduzero.com/livreor.html">Livre d'or</a></li>
                            <li><a href="http://suggestions.siteduzero.com/"><img alt="logo_user_voice" src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/ico_uservoice.png"> Suggestions <img alt="Nouveau" src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/iconouveau.png"></a></li>
                        </ul>
                    </li>
                    <li>
                        Simple IT
                        <ul>
                            <li><a href="http://www.siteduzero.com/simpleit.html">Qui sommes-nous ? </a></li>
                            
                                <li><a href="http://www.siteduzero.com/formations.html">Formation professionnelle</a></li>
                                <li><a href="http://www.siteduzero.com/recrutement.html">Recrutement</a></li>
                            
                            <li><a href="http://www.simple-it.fr/blog/">Notre blog</a></li>
                        </ul>
                    </li>
                    <li>
                        Contacts
                        <ul>
                            <li><a href="http://www.siteduzero.com/publicite-440.html">Espace annonceurs</a></li>
                            <li><a href="http://www.siteduzero.com/presse.html">Espace presse</a></li>
                            <li><strong><a href="http://www.siteduzero.com/contact.html" accesskey="7">Nous contacter</a></strong></li>
                            <li><a href="http://www.siteduzero.com/promouvoir.html">Promouvoir le site</a></li>
                            <li><a href="http://suggestions.siteduzero.com/forums/97879-rapports-de-bugs">Signaler un bug</a></li>
                        </ul>
                    </li>
                    
                        <li>
                            Partenaires 
                            <ul>
                                <li><a href="http://www.planethoster.net/Site-du-Zero">Hébergement web</a></li>
                                <li><a href="http://www.zcorrecteurs.fr/">Correction tutoriels</a></li>
                            </ul>
                        </li>
                    
                    <li>
                        Suivez-nous
                        <ul class="dernier">
                            <li><a href="http://www.siteduzero.com/Templates/xml/news_fr.xml"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/rss_mini.png" alt="Flux RSS"> Flux RSS News</a>, <a href="http://www.siteduzero.com/Templates/xml/tutoriels_fr.xml">Cours</a>, <a href="http://www.simple-it.fr/blog/index.php?feed/atom">Blog</a></li>
                            <li><a href="http://www.siteduzero.com/twitter.html"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/twitter_mini.png" alt="Twitter"> Twitter</a></li>
                            <li><a href="http://www.facebook.com/siteduzero"><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/fb_mini.png" alt="Facebook"> Facebook</a></li>
                        </ul>
                    </li>
                </ul>

                
            </div>

            


            
            <script type="text/javascript" src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/scripts_lang.js"></script>
            <script type="text/javascript" src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/scripts.js"></script>
            <script type="text/javascript" src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/lib.js"></script>

            
                <script type="text/javascript">
    var addthis_config = {  ui_508_compliant: true,
                            ui_cobrand: "Site du Zéro",
                            ui_header_color: "#ffffff",
                            ui_header_background: "#7AB7FC",
                            username: "simpleit",
                            services_exclude: 'print,pdfonline,email,twitter,facebook,myspace,googlebuzz,blogger,buzz,live',
                            data_track_clickback: true  };
                        
    var addthis_share = {templates: { twitter:'{{title}} {{url}} #SdZ' } };

    $('div.slidable').hide();
    $('a.expend').show();
    $('a.expend').removeAttr('style');
    
    $('.expend').click(function(e)
    {
        e.preventDefault();
        $(this).hide('fast');
        $(this).next('div.slidable').slideToggle('fast');
    });
   
</script>
<script type="text/javascript" src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/addthis_widget.js"></script>
            

            <div class="droite printnone">
                <a href="http://www.xiti.com/xiti.asp?s=129196" title="WebAnalytics">
                    <script type="text/javascript">
                        <!--
                        Xt_param = 's=129196&p=%2Ftutoriel-3-334502-decouvrez-ogre-3d.html%3Fall%3D1';
                        try {Xt_r = top.document.referrer;}
                        catch(e) {Xt_r = document.referrer; }
                        Xt_h = new Date();
                        Xt_i = '<img width="80" height="15" border="0" ';
                        Xt_i += 'src="http://logv23.xiti.com/g.xiti?'+Xt_param;
                        Xt_i += '&hl='+Xt_h.getHours()+'x'+Xt_h.getMinutes()+'x'+Xt_h.getSeconds();
                        if(parseFloat(navigator.appVersion)>=4)
                        {
                        Xt_s=screen;Xt_i+='&r='+Xt_s.width+'x'+Xt_s.height+'x'+Xt_s.pixelDepth+'x'+Xt_s.colorDepth;
                        }
                        document.write(Xt_i+'&ref='+Xt_r.replace(/[<>"]/g, '').replace(/&/g, '$')+'">');
                        //-->
                    </script><img src="tutoriel-3-334502-decouvrez-ogre-3d_fichiers/g.gif" height="15" width="80" border="0">
                    <object>
                        <noscript>
                            <p><img width="80" height="15" src="http://logv23.xiti.com/g.xiti?s=129196&amp;p=&amp;" alt="WebAnalytics" /></p>
                        </noscript>
                    </object>
                </a>
                <script type="text/javascript">
                    var _gaq = _gaq || [];
                    _gaq.push(['_setAccount', 'UA-19807070-2']);
                    _gaq.push(['_trackPageview']);

                    (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                    })();
                </script>
            </div>

            <!-- /#688/#0.1505/#0.1109/# -->
	
    <div aria-labelledby="ui-dialog-title-dialog_bientot" role="dialog" tabindex="-1" class="ui-dialog ui-widget ui-widget-content ui-corner-all " style="display: none; position: absolute; overflow: hidden; z-index: 1000; outline: 0px none;"><div style="-moz-user-select: none;" unselectable="on" class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span style="-moz-user-select: none;" unselectable="on" id="ui-dialog-title-dialog_bientot" class="ui-dialog-title">Bientôt sur le Site du Zéro.</span><a style="-moz-user-select: none;" unselectable="on" role="button" class="ui-dialog-titlebar-close ui-corner-all" href="#"><span style="-moz-user-select: none;" unselectable="on" class="ui-icon ui-icon-closethick">close</span></a></div><div class="ui-dialog-content ui-widget-content" id="dialog_bientot" style="">
                <p>Le Site du Zéro vous proposera bientôt de nouveaux cours partant de Zéro dans d'autres domaines que l'informatique ! </p>
                 <a style="color: rgb(38, 119, 201); text-decoration: none;" href="http://www.siteduzero.com/tutoriel-1-433-sciences.html">Découvrir les cours scientifiques</a>
            </div><div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"><button class="ui-state-default ui-corner-all" type="button">Ok</button></div></div><div style="display: none;" id="tooltip"><h3></h3><div class="body"></div><div class="url"></div></div></body></html>